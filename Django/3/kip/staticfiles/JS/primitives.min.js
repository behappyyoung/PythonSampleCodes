/*
 Basic Primitives Diagram v3.1.1
 Copyright (c) 2013 - 2016 Basic Primitives Inc

 Non-commercial - Free
 http://creativecommons.org/licenses/by-nc/3.0/

 Commercial and government licenses:
 http://www.basicprimitives.com/pdf/license.pdf

*/
(function(){var a=function(a){var a=a.split("."),c=window,d;for(d=0;d<a.length;d+=1)c=c[a[d]]=c[a[d]]||{};return c};a("primitives.common");a("primitives.common.perimeter");a("primitives.orgdiagram");a("primitives.famdiagram");a("primitives.text");a("primitives.callout");a("primitives.connector");a("primitives.shape")})();primitives.common.isNullOrEmpty=function(a){var b=!0;void 0!==a&&null!==a&&(a=a.toString(),0<a.length&&(b=!1));return b};
primitives.common.splitCamelCaseName=function(a){for(var b=[],c="",d=0;d<a.length;d+=1){var e=a[d];"A"<=e&&"Z">=e?(""!==c&&b.push(c),c=e):c+=e}""!==c&&b.push(c);return b};primitives.common.isObject=function(a){return null!==a&&"object"==typeof a};primitives.common.isEmptyObject=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0};
primitives.common.cloneObject=function(a,b){var c;if(null===a)c=null;else if(a instanceof Array)if(b)c=a.slice(0);else{c=[];for(var d=0,e=a.length;d<e;d+=1)c.push(primitives.common.cloneObject(a[d],b))}else switch(typeof a){case "object":c={};for(d in a)a.hasOwnProperty(d)&&(c[d]=b?a[d]:primitives.common.cloneObject(a[d],b));break;default:c=a}return c};primitives.common.hashCode=function(a){var b=0,c,d;if(0<a.length)for(d=0;d<a.length;d+=1)c=a.charCodeAt(d),b=(b<<5)-b+c,b&=b;return b};
primitives.common.attr=function(a,b){var c,d;if(a.hasOwnProperty("attrHash"))for(c in b)b.hasOwnProperty(c)&&(d=b[c],a.attrHash[c]!=d&&(a.attrHash[c]=d,a.attr(c,d)));else a.attr(b),a.attrHash=b};primitives.common.css=function(a,b){var c,d;if(a.hasOwnProperty("cssHash"))for(c in b)b.hasOwnProperty(c)&&(d=b[c],a.cssHash[c]!=d&&(a.cssHash[c]=d,a.css(c,d)));else a.css(b),a.cssHash=b};
primitives.common.stopPropagation=function(a){void 0!==a.stopPropagation?a.stopPropagation():void 0!==a.cancelBubble?a.cancelBubble=!0:void 0!==a.preventDefault&&a.preventDefault()};primitives.common.indexOf=function(a,b,c){var d,e;for(d=0;d<a.length;d+=1)if(e=a[d],null!=c?c(e,b):e===b)return d;return-1};primitives.common._supportsSVG=null;
primitives.common.supportsSVG=function(){null===primitives.common._supportsSVG&&(primitives.common._supportsSVG=document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Shape","1.0"));return primitives.common._supportsSVG};primitives.common._supportsVML=null;
primitives.common.supportsVML=function(){var a,b;null===primitives.common._supportsVML&&(primitives.common._supportsVML=!1,jQuery.support.opacity||(a=document.createElement("div"),a=document.body.appendChild(a),a.innerHTML='<v:shape adj="1" />',b=a.firstChild,b.style.behavior="url(#default#VML)",primitives.common._supportsVML=b?"object"===typeof b.adj:!1,a.parentNode.removeChild(a)));return primitives.common._supportsVML};primitives.common._supportsCanvas=null;
primitives.common.supportsCanvas=function(){null===primitives.common._supportsCanvas&&(primitives.common._supportsCanvas=!!window.HTMLCanvasElement);return primitives.common._supportsCanvas};
primitives.common.createGraphics=function(a,b){var c=null,d,e;d=[a];for(e in primitives.common.GraphicsType)primitives.common.GraphicsType.hasOwnProperty(e)&&d.push(primitives.common.GraphicsType[e]);for(e=0;null===c&&e<d.length;e+=1)switch(d[e]){case 2:primitives.common.supportsVML()&&(c=new primitives.common.VmlGraphics(b));break;case 0:primitives.common.supportsSVG()&&(c=new primitives.common.SvgGraphics(b));break;case 1:primitives.common.supportsCanvas()&&(c=new primitives.common.CanvasGraphics(b))}return c};
primitives.common.getColorHexValue=function(a){var b,c,d;if("#"===a.substr(0,1))return a;b=/(.*?)rgb\((\d+), (\d+), (\d+)\)/.exec(a);if(null!==b&&0<b.length)return a=parseInt(b[2],10),c=parseInt(b[3],10),d=parseInt(b[4],10),a=(a<<16|c<<8|d).toString(16),b[1]+"000000".substr(0,6-a.length)+a;if(void 0===primitives.common.ColorHexs)for(c in primitives.common.ColorHexs={},primitives.common.Colors)primitives.common.Colors.hasOwnProperty(c)&&(primitives.common.ColorHexs[c.toUpperCase()]=primitives.common.Colors[c]);
return primitives.common.ColorHexs[a.toUpperCase()]};primitives.common.getColorName=function(a){var b,a=primitives.common.getColorHexValue(a);if(void 0===primitives.common.ColorNames)for(b in primitives.common.ColorNames={},primitives.common.Colors)primitives.common.Colors.hasOwnProperty(b)&&(primitives.common.ColorNames[primitives.common.Colors[b]]=b);return primitives.common.ColorNames[a]};primitives.common.getRed=function(a){return"#"===a.substr(0,1)&&7===a.length?parseInt(a.substr(1,2),16):null};
primitives.common.getGreen=function(a){return"#"===a.substr(0,1)&&7===a.length?parseInt(a.substr(3,2),16):null};primitives.common.getBlue=function(a){return"#"===a.substr(0,1)&&7===a.length?parseInt(a.substr(5,2),16):null};
primitives.common.beforeOpacity=function(a,b){var c=primitives.common,d,e,a=c.getColorHexValue(a);d=Math.ceil((c.getRed(a)-255*(1-b))/b);e=Math.ceil((c.getGreen(a)-255*(1-b))/b);c=Math.ceil((c.getBlue(a)-255*(1-b))/b);d=(d<<16|e<<8|c).toString(16);return"#"+"000000".substr(0,6-d.length)+d};
primitives.common.highestContrast=function(a,b,c){var d=b,e=primitives.common,f=a+","+b+","+c;void 0===e.highestContrasts&&(e.highestContrasts={});e.highestContrasts.hasOwnProperty(f)?d=e.highestContrasts[f]:(e.luminosity(b,a)<e.luminosity(c,a)&&(d=c),e.highestContrasts[f]=d);return d};
primitives.common.luminosity=function(a,b){var c=primitives.common,d=c.getColorHexValue(a),e=c.getColorHexValue(b),d=0.2126*Math.pow(c.getRed(d)/255,2.2)+0.7152*Math.pow(c.getRed(d)/255,2.2)+0.0722*Math.pow(c.getRed(d)/255,2.2),c=0.2126*Math.pow(c.getRed(e)/255,2.2)+0.7152*Math.pow(c.getRed(e)/255,2.2)+0.0722*Math.pow(c.getRed(e)/255,2.2);return d>c?(d+0.05)/(c+0.05):(c+0.05)/(d+0.05)};
primitives.common.compareArrays=function(a,b,c){var d=!0,e,f,g,h;if(a.length!=b.length)d=!1;else{h={};e=0;for(f=a.length;e<f;e+=1)g=null!=c?c(a[e]):a[e],h[g]=h.hasOwnProperty(g)?h[g]+1:1;e=0;for(f=b.length;e<f;e+=1)if(g=null!=c?c(b[e]):b[e],h.hasOwnProperty(g)){if(h[g]-=1,0>h[g]){d=!1;break}}else{d=!1;break}}return d};
primitives.common.Mouse=function(){function a(a){if(jQuery.ui.ie&&(!document.documentMode||9>document.documentMode)&&!a.button)a=c(a);else if(g){if(null!=e.onMouseDrag)e.onMouseDrag(a);a=a.preventDefault()}else{if(d(a)&&mouseDelayMet){if(null!=e.onMouseStart)e.onMouseStart(f);g=!0;if(null!=e.onMouseDrag)e.onMouseDrag(a)}a=!g}return a}function b(a){return c(a)}function c(c){jQuery(document).unbind("mousemove."+e.name,a).unbind("mouseup."+e.name,b);if(g&&(g=!1,c.target===f.target&&jQuery.data(c.target,
e.name+".preventClickEvent",!0),null!=e.onMouseStop))e.onMouseStop(c);return!1}function d(a){return Math.max(Math.abs(f.pageX-a.pageX),Math.abs(f.pageY-a.pageY))>=e.distance}var e={distance:3,delay:0,element:null,name:null,onMouseStart:null,onMouseDrag:null,onMouseStop:null,onMouseCapture:null},f,g;return{init:function(h,i){e.element=h;for(var j in i)i.hasOwnProperty(j)&&(e[j]=i[j]);e.element.bind("mousedown."+e.name,function(k){a:if(primitives.common.Mouse.MouseHandled)k=void 0;else{g&&c(k);f=k;
var j=1===k.which,i=k.target.nodeName?jQuery(k.target).closest("input,textarea,button,select,option").length:!1;if(!(j=!j))i||(i=null!=e.onMouseCapture?e.onMouseCapture(k):!0,i=!i),j=i;if(!j){(mouseDelayMet=!e.delay)||(_mouseDelayTimer=setTimeout(function(){mouseDelayMet=!0},e.delay));if(d(k)&&mouseDelayMet){if(null!=e.onMouseStart)e.onMouseStart(k);g=!0;if(!g){k.preventDefault();k=!0;break a}}!0===jQuery.data(k.target,e.name+".preventClickEvent")&&jQuery.removeData(k.target,e.name+".preventClickEvent");
jQuery(document).bind("mousemove."+e.name,a).bind("mouseup."+e.name,b);k.preventDefault();primitives.common.Mouse.MouseHandled=!0}k=!0}return k}).bind("click."+e.name,function(a){if(!0===jQuery.data(a.target,e.name+".preventClickEvent"))return jQuery.removeData(a.target,e.name+".preventClickEvent"),a.stopImmediatePropagation(),!1})},destroy:function(){e.element.unbind("."+e.name);a&&jQuery(document).unbind("mousemove."+e.name,a).unbind("mouseup."+e.name,b)},isStarted:function(){return g}}};
primitives.common.Mouse.MouseHandled=!1;jQuery(document).mouseup(function(){primitives.common.Mouse.MouseHandled=!1});primitives.common.AdviserPlacementType={Auto:0,Left:2,Right:3};primitives.orgdiagram.AdviserPlacementType=primitives.common.AdviserPlacementType;primitives.common.VerticalAlignmentType={Top:0,Middle:1,Bottom:2};primitives.common.VectorRelationType={None:0,Null:1,Collinear:2,Opposite:3};primitives.common.UpdateMode={Recreate:0,Refresh:1,PositonHighlight:2};
primitives.orgdiagram.UpdateMode=primitives.common.UpdateMode;primitives.text.TextOrientationType={Horizontal:0,RotateLeft:1,RotateRight:2,Auto:3};primitives.common.SideFlag={Top:1,Right:2,Bottom:4,Left:8};primitives.common.ShapeType={Rectangle:0,Oval:1,Triangle:2,CrossOut:3,Circle:4,Rhombus:5,Wedge:7,FramedOval:8,FramedTriangle:9,FramedWedge:10,FramedRhombus:11,None:6};primitives.common.SelectionPathMode={None:0,FullStack:1};primitives.orgdiagram.SelectionPathMode=primitives.common.SelectionPathMode;
primitives.common.SegmentType={Line:0,Move:1,QuadraticArc:2,CubicArc:3,Dot:4};primitives.common.RenderingMode={Create:0,Update:1};primitives.common.PlacementType={Auto:0,TopLeft:8,Top:1,TopRight:2,RightTop:11,Right:3,RightBottom:12,BottomRight:4,Bottom:5,BottomLeft:6,LeftBottom:10,Left:7,LeftTop:9};primitives.common.PageFitMode={None:0,PageWidth:1,PageHeight:2,FitToPage:3,PrintPreview:4,AutoSize:5,SelectionOnly:6};primitives.orgdiagram.PageFitMode=primitives.common.PageFitMode;
primitives.common.OrientationType={Top:0,Bottom:1,Left:2,Right:3,None:4};primitives.orgdiagram.OrientationType=primitives.common.OrientationType;primitives.common.NeighboursSelectionMode={ParentsAndChildren:0,ParentsChildrenSiblingsAndSpouses:1};primitives.common.NavigationMode={Default:0,CursorOnly:1,Inactive:2};primitives.common.Visibility={Auto:0,Normal:1,Dot:2,Line:3,Invisible:4};primitives.common.LineType={Solid:0,Dotted:1,Dashed:2};primitives.common.LabelType={Regular:0,Dummy:1,Fixed:2};
primitives.orgdiagram.ItemType={Regular:0,Assistant:1,SubAssistant:4,SuperAssistant:10,SuperAdviser:9,SubAdviser:5,Adviser:2,Director:11,GeneralPartner:6,LimitedPartner:7,AdviserPartner:8};primitives.common.HorizontalAlignmentType={Center:0,Left:1,Right:2};primitives.common.GroupByType={None:0,Parents:1,Children:2};primitives.common.GraphicsType={SVG:0,Canvas:1,VML:2};primitives.common.Enabled={Auto:0,True:1,False:2};primitives.common.ElbowType={None:0,Dot:1,Bevel:2,Round:3};
primitives.common.ConnectorType={Squared:0,Angular:1,Curved:2};primitives.orgdiagram.ConnectorType=primitives.common.ConnectorType;primitives.common.ConnectorStyleType={Extra:0,Regular:1,Highlight:2};primitives.common.ConnectorShapeType={OneWay:0,TwoWay:1};primitives.common.ConnectorLabelPlacementType={From:0,Between:1,To:2};
primitives.common.Colors={AliceBlue:"#f0f8ff",AntiqueWhite:"#faebd7",Aqua:"#00ffff",Aquamarine:"#7fffd4",Azure:"#f0ffff",Beige:"#f5f5dc",Bisque:"#ffe4c4",Black:"#000000",BlanchedAlmond:"#ffebcd",Blue:"#0000ff",BlueViolet:"#8a2be2",Brown:"#a52a2a",BurlyWood:"#deb887",Bronze:"#cd7f32",CadetBlue:"#5f9ea0",ChartReuse:"#7fff00",Chocolate:"#d2691e",Coral:"#ff7f50",CornflowerBlue:"#6495ed",Cornsilk:"#fff8dc",Crimson:"#dc143c",Cyan:"#00ffff",DarkBlue:"#00008b",DarkCyan:"#008b8b",DarkGoldenrod:"#b8860b",DarkGray:"#a9a9a9",
DarkGreen:"#006400",DarkKhaki:"#bdb76b",DarkMagenta:"#8b008b",DarkOliveGreen:"#556b2f",Darkorange:"#ff8c00",DarkOrchid:"#9932cc",DarkRed:"#8b0000",DarkSalmon:"#e9967a",DarkSeaGreen:"#8fbc8f",DarkSlateBlue:"#483d8b",DarkSlateGray:"#2f4f4f",DarkTurquoise:"#00ced1",DarkViolet:"#9400d3",DeepPink:"#ff1493",DeepSkyBlue:"#00bfff",DimGray:"#696969",DodgerBlue:"#1e90ff",FireBrick:"#b22222",FloralWhite:"#fffaf0",ForestGreen:"#228b22",Fuchsia:"#ff00ff",Gainsboro:"#dcdcdc",GhostWhite:"#f8f8ff",Gold:"#ffd700",
Goldenrod:"#daa520",Gray:"#808080",Green:"#008000",GreenYellow:"#adff2f",Honeydew:"#f0fff0",Hotpink:"#ff69b4",IndianRed:"#cd5c5c",Indigo:"#4b0082",Ivory:"#fffff0",Khaki:"#f0e68c",Lavender:"#e6e6fa",LavenderBlush:"#fff0f5",Lawngreen:"#7cfc00",Lemonchiffon:"#fffacd",LightBlue:"#add8e6",LightCoral:"#f08080",LightCyan:"#e0ffff",LightGoldenrodYellow:"#fafad2",LightGray:"#d3d3d3",LightGreen:"#90ee90",LightPink:"#ffb6c1",LightSalmon:"#ffa07a",LightSeaGreen:"#20b2aa",LightSkyBlue:"#87cefa",LightSlateGray:"#778899",
LightSteelBlue:"#b0c4de",LightYellow:"#ffffe0",Lime:"#00ff00",Limegreen:"#32cd32",Linen:"#faf0e6",Magenta:"#ff00ff",Maroon:"#800000",MediumAquamarine:"#66cdaa",MediumBlue:"#0000cd",MediumOrchid:"#ba55d3",MediumPurple:"#9370d8",MediumSeaGreen:"#3cb371",MediumSlateBlue:"#7b68ee",MediumSpringGreen:"#00fa9a",MediumTurquoise:"#48d1cc",MediumVioletRed:"#c71585",MidnightBlue:"#191970",MintCream:"#f5fffa",MistyRose:"#ffe4e1",Moccasin:"#ffe4b5",NavajoWhite:"#ffdead",Navy:"#000080",Oldlace:"#fdf5e6",Olive:"#808000",
Olivedrab:"#6b8e23",Orange:"#ffa500",OrangeRed:"#ff4500",Orchid:"#da70d6",PaleGoldenRod:"#eee8aa",PaleGreen:"#98fb98",PaleTurquoise:"#afeeee",PaleVioletRed:"#d87093",Papayawhip:"#ffefd5",Peachpuff:"#ffdab9",Peru:"#cd853f",Pink:"#ffc0cb",Plum:"#dda0dd",PowderBlue:"#b0e0e6",Purple:"#800080",Red:"#ff0000",RosyBrown:"#bc8f8f",RoyalBlue:"#4169e1",SaddleBrown:"#8b4513",Salmon:"#fa8072",SandyBrown:"#f4a460",SeaGreen:"#2e8b57",Seashell:"#fff5ee",Sienna:"#a0522d",Silver:"#c0c0c0",SkyBlue:"#87ceeb",SlateBlue:"#6a5acd",
SlateGray:"#708090",Snow:"#fffafa",SpringGreen:"#00ff7f",SteelBlue:"#4682b4",Tan:"#d2b48c",Teal:"#008080",Thistle:"#d8bfd8",Tomato:"#ff6347",Turquoise:"#40e0d0",Violet:"#ee82ee",Wheat:"#f5deb3",White:"#ffffff",WhiteSmoke:"#f5f5f5",Yellow:"#ffff00",YellowGreen:"#9acd32"};primitives.common.ChildrenPlacementType={Auto:0,Vertical:1,Horizontal:2,Matrix:3};primitives.orgdiagram.ChildrenPlacementType=primitives.common.ChildrenPlacementType;
primitives.common.AnnotationType={Connector:0,Shape:1,HighlightPath:2,Label:3,Background:4};primitives.common.Layers={PrintPreview:1,BackgroundAnnotation:2,BackgroundAnnotations:3,BackgroundConnectorAnnotation:4,Connector:5,Highlight:6,Marker:7,Label:8,Cursor:9,Item:10,ForegroundAnnotations:11,ForegroundConnectorAnnotation:12,Annotation:13,Controls:14};primitives.common.ZOrderType={Auto:0,Background:1,Foreground:2};
primitives.common.RenderEventArgs=function(){this.renderingMode=this.templateName=this.context=this.element=null;this.isSelected=this.isCursor=!1};primitives.common.BaseShape=function(){};
primitives.common.BaseShape.prototype._getLabelPosition=function(a,b,c,d,e,f,g,h){var i=null;switch(h){case 1:i=new primitives.common.Rect(a+c/2-e/2,b-g-f,e,f);break;case 2:i=new primitives.common.Rect(a+c-e,b-g-f,e,f);break;case 8:i=new primitives.common.Rect(a,b-g-f,e,f);break;case 3:i=new primitives.common.Rect(a+c+g,b+d/2-f/2,e,f);break;case 11:i=new primitives.common.Rect(a+c+g,b,e,f);break;case 12:i=new primitives.common.Rect(a+c+g,b+d-f,e,f);break;case 4:i=new primitives.common.Rect(a+c-e,
b+d+g,e,f);break;case 6:i=new primitives.common.Rect(a,b+d+g,e,f);break;case 7:i=new primitives.common.Rect(a-e-g,b+d/2-f/2,e,f);break;case 9:i=new primitives.common.Rect(a-e-g,b,e,f);break;case 10:i=new primitives.common.Rect(a-e-g,b+d-f,e,f);break;default:i=new primitives.common.Rect(a+c/2-e/2,b+d+g,e,f)}return i};primitives.common.BaseShape.prototype._betweenPoint=function(a,b){return new primitives.common.Point((a.x+b.x)/2,(a.y+b.y)/2)};
primitives.common.BaseShape.prototype._offsetPoint=function(a,b,c){var d=null,d=a.distanceTo(b);return d=0===d||0===c?new primitives.common.Point(a):new primitives.common.Point(a.x+(b.x-a.x)/d*c,a.y+(b.y-a.y)/d*c)};primitives.common.Callout=function(a){this.m_graphics=a;this.pointerPlacement=0;this.cornerRadius="10%";this.offset=0;this.lineWidth=this.opacity=1;this.pointerWidth="10%";this.borderColor="#000000";this.lineType=0;this.fillColor="#d3d3d3";this.m_map=[[8,7,6],[1,null,5],[2,3,4]]};
primitives.common.Callout.prototype=new primitives.common.BaseShape;
primitives.common.Callout.prototype.draw=function(a,b){var b=(new primitives.common.Rect(b)).offset(this.offset),c=new primitives.common.Point(b.x,b.y),d=new primitives.common.Point(b.right(),b.y),e=new primitives.common.Point(b.right(),b.bottom()),f=new primitives.common.Point(b.left(),b.bottom()),g=[null,null,null,null,null,null,null,null],f=[c,d,e,f],d=this.m_graphics.getPxSize(this.cornerRadius,Math.min(c.distanceTo(d),d.distanceTo(e))),h,i;h={};null!==this.fillColor&&(h.fillColor=this.fillColor,
h.opacity=this.opacity);null!==this.lineColor&&(h.lineColor=this.borderColor);h.lineWidth=this.lineWidth;h.lineType=this.lineType;i=new primitives.common.PaletteItem(h);h=new primitives.common.PolylinesBuffer;i=h.getPolyline(i);null!==a&&(c=0===this.pointerPlacement?this._getPlacement(a,c,e):this.pointerPlacement,null!==c&&(g[c]=a));for(e=0;e<f.length;e+=1)this._drawSegment(i,f[0],f[1],f[2],this.pointerWidth,d,g[1],g[2]),c=f.shift(),f.push(c),c=g.shift(),g.push(c),c=g.shift(),g.push(c);this.m_graphics.polylinesBuffer(h)};
primitives.common.Callout.prototype._getPlacement=function(a,b,c){var d=null,e=null,d=a.x<b.x?0:a.x>c.x?2:1,e=a.y<b.y?0:a.y>c.y?2:1;return this.m_map[d][e]};
primitives.common.Callout.prototype._drawSegment=function(a,b,c,d,e,f,g,h){var i=this._offsetPoint(b,c,f),j=this._offsetPoint(c,b,f),d=this._offsetPoint(c,d,f),e=this.m_graphics.getPxSize(e,b.distanceTo(c)/2);0===a.length()&&a.addSegment(new primitives.common.MoveSegment(i));null!==g&&(i=this._betweenPoint(b,c),b=this._offsetPoint(i,b,e),e=this._offsetPoint(i,c,e),a.addSegment(new primitives.common.LineSegment(b)),a.addSegment(new primitives.common.LineSegment(g)),a.addSegment(new primitives.common.LineSegment(e)));
a.addSegment(new primitives.common.LineSegment(j));null!==h?(a.addSegment(new primitives.common.LineSegment(h)),a.addSegment(new primitives.common.LineSegment(d))):a.addSegment(new primitives.common.QuadraticArcSegment(c,d))};
primitives.common.Connector=function(a){this.m_graphics=a;this.transform=null;this.orientationType=0;this.panelSize=null;this.connectorShapeType=1;this.offset=0;this.lineWidth=1;this.labelOffset=4;this.labelSize=new primitives.common.Size(60,30);this.lineType=0;this.labelPlacementType=primitives.common.ConnectorLabelPlacementType.Between;this.color="#000000";this.hasLabel=!1;this.labelTemplate=null};primitives.common.Connector.prototype=new primitives.common.BaseShape;
primitives.common.Connector.prototype.draw=function(a,b,c){var d,e,f,g,h,i,j,k,l,n=6*this.lineWidth,m,t,q=0,p=0,r,s=new primitives.common.PaletteItem({lineColor:this.color,lineWidth:this.lineWidth,lineType:this.lineType}),u=new primitives.common.PolylinesBuffer,v=u.getPolyline(s),a=(new primitives.common.Rect(a)).offset(this.offset),b=(new primitives.common.Rect(b)).offset(this.offset);i=[];switch(this.connectorShapeType){case 1:i=[-n/2,n/2];break;case 0:i=[0]}this.transform=new primitives.common.Transform;
this.transform.size=this.panelSize;this.transform.setOrientation(this.orientationType);this.transform.transformRect(a.x,a.y,a.width,a.height,!1,this,function(b,c,d,f){a=new primitives.common.Rect(b,c,d,f)});this.transform.transformRect(b.x,b.y,b.width,b.height,!1,this,function(a,c,d,f){b=new primitives.common.Rect(a,c,d,f)});this.transform.transformRect(0,0,this.labelSize.width,this.labelSize.height,!1,this,function(a,b,c,d){m=new primitives.common.Size(c,d)});this.transform.transformRect(0,0,this.panelSize.width,
this.panelSize.height,!1,this,function(a,b,c,d){r=new primitives.common.Size(c,d)});q=Math.max(this.hasLabel?m.width:0,5*n);if(a.right()+q<b.left()||a.left()>b.right()+q)if(a.left()>b.right()?(d=new primitives.common.Point(a.left(),a.verticalCenter()),e=new primitives.common.Point(b.right(),b.verticalCenter()),q=7,p=3):(d=new primitives.common.Point(a.right(),a.verticalCenter()),e=new primitives.common.Point(b.left(),b.verticalCenter()),q=3,p=7),f=new primitives.common.Rect(d,e),l=d.y<=e.y,k=d.x<
e.x,f.height<f.width){f.height<2*n&&f.offset(0,l?2*n:0,0,l?0:2*n);g=0;for(h=i.length;g<h;g+=1)j=i[g],u.addInverted(function(a){a=a.getPolyline(s);a.addSegment(new primitives.common.MoveSegment(d.x,d.y+j));a.addSegment(new primitives.common.QuadraticArcSegment(f.horizontalCenter(),(l?f.top():f.bottom())+j,e.x,e.y+j))},!g),v.addArrow(this.lineWidth,function(a){a.mergeTo(u.getPolyline(a.paletteItem))});i=m.width<2*(f.width/5)?primitives.common.QuadraticArcSegment.prototype.offsetPoint(d.x,d.y,f.horizontalCenter(),
l?f.top():f.bottom(),e.x,e.y,0.5):new primitives.common.Point(d.x,l?f.top():f.bottom());t=new primitives.common.Rect(i.x+(k?n:-m.width-n),l?i.y-m.height-n:i.y+n,m.width,m.height)}else{g=0;for(h=i.length;g<h;g+=1)j=i[g],u.addInverted(function(a){a=a.getPolyline(s);a.addSegment(new primitives.common.MoveSegment(d.x,d.y+j));a.addSegment(new primitives.common.QuadraticArcSegment(f.horizontalCenter()+j*(l!=k?1:-1),(l?f.top():f.bottom())+j,f.horizontalCenter()+j*(l!=k?1:-1),f.verticalCenter()+j));a.addSegment(new primitives.common.QuadraticArcSegment(f.horizontalCenter()+
j*(l!=k?1:-1),(l?f.bottom():f.top())+j,e.x,e.y+j))},!g),v.addArrow(this.lineWidth,function(a){a.mergeTo(u.getPolyline(a.paletteItem))});t=new primitives.common.Rect(f.horizontalCenter()+(l!=k?n:-(n+m.width)),f.verticalCenter()-m.height/2,m.width,m.height)}else if(a.verticalCenter()<b.top()||a.verticalCenter()>b.bottom()){k=a.x<r.width/2;d=new primitives.common.Point(k?a.right():a.left(),a.verticalCenter());e=new primitives.common.Point(k?b.right():b.left(),b.verticalCenter());p=q=k?3:7;f=new primitives.common.Rect(d,
e);f.offset(10*n,0,10*n,0);l=d.y<=e.y;g=0;for(h=i.length;g<h;g+=1)j=i[g],u.addInverted(function(a){a=a.getPolyline(s);a.addSegment(new primitives.common.MoveSegment(d.x,d.y+j));a.addSegment(new primitives.common.QuadraticArcSegment(k?f.right()+j*(l?-1:1):f.left()-j*(l?-1:1),f.verticalCenter(),k?b.right():b.left(),b.verticalCenter()-j))},!g),v.addArrow(this.lineWidth,function(a){a.mergeTo(u.getPolyline(a.paletteItem))});i=primitives.common.QuadraticArcSegment.prototype.offsetPoint(d.x,d.y,k?f.right():
f.left(),f.verticalCenter(),e.x,e.y,0.5);t=new primitives.common.Rect(i.x+(k?n/2:-n/2-m.width),i.y-m.height/2,m.width,m.height)}else{d=new primitives.common.Point(a.horizontalCenter(),a.top());e=new primitives.common.Point(b.horizontalCenter(),b.top());p=q=1;f=new primitives.common.Rect(d,e);f.offset(0,7*n,0,0);k=d.x<e.x;g=0;for(h=i.length;g<h;g+=1)j=i[g],u.addInverted(function(a){a=a.getPolyline(s);a.addSegment(new primitives.common.MoveSegment(d.x+j,d.y));a.addSegment(new primitives.common.QuadraticArcSegment(f.horizontalCenter(),
f.top()-j*(k?-1:1),b.horizontalCenter()-j,b.top()))},!g),v.addArrow(this.lineWidth,function(a){a.mergeTo(u.getPolyline(a.paletteItem))});i=primitives.common.QuadraticArcSegment.prototype.offsetPoint(d.x,d.y,f.horizontalCenter(),f.top(),e.x,e.y,0.5);t=new primitives.common.Rect(i.x-m.width/2,i.y-(this.labelOffset+m.height),m.width,m.height)}u.transform(this.transform,!0);this.m_graphics.polylinesBuffer(u);if(this.hasLabel){switch(this.labelPlacementType){case primitives.common.ConnectorLabelPlacementType.From:t=
this._getLabelPosition(a.x,a.y,a.width,a.height,t.width,t.height,this.labelOffset,q);break;case primitives.common.ConnectorLabelPlacementType.To:t=this._getLabelPosition(b.x,b.y,b.width,b.height,t.width,t.height,this.labelOffset,p)}this.transform.transformRect(t.x,t.y,t.width,t.height,!0,this,function(a,b,c,d){t=new primitives.common.Rect(a,b,c,d)});this.m_graphics.template(t.x,t.y,0,0,0,0,t.width,t.height,this.labelTemplate.template(),this.labelTemplate.getHashCode(),this.labelTemplate.render,c,
null)}};primitives.common.Marker=function(){};primitives.common.Marker.Markers={};primitives.common.Marker.DrawCircle=function(a,b){var c=Math.min(b.width/2,b.height/2),b=new primitives.common.Rect(b.horizontalCenter()-c,b.verticalCenter()-c,2*c,2*c);primitives.common.Marker.DrawOval(a,b)};
primitives.common.Marker.DrawRectangle=function(a,b){a.addSegment(new primitives.common.MoveSegment(b.x,b.verticalCenter()));a.addSegment(new primitives.common.LineSegment(b.x,b.y));a.addSegment(new primitives.common.LineSegment(b.right(),b.y));a.addSegment(new primitives.common.LineSegment(b.right(),b.bottom()));a.addSegment(new primitives.common.LineSegment(b.x,b.bottom()));a.addSegment(new primitives.common.LineSegment(b.x,b.verticalCenter()))};
primitives.common.Marker.DrawOval=function(a,b){var c,d;c=0.5522848*(b.width/2);d=0.5522848*(b.height/2);a.addSegment(new primitives.common.MoveSegment(b.x,b.verticalCenter()));a.addSegment(new primitives.common.CubicArcSegment(b.x,b.verticalCenter()-d,b.horizontalCenter()-c,b.y,b.horizontalCenter(),b.y));a.addSegment(new primitives.common.CubicArcSegment(b.horizontalCenter()+c,b.y,b.right(),b.verticalCenter()-d,b.right(),b.verticalCenter()));a.addSegment(new primitives.common.CubicArcSegment(b.right(),
b.verticalCenter()+d,b.horizontalCenter()+c,b.bottom(),b.horizontalCenter(),b.bottom()));a.addSegment(new primitives.common.CubicArcSegment(b.horizontalCenter()-c,b.bottom(),b.x,b.verticalCenter()+d,b.x,b.verticalCenter()))};
primitives.common.Marker.DrawTriangle=function(a,b){a.addSegment(new primitives.common.MoveSegment(b.left(),b.bottom()));a.addSegment(new primitives.common.LineSegment(b.horizontalCenter(),b.y));a.addSegment(new primitives.common.LineSegment(b.right(),b.bottom()));a.addSegment(new primitives.common.LineSegment(b.left(),b.bottom()))};
primitives.common.Marker.DrawCrossOut=function(a,b){a.addSegment(new primitives.common.MoveSegment(b.horizontalCenter(),b.verticalCenter()));a.addSegment(new primitives.common.LineSegment(b.x,b.y));a.addSegment(new primitives.common.MoveSegment(b.horizontalCenter(),b.verticalCenter()));a.addSegment(new primitives.common.LineSegment(b.right(),b.bottom()));a.addSegment(new primitives.common.MoveSegment(b.horizontalCenter(),b.verticalCenter()));a.addSegment(new primitives.common.LineSegment(b.right(),
b.y));a.addSegment(new primitives.common.MoveSegment(b.horizontalCenter(),b.verticalCenter()));a.addSegment(new primitives.common.LineSegment(b.left(),b.bottom()))};
primitives.common.Marker.DrawRhombus=function(a,b){a.addSegment(new primitives.common.MoveSegment(b.horizontalCenter(),b.bottom()));a.addSegment(new primitives.common.LineSegment(b.left(),b.verticalCenter()));a.addSegment(new primitives.common.LineSegment(b.horizontalCenter(),b.y));a.addSegment(new primitives.common.LineSegment(b.right(),b.verticalCenter()));a.addSegment(new primitives.common.LineSegment(b.horizontalCenter(),b.bottom()))};
primitives.common.Marker.DrawWedge=function(a,b){a.addSegment(new primitives.common.MoveSegment(b.horizontalCenter(),b.y));a.addSegment(new primitives.common.LineSegment(b.right(),b.y));a.addSegment(new primitives.common.LineSegment(b.horizontalCenter(),b.bottom()));a.addSegment(new primitives.common.LineSegment(b.left(),b.y));a.addSegment(new primitives.common.LineSegment(b.horizontalCenter(),b.y))};
primitives.common.Marker.DrawFramedOval=function(a,b){primitives.common.Marker.DrawRectangle(a,b);primitives.common.Marker.DrawOval(a,b)};primitives.common.Marker.DrawFramedTriangle=function(a,b){primitives.common.Marker.DrawRectangle(a,b);primitives.common.Marker.DrawTriangle(a,b)};primitives.common.Marker.DrawFramedWedge=function(a,b){primitives.common.Marker.DrawRectangle(a,b);primitives.common.Marker.DrawWedge(a,b)};
primitives.common.Marker.DrawFramedRhombus=function(a,b){primitives.common.Marker.DrawRectangle(a,b);primitives.common.Marker.DrawRhombus(a,b)};primitives.common.Marker.DrawNone=function(){};primitives.common.Marker.Markers[4]=primitives.common.Marker.DrawCircle;primitives.common.Marker.Markers[0]=primitives.common.Marker.DrawRectangle;primitives.common.Marker.Markers[1]=primitives.common.Marker.DrawOval;primitives.common.Marker.Markers[2]=primitives.common.Marker.DrawTriangle;
primitives.common.Marker.Markers[3]=primitives.common.Marker.DrawCrossOut;primitives.common.Marker.Markers[5]=primitives.common.Marker.DrawRhombus;primitives.common.Marker.Markers[7]=primitives.common.Marker.DrawWedge;primitives.common.Marker.Markers[8]=primitives.common.Marker.DrawFramedOval;primitives.common.Marker.Markers[9]=primitives.common.Marker.DrawFramedTriangle;primitives.common.Marker.Markers[10]=primitives.common.Marker.DrawFramedWedge;primitives.common.Marker.Markers[11]=primitives.common.Marker.DrawFramedRhombus;
primitives.common.Marker.Markers[6]=primitives.common.Marker.DrawNone;primitives.common.Marker.prototype.draw=function(a,b,c,d){a=a.getPolyline(d);primitives.common.Marker.Markers[b](a,c)};primitives.common.Perimeter=function(a){this.m_graphics=a;this.transform=null;this.opacity=this.lineWidth=1;this.fillColor=null;this.lineType=0;this.borderColor=null};primitives.common.Perimeter.prototype=new primitives.common.BaseShape;
primitives.common.Perimeter.prototype.draw=function(a){var b=new primitives.common.PaletteItem({lineColor:this.borderColor,lineWidth:this.lineWidth,fillColor:this.fillColor,lineType:this.lineType,opacity:this.opacity}),c=new primitives.common.Polyline(b),d=this.lineWidth/2,e=null,f=null,g=null,h={};a.segments.iterate(function(b){var j=0,k=0,l=!1;if(0<d)switch(b.orientationType){case 3:j=-d;l=!1;break;case 2:j=d;l=!1;break;case 0:k=d;l=!0;break;case 1:k=-d;l=!0;break;default:throw"Orientation is not defined!";
}0===c.length()&&(f=new primitives.common.MoveSegment(b.fromPoint),c.addSegment(f),h[a.segments.endKey()]={point:f,isVertical:l});j=null!=a.segments.item(b.oppositeKey)?new primitives.common.MoveSegment(b.toPoint.x+j,b.toPoint.y+k):new primitives.common.LineSegment(b.toPoint.x+j,b.toPoint.y+k);c.addSegment(j);0<d&&(l?f.y=j.y:f.x=j.x,null!=e&&(!a.segments.item(e.oppositeKey)&&null!=a.segments.item(b.oppositeKey)?h.hasOwnProperty(b.oppositeKey)?(k=h[b.oppositeKey],k.isVertical?f.y=k.point.y:f.x=k.point.x,
g?k.point.y=f.y:k.point.x=f.x):h[b.oppositeKey]={point:f,isVertical:g}:null!=a.segments.item(e.oppositeKey)&&!a.segments.item(b.oppositeKey)&&(h.hasOwnProperty(e.key)?(k=h[e.key],k.isVertical?f.y=k.point.y:f.x=k.point.x,g?k.point.y=f.y:k.point.x=f.x):h[e.key]={point:f,isVertical:l})),g=l,e=b);f=j});0<d&&!a.segments.item(e.oppositeKey)&&(b=h[e.key],b.isVertical?f.y=b.point.y:f.x=b.point.x,g?b.point.y=f.y:b.point.x=f.x);c.transform(this.transform,!0);this.m_graphics.polyline(c)};
primitives.common.Shape=function(a){this.m_graphics=a;this.transform=null;this.orientationType=0;this.panelSize=null;this.shapeType=0;this.offset=new primitives.common.Thickness(0,0,0,0);this.lineWidth=1;this.labelOffset=4;this.cornerRadius="10%";this.opacity=1;this.fillColor=null;this.labelSize=new primitives.common.Size(60,30);this.lineType=0;this.borderColor=null;this.hasLabel=!1;this.labelTemplate=null;this.labelPlacement=0};primitives.common.Shape.prototype=new primitives.common.BaseShape;
primitives.common.Shape.prototype.draw=function(a,b){var c,d,e,f,a=(new primitives.common.Rect(a)).offset(this.offset);this.transform=new primitives.common.Transform;this.transform.size=this.panelSize;this.transform.setOrientation(this.orientationType);this.hasLabel&&(c=this._getLabelPosition(a.x,a.y,a.width,a.height,this.labelSize.width,this.labelSize.height,this.labelOffset,this.labelPlacement));switch(this.shapeType){case 0:d=new primitives.common.Callout(this.m_graphics);d.cornerRadius=this.cornerRadius;
d.opacity=this.opacity;d.lineWidth=this.lineWidth;d.lineType=this.lineType;d.borderColor=this.borderColor;d.fillColor=this.fillColor;d.draw(null,a);break;default:d=new primitives.common.PaletteItem({lineColor:this.borderColor,lineWidth:this.lineWidth,lineType:this.lineType,fillColor:this.fillColor,opacity:this.opacity}),this.transform.transformRect(a.x,a.y,a.width,a.height,!1,this,function(b,c,d,f){a=new primitives.common.Rect(b,c,d,f)}),f=new primitives.common.Marker,e=new primitives.common.PolylinesBuffer,
f.draw(e,this.shapeType,a,d),e.transform(this.transform,!0),this.m_graphics.polylinesBuffer(e)}this.hasLabel&&this.m_graphics.template(c.x,c.y,0,0,0,0,c.width,c.height,this.labelTemplate.template(),this.labelTemplate.getHashCode(),this.labelTemplate.render,b,null)};primitives.common.Point=function(a,b){this.context=this.y=this.x=null;switch(arguments.length){case 1:this.x=a.x;this.y=a.y;this.context=a.context;break;case 2:this.x=a,this.y=b}};
primitives.common.Point.prototype.scale=function(a){this.x*=a;this.x*=a;return this};primitives.common.Point.prototype.distanceTo=function(a,b){var c=0,d=0;switch(arguments.length){case 1:c=a.x;d=a.y;break;case 2:c=a,d=b}c=this.x-c;d=this.y-d;return Math.sqrt(c*c+d*d)};primitives.common.Point.prototype.equalTo=function(a){return this.x==a.x&&this.y==a.y};primitives.common.Point.prototype.swap=function(a){var b=a.x,c=a.y;a.x=this.x;a.y=this.y;this.x=b;this.y=c};
primitives.common.Point.prototype.clone=function(){return new primitives.common.Point(this)};primitives.common.Point.prototype.toString=function(a){var b,a=void 0!==a?a:"px";b=""+("left:"+this.x+a+";");return b+="top:"+this.y+a+";"};primitives.common.MoveSegment=function(){this.parent=primitives.common.Point.prototype;this.parent.constructor.apply(this,arguments);this.segmentType=1};primitives.common.MoveSegment.prototype=new primitives.common.Point;primitives.common.MoveSegment.prototype.clone=function(){return new primitives.common.MoveSegment(this)};
primitives.common.MoveSegment.prototype.loop=function(a,b){null!=b&&b.call(a,this.x,this.y,0)};primitives.common.MoveSegment.prototype.setPoint=function(a){this.x=a.x;this.y=a.y};primitives.common.MoveSegment.prototype.getEndPoint=function(){return this};primitives.common.MoveSegment.prototype.invert=function(a){this.x=a.x;this.y=a.y};primitives.common.MoveSegment.prototype.transform=function(a,b){var c=this;a.transformPoint(c.x,c.y,b,c,function(a,b){c.x=a;c.y=b})};
primitives.common.CubicArcSegment=function(a,b,c,d,e,f){this.parent=primitives.common.Point.prototype;this.cpY2=this.cpX2=this.cpY1=this.cpX1=this.y=this.x=null;switch(arguments.length){case 3:this.parent.constructor.apply(this,[c.x,c.y]);this.cpX1=a.x;this.cpY1=a.y;this.cpX2=b.x;this.cpY2=b.y;break;case 6:this.parent.constructor.apply(this,[e,f]),this.cpX1=a,this.cpY1=b,this.cpX2=c,this.cpY2=d}this.segmentType=3};primitives.common.CubicArcSegment.prototype=new primitives.common.Point;
primitives.common.CubicArcSegment.prototype.clone=function(){return new primitives.common.CubicArcSegment(this.cpX1,this.cpY1,this.cpX2,this.cpY2,this.x,this.y)};primitives.common.CubicArcSegment.prototype.loop=function(a,b){null!=b&&(b.call(a,this.cpX1,this.cpY1,0),b.call(a,this.cpX2,this.cpY2,1),b.call(a,this.x,this.y,2))};
primitives.common.CubicArcSegment.prototype.setPoint=function(a,b){switch(b){case 0:this.cpX1=a.x;this.cpY1=a.y;break;case 1:this.cpX2=a.x;this.cpY2=a.y;break;case 2:this.x=a.x,this.y=a.y}};primitives.common.CubicArcSegment.prototype.getEndPoint=function(){return this};primitives.common.CubicArcSegment.prototype.invert=function(a){var b=this.cpX1,c=this.cpY1;this.x=a.x;this.y=a.y;this.cpX1=this.cpX2;this.cpY1=this.cpY2;this.cpX2=b;this.cpY2=c};
primitives.common.CubicArcSegment.prototype.transform=function(a,b){var c=this;a.transform3Points(c.x,c.y,c.cpX1,c.cpY1,c.cpX2,c.cpY2,b,c,function(a,b,f,g,h,i){c.x=a;c.y=b;c.cpX1=f;c.cpY1=g;c.cpX2=h;c.cpY2=i})};
primitives.common.CubicArcSegment.prototype.trim=function(a,b){var c=0.5,d=this.offsetPoint(this.x,this.y,this.cpX2,this.cpY2,this.cpX1,this.cpY1,a.x,a.y,c),e=this.offsetPoint(this.x,this.y,this.cpX2,this.cpY2,this.cpX1,this.cpY1,a.x,a.y,0.1),c=b*(c/d.distanceTo(this.x,this.y)+0.1/e.distanceTo(this.x,this.y))/2,d=this.offsetPoint(this.x,this.y,this.cpX2,this.cpY2,this.cpX1,this.cpY1,a.x,a.y,c);this.x=d.x;this.y=d.y;return this};
primitives.common.CubicArcSegment.prototype.offsetPoint=function(a,b,c,d,e,f,g,h,i){return new primitives.common.Point((1-i)*(1-i)*(1-i)*a+3*(1-i)*(1-i)*i*c+3*(1-i)*i*i*e+i*i*i*g,(1-i)*(1-i)*(1-i)*b+3*(1-i)*(1-i)*i*d+3*(1-i)*i*i*f+i*i*i*h)};primitives.common.DotSegment=function(a,b,c,d,e){this.segmentType=4;this.x=a;this.y=b;this.width=c;this.height=d;this.cornerRadius=e};
primitives.common.Label=function(){this.position=this.text=null;this.weight=0;this.isActive=!0;this.horizontalAlignmentType=this.labelOrientation=this.labelType=0;this.verticalAlignmentType=2};primitives.common.LineSegment=function(){this.parent=primitives.common.MoveSegment.prototype;this.parent.constructor.apply(this,arguments);this.segmentType=0};primitives.common.LineSegment.prototype=new primitives.common.MoveSegment;primitives.common.LineSegment.prototype.clone=function(){return new primitives.common.LineSegment(this)};
primitives.common.LineSegment.prototype.trim=function(a,b){var c=this._offsetPoint(this,a,b);this.x=c.x;this.y=c.y;return this};primitives.common.LineSegment.prototype._offsetPoint=function(a,b,c){var d=null,d=a.distanceTo(b);return d=0===d||0===c?new primitives.common.Point(a):new primitives.common.Point(a.x+(b.x-a.x)/d*c,a.y+(b.y-a.y)/d*c)};
primitives.common.Matrix=function(a,b,c,d){this.b2=this.a2=this.b1=this.a1=null;switch(arguments.length){case 1:this.a1=a.a1;this.b1=a.b1;this.a2=a.a2;this.b2=a.b2;break;case 4:this.a1=a,this.b1=b,this.a2=c,this.b2=d}};primitives.common.Matrix.prototype.determinant=function(){return this.a1*this.b2-this.b1*this.a2};
primitives.common.PaletteItem=function(a){this.lineColor="#c0c0c0";this.lineWidth=1;this.lineType=0;this.opacity=this.fillColor=null;this._key="";var b,c,d,e;c=["lineColor","lineWidth","lineType","fillColor","opacity"];d=0;for(e=c.length;d<e;d+=1)b=c[d],null!=a&&a.hasOwnProperty(b)&&(this[b]=a[b]),this._key+=(!primitives.common.isNullOrEmpty(this._key)?", ":"")+b+":"+this[b]};
primitives.common.PaletteItem.prototype.toAttr=function(){var a={lineWidth:this.lineWidth,lineType:this.lineType};null!==this.fillColor&&(a.fillColor=this.fillColor);null!==this.opacity&&(a.opacity=this.opacity);null!==this.lineColor&&(a.borderColor=this.lineColor);return a};primitives.common.PaletteItem.prototype.toString=function(){return this._key};
primitives.common.PaletteManager=function(a,b){this.palette=[];this.cursor=0;var c,d;if(0===b.length)this.palette=[new primitives.common.PaletteItem({lineColor:a.linesColor,lineWidth:a.linesWidth,lineType:a.linesType})],this.paletteLength=this.palette.length,this.regularIndex=0;else{c=0;for(d=b.length;c<d;c+=1)this.palette.push(new primitives.common.PaletteItem(b[c]));this.paletteLength=this.palette.length;this.palette.push(new primitives.common.PaletteItem({lineColor:a.linesColor,lineWidth:a.linesWidth,
lineType:a.linesType}));this.regularIndex=this.palette.length-1}this.palette.push(new primitives.common.PaletteItem({lineColor:a.highlightLinesColor,lineWidth:a.highlightLinesWidth,lineType:a.highlightLinesType}));this.highlightIndex=this.palette.length-1};primitives.common.PaletteManager.prototype.selectPalette=function(a){this.cursor=a%this.paletteLength};
primitives.common.PaletteManager.prototype.getPalette=function(a){var b=null;switch(a){case 1:b=this.regularIndex;break;case 2:b=this.highlightIndex;break;case 0:b=this.cursor}return this.palette[b]};
primitives.common.Polyline=function(a){function b(a,b){var c,d,f;if(null!=b){c=0;for(d=h.length;c<d&&(!(f=h[c])||!b.call(a,f,c));c+=1);}}function c(){return primitives.common.isNullOrEmpty(g.fillColor)}function d(a,b){this.segment=a;this.pointIndex=b}function e(a,b,c,f,e){var j=a.relateTo(b),g=e?0:c;2==j?b.offset(g):3==j&&0===b.from.context.pointIndex?(j=new primitives.common.LineSegment(b.from),f.addSegment(j),b.offset(g),f=b.from.clone(),f.context=new d(j,0),g=new primitives.common.Vector(a.to.clone(),
f),e||(b.from=f.clone()),g.offset(c),g.intersect(a),g.from.context.pushToSegment(g.from),b.intersect(g),e&&g.to.context.pushToSegment(g.to)):(b.offset(g),b.intersect(a));b.from.context.pushToSegment(b.from)}function f(a,b,c,d){var f,g=a[0],j=g.to.context.segment.getEndPoint().toString();b.hasOwnProperty(j)&&(f=b[j],e(g,f,c,d,!0),delete b[j]);g.to.context.pushToSegment(g.to);a.length=0}var g=new primitives.common.PaletteItem,h=[],i,j;switch(arguments.length){case 1:g=a}j=new primitives.common.PaletteItem({lineColor:g.lineColor,
lineWidth:0,fillColor:g.lineColor,opacity:1});d.prototype.pushToSegment=function(a){this.segment.setPoint(a,this.pointIndex)};return i={paletteItem:g,arrowPaletteItem:j,addSegment:function(a){h.push(a)},addSegments:function(a){h=h.concat(a)},mergeTo:function(a){a.addSegments(h)},length:function(){return h.length},loop:b,loopReversed:function(a,b){var c,d;if(null!=b)for(c=h.length-1;0<=c&&(!(d=h[c])||!b.call(a,d,c));c-=1);},transform:function(a,c){b(this,function(b){null!=b.transform&&b.transform(a,
c)})},isInvertable:c,addInverted:function(a){var b=!1,d=[];c()?a.loopReversed(this,function(a){4!=a.segmentType&&(b||(h.push(new primitives.common.MoveSegment(a.getEndPoint())),b=!0),d.unshift(a),1<d.length&&(d[1].invert(d[0].getEndPoint()),h.push(d[1]),d.length=1))}):a.mergeTo(i)},addArrow:function(a,b){var c,d,f;f=h.length;var e=3*a,g=2*a;switch(a){case 1:e=8;g=6;break;case 2:e=12;g=8;break;case 3:e=16,g=10}if(null!=b&&1<f&&(c=h[f-2].getEndPoint(),f=h[f-1],null!=f.trim)){d=new primitives.common.Point(f.getEndPoint());
c=f.trim(c,g);var i=c.x,s=c.y;f=d.x;d=d.y;for(var u=g,g=new primitives.common.Polyline(j),v,y,e=[new primitives.common.Point(e,-u/2),new primitives.common.Point(0,0),new primitives.common.Point(e,u/2),new primitives.common.Point(3*(e/4),0)],A=Math.atan2(s-d,i-f),i=0,s=e.length;i<s;i+=1)u=e[i],v=u.x*Math.cos(A)-u.y*Math.sin(A),y=u.x*Math.sin(A)+u.y*Math.cos(A),u.x=v+f,u.y=y+d;g.addSegment(new primitives.common.MoveSegment(e[0].x,e[0].y));g.addSegment(new primitives.common.LineSegment(e[1].x,e[1].y));
g.addSegment(new primitives.common.LineSegment(e[2].x,e[2].y));g.addSegment(new primitives.common.QuadraticArcSegment(e[3].x,e[3].y,e[0].x,e[0].y));b(g,c)}},optimizeMoveSegments:function(){var a,b,c,d,f;c={};var e=[],g=[];a=0;for(b=h.length;a<b-1;a+=1)switch(d=h[a],f=h[a+1],d.segmentType){case 0:case 2:case 3:switch(f.segmentType){case 1:case 4:d=d.x+"&"+d.y,c.hasOwnProperty(d)||(c[d]=a)}break;case 1:d=d.x+"&"+d.y,c.hasOwnProperty(d)&&!e[c[d]]&&(e[c[d]]=a+1,g[a]=!0)}f=[];for(a=0;a<b;a+=1)if(!g[a]&&
(d=h[a],f.push(d),g[a]=!0,0<e[a]))for(c=e[a];c<b&&!g[c];)d=h[c],f.push(d),g[c]=!0,c=0<e[c]?e[c]:c+1;h=f},getOffsetPolyine:function(a){var c=new primitives.common.Polyline(g),j={},i=[],h=[];b(this,function(b){var g=b.clone();switch(g.segmentType){case 4:case 1:0<h.length&&f(h,j,a,c);i.length=0;1==g.segmentType&&(b=new primitives.common.Point(g),b.context=new d(g,0),i.push(b));break;default:g.loop(this,function(b,f,q){b=new primitives.common.Point(b,f);b.context=new d(g,q);i.unshift(b);1<i.length&&
(h.unshift(new primitives.common.Vector(i[1].clone(),i[0].clone())),i.length=1);switch(h.length){case 1:q=h[0];b=q.from.toString();j[b]=q;q.offset(a);q.from.context.pushToSegment(q.from);break;case 2:b=h[1],q=h[0],e(b,q,a,c,!1),h.length=1}})}c.addSegment(g)});0<h.length&&f(h,j,a,c);return c},toString:function(){return g.toString()}}};
primitives.common.PolylinesBuffer=function(){function a(a,b){a[b.toString()]||(a[b.toString()]=new primitives.common.Polyline(b));return a[b.toString()]}function b(a,b){var f,g;if(null!=b)for(f in c)if(c.hasOwnProperty(f)&&(g=c[f]))if(g.optimizeMoveSegments(),b.call(a,g))break}var c={};return{getPolyline:function(b){return a(c,b)},loop:b,addInverted:function(d,e){var f,g;f=c;c={};null!=d&&d(this);b(this,function(b){g=a(f,b.paletteItem);e?b.mergeTo(g):g.addInverted(b)});c=f},transform:function(a,c){b(this,
function(b){b.transform(a,c)})}}};primitives.common.QuadraticArcSegment=function(a,b,c,d){this.cpY=this.cpX=this.y=this.x=null;switch(arguments.length){case 2:this.x=b.x;this.y=b.y;this.cpX=a.x;this.cpY=a.y;break;case 4:this.cpX=a,this.cpY=b,this.x=c,this.y=d}this.segmentType=2};primitives.common.QuadraticArcSegment.prototype.clone=function(){return new primitives.common.QuadraticArcSegment(this.cpX,this.cpY,this.x,this.y)};
primitives.common.QuadraticArcSegment.prototype.loop=function(a,b){null!=b&&(b.call(a,this.cpX,this.cpY,0),b.call(a,this.x,this.y,1))};primitives.common.QuadraticArcSegment.prototype.setPoint=function(a,b){switch(b){case 0:this.cpX=a.x;this.cpY=a.y;break;case 1:this.x=a.x,this.y=a.y}};primitives.common.QuadraticArcSegment.prototype.getEndPoint=function(){return this};primitives.common.QuadraticArcSegment.prototype.invert=function(a){this.x=a.x;this.y=a.y};
primitives.common.QuadraticArcSegment.prototype.transform=function(a,b){var c=this;a.transformPoints(c.x,c.y,c.cpX,c.cpY,b,c,function(a,b,f,g){c.x=a;c.y=b;c.cpX=f;c.cpY=g})};
primitives.common.QuadraticArcSegment.prototype.trim=function(a,b){var c=0.5,d=this.offsetPoint(this.x,this.y,this.cpX,this.cpY,a.x,a.y,c),e=this.offsetPoint(this.x,this.y,this.cpX,this.cpY,a.x,a.y,0.1),c=b*(c/d.distanceTo(this.x,this.y)+0.1/e.distanceTo(this.x,this.y))/2,d=this.offsetPoint(this.x,this.y,this.cpX,this.cpY,a.x,a.y,c);this.x=d.x;this.y=d.y;return this};
primitives.common.QuadraticArcSegment.prototype.offsetPoint=function(a,b,c,d,e,f,g){return new primitives.common.Point((1-g)*(1-g)*a+2*(1-g)*g*c+g*g*e,(1-g)*(1-g)*b+2*(1-g)*g*d+g*g*f)};
primitives.common.Rect=function(a,b,c,d){this.height=this.width=this.y=this.x=null;switch(arguments.length){case 1:this.x=a.x;this.y=a.y;this.width=a.width;this.height=a.height;break;case 2:this.x=Math.min(a.x,b.x);this.y=Math.min(a.y,b.y);this.width=Math.abs(b.x-a.x);this.height=Math.abs(b.y-a.y);break;case 4:this.x=a,this.y=b,this.width=c,this.height=d}};primitives.common.Rect.prototype.left=function(){return this.x};primitives.common.Rect.prototype.top=function(){return this.y};
primitives.common.Rect.prototype.right=function(){return this.x+this.width};primitives.common.Rect.prototype.bottom=function(){return this.y+this.height};primitives.common.Rect.prototype.verticalCenter=function(){return this.y+this.height/2};primitives.common.Rect.prototype.horizontalCenter=function(){return this.x+this.width/2};primitives.common.Rect.prototype.centerPoint=function(){return new primitives.common.Point(this.horizontalCenter(),this.verticalCenter())};
primitives.common.Rect.prototype.isEmpty=function(){return null===this.x||null===this.y||null===this.width||null===this.height||0>this.width||0>this.height};
primitives.common.Rect.prototype.offset=function(a,b,c,d){switch(arguments.length){case 1:null!==a&&"object"==typeof a?(this.x-=a.left,this.y-=a.top,this.width=this.width+a.left+a.right,this.height=this.height+a.top+a.bottom):(this.x-=a,this.y-=a,this.width+=2*a,this.height+=2*a);break;case 4:this.x-=a,this.y-=b,this.width=this.width+a+c,this.height=this.height+b+d}return this};primitives.common.Rect.prototype.scale=function(a){this.x*=a;this.y*=a;this.width*=a;this.height*=a;return this};
primitives.common.Rect.prototype.translate=function(a,b){this.x+=a;this.y+=b;return this};primitives.common.Rect.prototype.invert=function(){var a=this.width,b=this.x;this.width=this.height;this.height=a;this.x=this.y;this.y=b;return this};primitives.common.Rect.prototype.contains=function(a,b){switch(arguments.length){case 1:return this.x<=a.x&&a.x<=this.x+this.width&&this.y<=a.y&&a.y<=this.y+this.height;case 2:return this.x<=a&&a<=this.x+this.width&&this.y<=b&&b<=this.y+this.height;default:return!1}};
primitives.common.Rect.prototype.cropByRect=function(a){this.x<a.x&&(this.width-=a.x-this.x,this.x=a.x);this.right()>a.right()&&(this.width-=this.right()-a.right());this.y<a.y&&(this.height-=a.y-this.y,this.y=a.y);this.bottom()>a.bottom()&&(this.height-=this.bottom()-a.bottom());this.isEmpty()&&(this.height=this.width=this.y=this.x=null);return this};
primitives.common.Rect.prototype.overlaps=function(a){var b=!0;if(this.x+this.width<a.x||a.x+a.width<this.x||this.y+this.height<a.y||a.y+a.height<this.y)b=!1;return b};
primitives.common.Rect.prototype.addRect=function(a,b,c,d){var e,f;switch(arguments.length){case 1:a.isEmpty()||(this.isEmpty()?(this.x=a.x,this.y=a.y,this.width=a.width,this.height=a.height):(e=Math.max(this.right(),a.right()),f=Math.max(this.bottom(),a.bottom()),this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this.width=e-this.x,this.height=f-this.y));break;case 2:this.isEmpty()?(this.x=a,this.y=b,this.height=this.width=0):(e=Math.max(this.right(),a),f=Math.max(this.bottom(),b),this.x=Math.min(this.x,
a),this.y=Math.min(this.y,b),this.width=e-this.x,this.height=f-this.y);break;case 4:this.isEmpty()?(this.x=a,this.y=b,this.width=c,this.height=d):(e=Math.max(this.right(),a+c),f=Math.max(this.bottom(),b+d),this.x=Math.min(this.x,a),this.y=Math.min(this.y,b),this.width=e-this.x,this.height=f-this.y)}return this};primitives.common.Rect.prototype.getCSS=function(a){a=void 0!==a?a:"px";return{left:this.x+a,top:this.y+a,width:this.width+a,height:this.height+a}};
primitives.common.Rect.prototype.toString=function(a){var b,a=void 0!==a?a:"px";b=""+("left:"+this.x+a+";");b+="top:"+this.y+a+";";b+="width:"+this.width+a+";";return b+="height:"+this.height+a+";"};primitives.common.Rect.prototype.validate=function(){if(isNaN(this.x)||isNaN(this.y)||isNaN(this.width)||isNaN(this.height))throw"Invalid rect position.";};
primitives.common.Size=function(a,b){this.height=this.width=0;switch(arguments.length){case 1:this.width=a.width;this.height=a.height;break;case 2:this.width=a,this.height=b}};primitives.common.Size.prototype.invert=function(){var a=this.width;this.width=this.height;this.height=a;return this};primitives.common.Size.prototype.scale=function(a){this.width*=a;this.height*=a;return this};
primitives.common.Size.prototype.getCSS=function(a){a=void 0!==a?a:"px";return{left:this.x+a,top:this.y+a,width:this.width+a,height:this.height+a}};primitives.common.Size.prototype.cropBySize=function(a){this.width=Math.min(this.width,a.width);this.height=Math.min(this.height,a.height);return this};primitives.common.Size.prototype.addSize=function(a){this.width=Math.max(this.width,a.width);this.height=Math.max(this.height,a.height);return this};
primitives.common.Size.prototype.validate=function(){if(isNaN(this.width)||isNaN(this.height))throw"Invalid size.";};primitives.common.Thickness=function(a,b,c,d){this.left=a;this.top=b;this.right=c;this.bottom=d};primitives.common.Thickness.prototype.isEmpty=function(){return 0===this.left&&0===this.top&&0===this.right&&0===this.bottom};primitives.common.Thickness.prototype.toString=function(a){a=void 0!==a?a:"px";return this.left+a+", "+this.top+a+", "+this.right+a+", "+this.bottom+a};
primitives.common.Vector=function(a,b){this.to=this.from=null;switch(arguments.length){case 1:this.from=a.from;this.to=a.to;break;case 2:this.from=a,this.to=b}};primitives.common.Vector.prototype.isNull=function(){return this.from.x==this.to&&this.from.y==this.to.y};primitives.common.Vector.prototype.length=function(){return this.from.distanceTo(this.to)};primitives.common.Vector.prototype.equalTo=function(a){return this.from.equalTo(a.from)&&this.to.equalTo(a.to)};
primitives.common.Vector.prototype.relateTo=function(a){var b=0,c=this.to.x-this.from.x,d=this.to.y-this.from.y,e=a.to.x-a.from.x,a=a.to.y-a.from.y;switch((c?8:0)+(d?4:0)+(e?2:0)+(a?1:0)){case 0:case 1:case 2:case 3:case 4:case 8:case 12:b=1;break;case 5:b=0<d*a?2:3;break;case 10:b=0<c*e?2:3;break;case 15:c/e==d/a&&(b=0<c/e?2:3)}return b};
primitives.common.Vector.prototype.offset=function(a){var b=this.length(),c=(this.to.y-this.from.y)*a/b,a=-(this.to.x-this.from.x)*a/b;this.from.x+=c;this.from.y+=a;this.to.x+=c;this.to.y+=a};primitives.common.Vector.prototype.getLine=function(){var a=this.from.x,b=this.from.y,c=this.to.x,d=this.to.y;return[d-b,a-c,a*(b-d)+b*(c-a)]};
primitives.common.Vector.prototype.intersect=function(a){var b=this.getLine(),c=a.getLine(),d=(new primitives.common.Matrix(b[0],b[1],c[0],c[1])).determinant(),e;e=!1;0!==d&&(e=new primitives.common.Matrix(-b[2],b[1],-c[2],c[1]),e=e.determinant(),b=new primitives.common.Matrix(b[0],-b[2],c[0],-c[2]),b=b.determinant(),c=e/d,d=b/d,a.to.x=c,a.to.y=d,this.from.x=c,this.from.y=d,e=!0);return e};
primitives.common.Graphics=function(a){this.m_element=a;this.m_placeholders={};this.m_activePlaceholder=null;this.m_cache=new primitives.common.Cache;this.graphicsType=null;this.debug=this.hasGraphics=!1};
primitives.common.Graphics.prototype.clean=function(){var a,b,c,d;this.m_cache.clear();this.m_element=this.m_cache=null;for(a in this.m_placeholders)if(this.m_placeholders.hasOwnProperty(a)){b=this.m_placeholders[a];for(c in b.layers)b.layers.hasOwnProperty(c)&&(d=b.layers[c],d.canvas.remove(),d.canvas=null);b.layers.length=0;b.activeLayer=null;b.size=null;b.rect=null;b.div=null}this.m_placeholders.length=0;this.m_activePlaceholder=null};
primitives.common.Graphics.prototype.resize=function(a,b,c){a=this.m_placeholders[a];null!=a&&this.resizePlaceholder(a,b,c)};primitives.common.Graphics.prototype.resizePlaceholder=function(a,b,c){var d;a.size=new primitives.common.Size(b,c);a.rect=new primitives.common.Rect(0,0,b,c);for(d in a.layers)a.layers.hasOwnProperty(d)&&(b=a.layers[d],-1!==b.name&&b.canvas.css({position:"absolute",width:"0px",height:"0px"}))};primitives.common.Graphics.prototype.begin=function(){this.m_cache.begin()};
primitives.common.Graphics.prototype.end=function(){this.m_cache.end()};primitives.common.Graphics.prototype.reset=function(a,b){var c="none",d=-1;switch(arguments.length){case 1:"string"===typeof a?c=a:d=a;break;case 2:c=a,d=b}this.m_cache.reset(c,d)};
primitives.common.Graphics.prototype.activate=function(a,b){switch(arguments.length){case 1:"string"===typeof a?(this._activatePlaceholder(a),this._activateLayer(-1)):(this._activatePlaceholder("none"),this._activateLayer(a));break;case 2:this._activatePlaceholder(a),this._activateLayer(b)}return this.m_activePlaceholder};
primitives.common.Graphics.prototype._activatePlaceholder=function(a){var b=this.m_placeholders[a],c;void 0===b&&(c="none"===a?this.m_element:this.m_element.find("."+a),b=new primitives.common.Placeholder(a),b.div=c,b.size=new primitives.common.Size(c.innerWidth(),c.innerHeight()),b.rect=new primitives.common.Rect(0,0,b.size.width,b.size.height),this.m_placeholders[a]=b);this.m_activePlaceholder=b};
primitives.common.Graphics.prototype._activateLayer=function(a){var b=this.m_activePlaceholder.layers[a],c,d,e,f;if(void 0===b){c=this.m_activePlaceholder;if(-1===a)b=new primitives.common.Layer(a),b.canvas=c.div;else{d=jQuery("<div></div>");d.addClass("Layer"+a);new primitives.common.Rect(c.rect);d.css({position:"absolute",width:"0px",height:"0px"});e=null;for(f in c.layers)c.layers.hasOwnProperty(f)&&(b=c.layers[f],b.name<a&&(e=null!==e?Math.max(e,b.name):b.name));b=new primitives.common.Layer(a);
b.canvas=d;null===e?c.div.prepend(b.canvas[0]):b.canvas.insertAfter(c.layers[e].canvas)}c.layers[a]=b}this.m_activePlaceholder.activeLayer=b};
primitives.common.Graphics.prototype.text=function(a,b,c,d,e,f,g,h,i){var j=this.m_activePlaceholder,g={position:"absolute",padding:0,margin:0,"text-align":this._getTextAlign(g),"font-size":i["font-size"],"font-family":i["font-family"],"font-weight":i["font-weight"],"font-style":i["font-style"],color:i["font-color"],"line-height":i["font-size"]},i="";switch(f){case 0:case 3:g.left=a;g.top=b;g.width=c;g.height=d;break;case 1:g.left=a+Math.round(c/2-d/2);g.top=b+Math.round(d/2-c/2);g.width=d;g.height=
c;i="rotate(-90deg)";break;case 2:g.left=a+Math.round(c/2-d/2),g.top=b+Math.round(d/2-c/2),g.width=d,g.height=c,i="rotate(90deg)"}g["-webkit-transform-origin"]="center center";g["-moz-transform-origin"]="center center";g["-o-transform-origin"]="center center";g["-ms-transform-origin"]="center center";g["-webkit-transform"]=i;g["-moz-transform"]=i;g["-o-transform"]=i;g["-ms-transform"]=i;g.transform=i;g["max-width"]=g.width;g["max-height"]=g.height;e=e.replace(RegExp("\n","g"),"<br/>");switch(h){case 0:this.debug&&
(g.border="solid 1px black");a=this.m_cache.get(j.name,j.activeLayer.name,"text");null===a?(a=jQuery("<div></div>"),a.css(g),a.html(e),j.activeLayer.canvas.append(a),this.m_cache.put(j.name,j.activeLayer.name,"text",a)):(a.css(g),a.html(e));break;default:g["border-collapse"]="collapse",b={"vertical-align":this._getVerticalAlignment(h),padding:0},this.debug&&(b.border="solid 1px black"),a=this.m_cache.get(j.name,j.activeLayer.name,"textintable"),null===a?(a=jQuery("<table><tbody><tr><td></td></tr></tbody></table>"),
primitives.common.css(a,g),a.find("td").css(b).html(e),j.activeLayer.canvas.append(a),this.m_cache.put(j.name,j.activeLayer.name,"textintable",a)):(primitives.common.css(a,g),a.find("td").css(b).html(e))}};primitives.common.Graphics.prototype._getTextAlign=function(a){var b=null;switch(a){case 0:b="center";break;case 1:b="left";break;case 2:b="right"}return b};
primitives.common.Graphics.prototype._getVerticalAlignment=function(a){var b=null;switch(a){case 1:b="middle";break;case 0:b="top";break;case 2:b="bottom"}return b};primitives.common.Graphics.prototype.polylinesBuffer=function(a){a.loop(this,function(a){0<a.length()&&this.polyline(a)})};
primitives.common.Graphics.prototype.polyline=function(a){var b=null,c=null,d=a.paletteItem.toAttr();a.loop(this,function(a){switch(a.segmentType){case 1:b=Math.round(a.x)+0.5;c=Math.round(a.y)+0.5;break;case 0:this.rightAngleLine(b,c,Math.round(a.x)+0.5,Math.round(a.y)+0.5,d);b=Math.round(a.x)+0.5;c=Math.round(a.y)+0.5;break;case 4:this.dot(a.x,a.y,a.width,a.height,a.cornerRadius,d)}})};
primitives.common.Graphics.prototype.dot=function(a,b,c,d,e,f){var g=this.m_activePlaceholder,h=this.m_cache.get(g.name,g.activeLayer.name,"dot"),i=void 0!==f.lineWidth&&void 0!==f.borderColor,a={position:"absolute",width:c-(i?1:0),top:Math.round(b),left:Math.round(a),padding:0,margin:0,"line-height":"0px",overflow:"hidden",height:d-(i?1:0),background:f.fillColor,"-moz-border-radius":e,"-webkit-border-radius":e,"-khtml-border-radius":e,"border-radius":e,"font-size":"0px","border-style":i?"Solid":
"None","border-width":i?"1px":"0px","border-color":i?f.borderColor:""};null===h?(h=jQuery("<div></div>"),primitives.common.css(h,a),g.activeLayer.canvas.append(h),this.m_cache.put(g.name,g.activeLayer.name,"dot",h)):primitives.common.css(h,a)};
primitives.common.Graphics.prototype.rightAngleLine=function(a,b,c,d,e){var f=this.m_activePlaceholder,g=Math.abs(d-b)>Math.abs(c-a),h=e.lineWidth,e={position:"absolute",top:Math.round(Math.min(b,d)-(g?0:h/2)),left:Math.round(Math.min(a,c)-(g?h/2:0)),padding:0,margin:0,opacity:0.5,"line-height":"0px",overflow:"hidden",background:e.borderColor,"font-size":"0px"};g?(e.width=h,e.height=Math.abs(Math.round(d-b))):(e.width=Math.abs(Math.round(c-a)),e.height=h);a=this.m_cache.get(f.name,f.activeLayer.name,
"rect");null===a?(a=jQuery("<div></div>"),primitives.common.css(a,e),f.activeLayer.canvas.append(a),this.m_cache.put(f.name,f.activeLayer.name,"rect",a)):primitives.common.css(a,e)};
primitives.common.Graphics.prototype.template=function(a,b,c,d,e,f,g,h,i,j,k,l,n){var c=this.m_activePlaceholder,d="template"+(null!==j?j:primitives.common.hashCode(i)),m=0,j=this.m_cache.get(c.name,c.activeLayer.name,d);null!==n&&void 0!==n["border-width"]&&(m=this.getPxSize(n["border-width"]));a={width:g-m+"px",height:h-m+"px",top:b+f+"px",left:a+e+"px"};jQuery.extend(a,n);null==l&&(l=new primitives.common.RenderEventArgs);null==j?(j=jQuery(i),jQuery.extend(a,{position:"absolute",padding:"0px",
margin:"0px"},n),primitives.common.css(j,a),l.element=j,l.renderingMode=0,null!==k&&k(null,l),c.activeLayer.canvas.append(j),this.m_cache.put(c.name,c.activeLayer.name,d,j)):(l.element=j,l.renderingMode=1,primitives.common.css(j,a),null!==k&&k(null,l));return j};primitives.common.Graphics.prototype.getPxSize=function(a,b){var c=a;"string"===typeof a&&(c=0<a.indexOf("pt")?96*parseInt(a,10)/72:0<a.indexOf("%")?parseFloat(a)/100*b:parseInt(a,10));return c};
primitives.common.Cache=function(){this.threshold=20;this.m_visible={};this.m_invisible={}};primitives.common.Cache.prototype.begin=function(){var a,b,c,d;for(a in this.m_visible)if(this.m_visible.hasOwnProperty(a))for(b in this.m_visible[a])if(this.m_visible[a].hasOwnProperty(b)){for(c=this.m_visible[a][b].length-1;0<=c;c-=1)d=this.m_visible[a][b][c],d.css({visibility:"hidden"}),this.m_invisible[a][b].push(d);this.m_visible[a][b].length=0}};
primitives.common.Cache.prototype.end=function(){var a,b,c;for(a in this.m_visible)if(this.m_visible.hasOwnProperty(a))for(b in this.m_visible[a])if(this.m_visible[a].hasOwnProperty(b)&&this.m_invisible[a][b].length>this.threshold)for(;void 0!==(c=this.m_invisible[a][b].pop());)c.remove()};
primitives.common.Cache.prototype.reset=function(a,b){var a=a+"-"+b,c=null,d,e;for(d in this.m_visible[a])if(this.m_visible[a].hasOwnProperty(d)){for(e=this.m_visible[a][d].length-1;0<=e;e-=1)c=this.m_visible[a][d][e],this.m_invisible[a][d].push(c),c.css({visibility:"hidden"});this.m_visible[a][d].length=0}};
primitives.common.Cache.prototype.clear=function(){var a,b,c;for(a in this.m_visible)if(this.m_visible.hasOwnProperty(a))for(b in this.m_visible[a])if(this.m_visible[a].hasOwnProperty(b)){for(;void 0!==(c=this.m_visible[a][b].pop());)c.remove();for(;void 0!==(c=this.m_invisible[a][b].pop());)c.remove()}};
primitives.common.Cache.prototype.get=function(a,b,c){a=a+"-"+b;b=null;void 0===this.m_visible[a]&&(this.m_visible[a]={},this.m_invisible[a]={});void 0===this.m_visible[a][c]&&(this.m_visible[a][c]=[],this.m_invisible[a][c]=[]);b=this.m_invisible[a][c].pop()||null;null!==b&&(this.m_visible[a][c].push(b),b.css({visibility:"inherit"}));return b};primitives.common.Cache.prototype.put=function(a,b,c,d){this.m_visible[a+"-"+b][c].push(d)};
primitives.common.CanvasGraphics=function(a){this.parent=primitives.common.Graphics.prototype;this.parent.constructor.apply(this,arguments);this.graphicsType=1;this.m_maximum=8E3};primitives.common.CanvasGraphics.prototype=new primitives.common.Graphics;
primitives.common.CanvasGraphics.prototype.clean=function(){var a,b,c,d;for(a in this.m_placeholders)if(this.m_placeholders.hasOwnProperty(a))for(c in b=this.m_placeholders[a],b.layers)b.layers.hasOwnProperty(c)&&(d=b.layers[c],null!==d.canvascanvas&&(d.canvascanvas.remove(),d.canvascanvas=null));this.parent.clean.apply(this,arguments)};
primitives.common.CanvasGraphics.prototype._activatePlaceholder=function(a){var b,c,d;this.parent._activatePlaceholder.apply(this,arguments);b=this.m_activePlaceholder;c=b.size.width;d=b.size.height;b.hasGraphics=c>this.m_maximum||d>this.m_maximum?!1:!0};
primitives.common.CanvasGraphics.prototype.resizePlaceholder=function(a,b,c){var d,e;this.parent.resizePlaceholder.apply(this,arguments);for(d in a.layers)a.layers.hasOwnProperty(d)&&(e=a.layers[d],null!==e.canvascanvas&&(e.canvascanvas.css({position:"absolute",width:b+"px",height:c+"px"}),e.canvascanvas.attr({width:b+"px",height:c+"px"})))};
primitives.common.CanvasGraphics.prototype.begin=function(){var a,b,c,d,e,f;this.parent.begin.apply(this);for(a in this.m_placeholders)if(this.m_placeholders.hasOwnProperty(a))for(c in b=this.m_placeholders[a],e=b.size.width,f=b.size.height,b.layers)b.layers.hasOwnProperty(c)&&(d=b.layers[c],null!==d.canvascanvas&&d.canvascontext.clearRect(0,0,e,f))};
primitives.common.Graphics.prototype._getContext=function(a,b){var c=a.size.width,d=a.size.height;null===b.canvascanvas&&(b.canvascanvas=jQuery("<canvas></canvas>"),b.canvascanvas.attr({width:c+"px",height:d+"px"}),a.activeLayer.canvas.prepend(b.canvascanvas),b.canvascontext=b.canvascanvas[0].getContext("2d"));return b.canvascontext};
primitives.common.CanvasGraphics.prototype.reset=function(a,b){var c="none",d=-1,e,f;switch(arguments.length){case 1:"string"===typeof a?c=a:d=a;break;case 2:c=a,d=b}this.parent.reset.apply(this,arguments);e=this.m_placeholders[c];void 0!==e&&(c=e.size.width,f=e.size.height,d=e.layers[d],void 0!==d&&null!==d.canvascanvas&&d.canvascontext.clearRect(0,0,c,f))};
primitives.common.CanvasGraphics.prototype.polyline=function(a){var b=this.m_activePlaceholder,c,d,e=a.paletteItem.toAttr(),f,g;if(b.hasGraphics){c=b.activeLayer;d=this._getContext(b,c);d.save();void 0!==e.lineWidth&&void 0!==e.borderColor?(d.strokeStyle=e.borderColor,d.lineWidth=e.lineWidth):(d.lineWidth=0,d.strokeStyle="Transparent");if(null!=e.lineType){b=Math.round(e.lineWidth)||1;switch(e.lineType){case 0:f=[];break;case 1:f=[b,b];break;case 2:f=[5*b,3*b]}void 0!==d.setLineDash?d.setLineDash(f):
void 0!==d.webkitLineDash?d.webkitLineDash=f:void 0!==d.mozDash&&(d.mozDash=f)}d.beginPath();a.loop(this,function(a){switch(a.segmentType){case 1:d.moveTo(Math.round(a.x)+0.5,Math.round(a.y)+0.5);break;case 0:d.lineTo(Math.round(a.x)+0.5,Math.round(a.y)+0.5);break;case 4:a.width==a.height&&a.width/2<=a.cornerRadius?(d.moveTo(Math.round(a.x)+a.width+0.5,Math.round(a.y)+a.height/2+0.5),d.arc(Math.round(a.x)+a.width/2+0.5,Math.round(a.y)+a.height/2+0.5,Math.round(a.width/2),0,2*Math.PI,!1)):0===a.cornerRadius?
(d.moveTo(Math.round(a.x)+0.5,Math.round(a.y)+0.5),d.lineTo(Math.round(a.x+a.width)+0.5,Math.round(a.y)+0.5),d.lineTo(Math.round(a.x+a.width)+0.5,Math.round(a.y+a.height)+0.5),d.lineTo(Math.round(a.x)+0.5,Math.round(a.y+a.height)+0.5),d.lineTo(Math.round(a.x)+0.5,Math.round(a.y)+0.5)):(g=Math.min(a.cornerRadius,Math.min(a.width/2,a.height/2)),d.moveTo(Math.round(a.x)+0.5,Math.round(a.y+g)+0.5),d.arc(Math.round(a.x+g)+0.5,Math.round(a.y+g)+0.5,Math.round(g),Math.PI,-Math.PI/2,!1),d.lineTo(Math.round(a.x+
a.width-g)+0.5,Math.round(a.y)+0.5),d.arc(Math.round(a.x+a.width-g)+0.5,Math.round(a.y+g)+0.5,Math.round(g),-Math.PI/2,0,!1),d.lineTo(Math.round(a.x+a.width)+0.5,Math.round(a.y+a.height-g)+0.5),d.arc(Math.round(a.x+a.width-g)+0.5,Math.round(a.y+a.height-g)+0.5,Math.round(g),0,Math.PI/2,!1),d.lineTo(Math.round(a.x+g)+0.5,Math.round(a.y+a.height)+0.5),d.arc(Math.round(a.x+g)+0.5,Math.round(a.y+a.height-g)+0.5,Math.round(g),Math.PI/2,Math.PI,!1),d.lineTo(Math.round(a.x)+0.5,Math.round(a.y+g)+0.5));break;
case 2:d.quadraticCurveTo(Math.round(a.cpX)+0.5,Math.round(a.cpY)+0.5,Math.round(a.x)+0.5,Math.round(a.y)+0.5);break;case 3:d.bezierCurveTo(Math.round(a.cpX1)+0.5,Math.round(a.cpY1)+0.5,Math.round(a.cpX2)+0.5,Math.round(a.cpY2)+0.5,Math.round(a.x)+0.5,Math.round(a.y)+0.5)}});void 0!==e.lineWidth&&d.stroke();void 0!==e.fillColor&&(d.fillStyle=e.fillColor,d.globalAlpha=e.opacity,d.fill());d.restore()}else this.parent.polyline.apply(this,arguments)};
primitives.common.Element=function(a,b){this.name=this.ns=null;this.attr={};this.style={};this.children=[];switch(arguments.length){case 1:this.name=a;break;case 2:this.ns=a,this.name=b}};primitives.common.Element.prototype.setAttribute=function(a,b){this.attr[a]=b};primitives.common.Element.prototype.appendChild=function(a){this.children[this.children.length]=a};
primitives.common.Element.prototype.create=function(a){var b=null,c,d,b=null!==this.ns?document.createElementNS(this.ns,this.name):document.createElement(this.name);for(c in this.attr)this.attr.hasOwnProperty(c)&&(void 0!==a?b[c]=this.attr[c]:b.setAttribute(c,this.attr[c]));for(c in this.style)this.style.hasOwnProperty(c)&&(b.style[c]=this.style[c]);for(d=0;d<this.children.length;d+=1)c=this.children[d],"string"===typeof c?b.appendChild(document.createTextNode(c)):b.appendChild(c.create(a));return b};
primitives.common.Element.prototype.update=function(a,b){var c,d,e;for(c in this.style)this.style.hasOwnProperty(c)&&(d=this.style[c],a.style[c]!==d&&(a.style[c]=d));for(c in this.attr)this.attr.hasOwnProperty(c)&&(d=this.attr[c],void 0!==b?a[c]!==d&&(a[c]=d):a.getAttribute(c)!==d&&a.setAttribute(c,d));c=this.children.length;for(d=0;d<c;d+=1)e=this.children[d],"string"===typeof e?a.innerHtml!==e&&(a.innerHtml=e):this.children[d].update(a.children[d],b)};
primitives.common.Layer=function(a){this.name=a;this.svgcanvas=this.canvascanvas=this.canvas=null};primitives.common.Placeholder=function(a){this.name=a;this.layers={};this.div=this.rect=this.size=this.activeLayer=null;this.hasGraphics=!0};primitives.common.SvgGraphics=function(a){this.parent=primitives.common.Graphics.prototype;this.parent.constructor.apply(this,arguments);this._svgxmlns="http://www.w3.org/2000/svg";this.graphicsType=0;this.hasGraphics=!0};
primitives.common.SvgGraphics.prototype=new primitives.common.Graphics;primitives.common.SvgGraphics.prototype.clean=function(){var a,b,c,d;for(a in this.m_placeholders)if(this.m_placeholders.hasOwnProperty(a))for(c in b=this.m_placeholders[a],b.layers)b.layers.hasOwnProperty(c)&&(d=b.layers[c],null!==d.svgcanvas&&(d.svgcanvas.remove(),d.svgcanvas=null));this.parent.clean.apply(this,arguments)};
primitives.common.SvgGraphics.prototype.resizePlaceholder=function(a,b,c){var d,e,f;this.parent.resizePlaceholder.apply(this,arguments);for(d in a.layers)a.layers.hasOwnProperty(d)&&(e=a.layers[d],null!==e.svgcanvas&&(f={position:"absolute",width:b+"px",height:c+"px"},e.svgcanvas.css(f),e.svgcanvas.attr({viewBox:"0 0 "+b+" "+c})))};
primitives.common.SvgGraphics.prototype._getCanvas=function(){var a=this.m_activePlaceholder,b=a.activeLayer,c=a.rect;null===b.svgcanvas&&(b.svgcanvas=jQuery('<svg version = "1.1"></svg>'),b.svgcanvas.attr({viewBox:c.x+" "+c.y+" "+c.width+" "+c.height}),b.svgcanvas.css({width:c.width+"px",height:c.height+"px"}),a.activeLayer.canvas.prepend(b.svgcanvas));return b.svgcanvas};
primitives.common.SvgGraphics.prototype.polyline=function(a){var b=this.m_activePlaceholder,c,d,e=a.paletteItem.toAttr(),f,g,h;c=new primitives.common.Element(this._svgxmlns,"path");void 0!==e.fillColor?(c.setAttribute("fill",e.fillColor),c.setAttribute("fill-opacity",e.opacity)):c.setAttribute("fill-opacity",0);void 0!==e.lineWidth&&void 0!==e.borderColor?(c.setAttribute("stroke",e.borderColor),c.setAttribute("stroke-width",e.lineWidth)):(c.setAttribute("stroke","transparent"),c.setAttribute("stroke-width",
0));if(null!=e.lineType)switch(f=Math.round(e.lineWidth)||1,e.lineType){case 0:c.setAttribute("stroke-dasharray","");break;case 1:c.setAttribute("stroke-dasharray",f+","+f);break;case 2:c.setAttribute("stroke-dasharray",5*f+","+3*f)}d="";a.loop(this,function(a){switch(a.segmentType){case 1:d+="M"+(Math.round(a.x)+0.5)+" "+(Math.round(a.y)+0.5);break;case 0:d+="L"+(Math.round(a.x)+0.5)+" "+(Math.round(a.y)+0.5);break;case 2:d+="Q"+(Math.round(a.cpX)+0.5)+" "+(Math.round(a.cpY)+0.5)+" "+(Math.round(a.x)+
0.5)+" "+(Math.round(a.y)+0.5);break;case 4:a.width==a.height&&a.width/2<=a.cornerRadius?(g=a.width/2,d+="M"+(Math.round(a.x)+0.5)+" "+(Math.round(a.y)+a.height/2+0.5),d+="A"+g+" "+g+" 0 0 0 "+(Math.round(a.x+a.width)+0.5)+" "+(Math.round(a.y)+a.height/2+0.5),d+="A"+g+" "+g+" 0 0 0 "+(Math.round(a.x)+0.5)+" "+(Math.round(a.y)+a.height/2+0.5)):0===a.cornerRadius?(d+="M"+(Math.round(a.x)+0.5)+" "+(Math.round(a.y)+0.5),d+="L"+(Math.round(a.x+a.width)+0.5)+" "+(Math.round(a.y)+0.5),d+="L"+(Math.round(a.x+
a.width)+0.5)+" "+(Math.round(a.y+a.height)+0.5),d+="L"+(Math.round(a.x)+0.5)+" "+(Math.round(a.y+a.height)+0.5),d+="L"+(Math.round(a.x)+0.5)+" "+(Math.round(a.y)+0.5)):(h=Math.min(a.cornerRadius,Math.min(a.width/2,a.height/2)),d+="M"+(Math.round(a.x)+0.5)+" "+(Math.round(a.y+h)+0.5),d+="A"+Math.round(h)+" "+Math.round(h)+" 0 0 1 "+(Math.round(a.x+h)+0.5)+" "+(Math.round(a.y)+0.5),d+="L"+(Math.round(a.x+a.width-h)+0.5)+" "+(Math.round(a.y)+0.5),d+="A"+Math.round(h)+" "+Math.round(h)+" 0 0 1 "+(Math.round(a.x+
a.width)+0.5)+" "+(Math.round(a.y+h)+0.5),d+="L"+(Math.round(a.x+a.width)+0.5)+" "+(Math.round(a.y+a.height-h)+0.5),d+="A"+Math.round(h)+" "+Math.round(h)+" 0 0 1 "+(Math.round(a.x+a.width-h)+0.5)+" "+(Math.round(a.y+a.height)+0.5),d+="L"+(Math.round(a.x+h)+0.5)+" "+(Math.round(a.y+a.height)+0.5),d+="A"+Math.round(h)+" "+Math.round(h)+" 0 0 1 "+(Math.round(a.x)+0.5)+" "+(Math.round(a.y+a.height-h)+0.5),d+="L"+(Math.round(a.x)+0.5)+" "+(Math.round(a.y+h)+0.5));break;case 3:d+="C"+(Math.round(a.cpX1)+
0.5)+" "+(Math.round(a.cpY1)+0.5)+" "+(Math.round(a.cpX2)+0.5)+" "+(Math.round(a.cpY2)+0.5)+" "+(Math.round(a.x)+0.5)+" "+(Math.round(a.y)+0.5)}});c.setAttribute("d",d);a=this.m_cache.get(b.name,b.activeLayer.name,"path");null===a?(a=jQuery(c.create()),c=this._getCanvas(),c.append(a),this.m_cache.put(b.name,b.activeLayer.name,"path",a)):c.update(a[0])};primitives.common.Transform=function(){this.invertVertically=this.invertHorizontally=this.invertArea=!1;this.size=null};
primitives.common.Transform.prototype.setOrientation=function(a){switch(a){case 0:this.invertVertically=this.invertHorizontally=this.invertArea=!1;break;case 1:this.invertHorizontally=this.invertArea=!1;this.invertVertically=!0;break;case 2:this.invertArea=!0;this.invertVertically=this.invertHorizontally=!1;break;case 3:this.invertHorizontally=this.invertArea=!0,this.invertVertically=!1}};
primitives.common.Transform.prototype.getOrientation=function(a){var b=a;if(this.invertHorizontally)switch(a){case 2:b=3;break;case 3:b=2}if(this.invertVertically)switch(a){case 0:b=1;break;case 1:b=0}if(this.invertArea)switch(b){case 0:b=2;break;case 1:b=3;break;case 2:b=0;break;case 3:b=1}return b};
primitives.common.Transform.prototype.transformPoint=function(a,b,c,d,e){var f;c&&this.invertArea&&(f=a,a=b,b=f);this.invertHorizontally&&(a=this.size.width-a);this.invertVertically&&(b=this.size.height-b);!c&&this.invertArea&&(f=a,a=b,b=f);e.call(d,a,b)};
primitives.common.Transform.prototype.transformPoints=function(a,b,c,d,e,f,g){var h;e&&this.invertArea&&(h=a,a=b,b=h,h=c,c=d,d=h);this.invertHorizontally&&(a=this.size.width-a,c=this.size.width-c);this.invertVertically&&(b=this.size.height-b,d=this.size.height-d);!e&&this.invertArea&&(h=a,a=b,b=h,h=c,c=d,d=h);g.call(f,a,b,c,d)};
primitives.common.Transform.prototype.transform3Points=function(a,b,c,d,e,f,g,h,i){var j;g&&this.invertArea&&(j=a,a=b,b=j,j=c,c=d,d=j,j=e,e=f,f=j);this.invertHorizontally&&(a=this.size.width-a,c=this.size.width-c,e=this.size.width-e);this.invertVertically&&(b=this.size.height-b,d=this.size.height-d,f=this.size.height-f);!g&&this.invertArea&&(j=a,a=b,b=j,j=c,c=d,d=j,j=e,e=f,f=j);i.call(h,a,b,c,d,e,f)};
primitives.common.Transform.prototype.transformRect=function(a,b,c,d,e,f,g){var h;e&&this.invertArea&&(h=a,a=b,b=h,h=c,c=d,d=h);this.invertHorizontally&&(a=this.size.width-a-c);this.invertVertically&&(b=this.size.height-b-d);!e&&this.invertArea&&(h=a,a=b,b=h,h=c,c=d,d=h);g.call(f,a,b,c,d)};
primitives.common.VmlGraphics=function(a){var b,c,d;this.parent=primitives.common.Graphics.prototype;this.parent.constructor.apply(this,arguments);this.prefix="rvml";this.ie8mode=document.documentMode&&8<=document.documentMode;try{eval("document.namespaces")}catch(e){}document.namespaces[this.prefix]||document.namespaces.add(this.prefix,"urn:schemas-microsoft-com:vml");if(!primitives.common.VmlGraphics.prototype.vmlStyle){b=primitives.common.VmlGraphics.prototype.vmlStyle=document.createStyleSheet();
c=" *;fill;shape;path;textpath;stroke".split(";");for(d=0;d<c.length;d+=1)b.addRule(this.prefix+"\\:"+c[d],"behavior:url(#default#VML); position:absolute;")}this.graphicsType=2;this.hasGraphics=!0};primitives.common.VmlGraphics.prototype=new primitives.common.Graphics;
primitives.common.VmlGraphics.prototype.text=function(a,b,c,d,e,f,g,h,i){var j,k,l;switch(f){case 0:case 3:this.parent.text.call(this,a,b,c,d,e,f,g,h,i);break;default:j=this.m_activePlaceholder;f=1===f;a=new primitives.common.Rect(a,b,c,d);d=new primitives.common.Rect(0,0,10*c,10*d);c=new primitives.common.Element(this.prefix+":shape");c.setAttribute("CoordSize",d.width+","+d.height);c.setAttribute("filled",!0);c.setAttribute("stroked",!1);c.setAttribute("fillcolor",i["font-color"]);c.style.top=a.y+
"px";c.style.left=a.x+"px";c.style.width=a.width+"px";c.style.height=a.height+"px";c.style["font-family"]=i["font-family"];a=new primitives.common.Element(this.prefix+":path");a.setAttribute("TextPathOk",!0);b=16*Math.floor(this.getPxSize(i["font-size"]))*Math.max(e.split("\n").length-1,1);l=k=null;if(f)switch(h){case 0:k=new primitives.common.Point(d.x+b/2,d.bottom());l=new primitives.common.Point(d.x+b/2,d.y);break;case 1:k=new primitives.common.Point(d.horizontalCenter(),d.bottom());l=new primitives.common.Point(d.horizontalCenter(),
d.y);break;case 2:k=new primitives.common.Point(d.right()-b/2,d.bottom()),l=new primitives.common.Point(d.right()-b/2,d.y)}else switch(h){case 0:k=new primitives.common.Point(d.right()-b/2,d.y);l=new primitives.common.Point(d.right()-b/2,d.bottom());break;case 1:k=new primitives.common.Point(d.horizontalCenter(),d.y);l=new primitives.common.Point(d.horizontalCenter(),d.bottom());break;case 2:k=new primitives.common.Point(d.x+b/2,d.y),l=new primitives.common.Point(d.x+b/2,d.bottom())}a.setAttribute("v",
" m"+k.x+","+k.y+" l"+l.x+","+l.y+" e");h=new primitives.common.Element(this.prefix+":textpath");h.setAttribute("on",!0);h.setAttribute("string",e);h.style.trim=!1;h.style["v-text-align"]=this._getTextAlign(g);h.style.font="normal normal normal "+i["font-size"]+"pt "+i["font-family"];c.appendChild(a);c.appendChild(h);e=this.m_cache.get(j.name,j.activeLayer.name,"vmltext");null===e?(e=jQuery(c.create(this.ie8mode)),j.activeLayer.canvas.append(e),this.m_cache.put(j.name,j.activeLayer.name,"vmltext",
e)):c.update(e[0],this.ie8mode)}};
primitives.common.VmlGraphics.prototype.polyline=function(a){var b=this.m_activePlaceholder,c=new primitives.common.Rect(b.rect),d=new primitives.common.Rect(0,0,10*c.width,10*c.height),e=new primitives.common.Element(this.prefix+":shape"),f,g,h,i,j,k,l;g=a.paletteItem.toAttr();void 0!==g.borderColor&&void 0!==g.lineWidth?(e.setAttribute("strokecolor",g.borderColor),e.setAttribute("strokeweight",g.lineWidth),e.setAttribute("stroked",!0)):e.setAttribute("stroked",!1);e.setAttribute("CoordSize",d.width+
","+d.height);e.style.top=c.y+"px";e.style.left=c.x+"px";e.style.width=c.width+"px";e.style.height=c.height+"px";f="";a.loop(this,function(a){switch(a.segmentType){case 1:f+=" m"+10*Math.round(a.x)+","+10*Math.round(a.y);break;case 0:f+=" l"+10*Math.round(a.x)+","+10*Math.round(a.y);break;case 4:h=Math.round(a.x);i=Math.round(a.y);j=Math.round(a.x+a.width);k=Math.round(a.y+a.height);h>j&&(l=h,h=j,j=l);i>k&&(l=i,i=k,k=l);h=10*h+5;i=10*i+5;j=10*j-5;k=10*k-5;f+=" m"+h+","+i;f+=" l"+j+","+i;f+=" l"+j+
","+k;f+=" l"+h+","+k;f+=" l"+h+","+i;break;case 2:f+=" qb"+10*Math.round(a.cpX)+","+10*Math.round(a.cpY)+" l"+10*Math.round(a.x)+","+10*Math.round(a.y);break;case 3:f+=" c"+10*Math.round(a.cpX1)+","+10*Math.round(a.cpY1)+","+10*Math.round(a.cpX2)+","+10*Math.round(a.cpY2)+","+10*Math.round(a.x)+","+10*Math.round(a.y)}});f+=" e";a="shapepath";c=new primitives.common.Element(this.prefix+":path");c.setAttribute("v",f);e.appendChild(c);if(null!=g.lineType){c=new primitives.common.Element(this.prefix+
":stroke");switch(g.lineType){case 0:c.setAttribute("dashstyle","Solid");break;case 1:c.setAttribute("dashstyle","ShortDot");break;case 2:c.setAttribute("dashstyle","Dash")}e.appendChild(c);a+="stroke"}null!==g.fillColor?(e.setAttribute("filled",!0),c=new primitives.common.Element(this.prefix+":fill"),c.setAttribute("opacity",g.opacity),c.setAttribute("color",g.fillColor),e.appendChild(c),a+="fill"):e.setAttribute("filled",!1);g=this.m_cache.get(b.name,b.activeLayer.name,a);null===g?(g=jQuery(e.create(this.ie8mode)),
b.activeLayer.canvas.append(g),this.m_cache.put(b.name,b.activeLayer.name,a,g)):e.update(g[0],this.ie8mode)};primitives.common.ArrayReader=function(a,b,c,d){this.itemTemplate=a;this.containsUniqueItems=b;this.uniquePropertyKey=c;this.containsPrimitiveValues=primitives.common.isNullOrEmpty(c);this.createSourceHash=d};
primitives.common.ArrayReader.prototype.read=function(a,b,c,d){var e=[],f={},g={},h={},i,j,k,l,n,m;if(!b||!Array.isArray(b))b=[];i=d.hash[c]||{};l=0;for(n=b.length;l<n;l+=1)j=b[l],k=this.containsUniqueItems?this.containsPrimitiveValues?j:j[this.uniquePropertyKey]:l,h.hasOwnProperty(k)||(h[k]=!0,m=i[k]||{},m=this.itemTemplate.read(m,j,c+"-"+l,d),e.push(m),f[k]=m,this.createSourceHash&&(g[k]=j));d.hash[c]=f;this.createSourceHash&&(d.sourceHash[c]=g);if(null==a||a.length!=e.length)d.isChanged=!0;return e};
primitives.common.EnumerationReader=function(a,b,c){this.enumeration=a;this.isNullable=b;this.defaultValue=c;this.hash={};for(var d in a)this.hash[a[d]]=d};primitives.common.EnumerationReader.prototype.read=function(a,b,c,d){if(null===b||"undefined"==typeof b||!this.hash.hasOwnProperty(b))b=this.isNullable?null:this.defaultValue;a!==b&&(d.isChanged=!0);return b};primitives.common.FunctionReader=function(){};
primitives.common.FunctionReader.prototype.read=function(a,b,c,d){a!==b&&(d.isChanged=!0);return"function"==typeof b?b:null};primitives.common.ObjectReader=function(a,b,c){this.dataTemplate=a;this.isNullable=b;this.defaultValue=c};
primitives.common.ObjectReader.prototype.read=function(a,b,c,d){var e=null,f,g;b||(b=this.isNullable?null:this.defaultValue);if(primitives.common.isObject(b))for(f in e={},this.dataTemplate)this.dataTemplate.hasOwnProperty(f)&&(g=this.dataTemplate[f],e[f]=g.read(primitives.common.isObject(a)?a[f]:null,b[f],c+"-"+f,d));else e=b,a!==b&&(d.isChanged=!0);return e};
primitives.common.ValueReader=function(a,b,c){this.acceptedTypes=a;this.isNullable=b;this.defaultValue=c;this.hash={};for(b=0;b<a.length;b+=1)this.hash[a[b]]=!0};primitives.common.ValueReader.prototype.read=function(a,b,c,d){if(null===b||"undefined"==typeof b||!this.hash.hasOwnProperty(typeof b))b=this.isNullable?null:this.defaultValue;a!==b&&(d.isChanged=!0);return b};
primitives.famdiagram.EventArgs=function(){this.context=this.oldContext=null;this.parentItems=[];this.name=this.position=null;this.cancel=!1};
primitives.famdiagram.TemplateConfig=function(){this.name=null;this.isActive=!0;this.itemSize=new primitives.common.Size(120,100);this.itemBorderWidth=1;this.minimizedItemShapeType=this.itemTemplate=null;this.minimizedItemSize=new primitives.common.Size(4,4);this.minimizedItemCornerRadius=null;this.minimizedItemLineWidth=1;this.minimizedItemBorderColor=null;this.minimizedItemLineType=0;this.minimizedItemFillColor=null;this.minimizedItemOpacity=1;this.highlightPadding=new primitives.common.Thickness(2,
2,2,2);this.highlightBorderWidth=1;this.highlightTemplate=null;this.cursorPadding=new primitives.common.Thickness(3,3,3,3);this.cursorBorderWidth=2;this.buttons=this.cursorTemplate=null};
primitives.famdiagram.BackgroundAnnotationConfig=function(a){var b;this.annotationType=4;this.items=[];this.zOrderType=0;this.lineWidth=2;this.opacity=1;this.fillColor=this.borderColor=null;this.lineType=0;this.selectItems=!1;switch(arguments.length){case 1:if(null!==a)if(a instanceof Array)this.items=a;else if("object"==typeof a)for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])}};
primitives.famdiagram.ButtonConfig=function(a,b,c){this.name=a;this.icon=b;this.text=!1;this.label=null;this.tooltip=c;this.size=new primitives.common.Size(16,16)};
primitives.famdiagram.Config=function(a){this.name=void 0!==a?a:"FamDiagram";this.classPrefix="famdiagram";this.graphicsType=this.navigationMode=0;this.actualGraphicsType=null;this.pageFitMode=3;this.minimalVisibility=2;this.orientationType=0;this.verticalAlignment=1;this.arrowsDirection=0;this.groupByType=2;this.elbowType=3;this.elbowDotSize=this.bevelSize=4;this.emptyDiagramMessage="Diagram is empty.";this.items=[];this.annotations=[];this.highligtItem=this.cursorItem=null;this.selectedItems=[];
this.hasSelectorCheckbox=0;this.selectCheckBoxLabel="Selected";this.neighboursSelectionMode=this.selectionPathMode=0;this.templates=[];this.defaultLabelAnnotationTemplate=this.defaultTemplateName=null;this.hasButtons=0;this.buttons=[];this.onCursorRender=this.onHighlightRender=this.onItemRender=this.onMouseDblClick=this.onMouseClick=this.onButtonClick=this.onSelectionChanged=this.onSelectionChanging=this.onCursorChanged=this.onCursorChanging=this.onHighlightChanged=this.onHighlightChanging=null;this.dotLevelShift=
this.normalLevelShift=20;this.normalItemsInterval=this.lineLevelShift=10;this.dotItemsInterval=1;this.lineItemsInterval=2;this.cousinsIntervalMultiplier=5;this.itemTitleFirstFontColor="#ffffff";this.itemTitleSecondFontColor="#000080";this.minimizedItemShapeType=6;this.linesColor="#c0c0c0";this.linesWidth=1;this.linesType=0;this.showNeigboursConnectorsHighlighted=!1;this.highlightLinesColor="#ff0000";this.highlightLinesWidth=1;this.highlightLinesType=0;this.linesPalette=[];this.showCallout=!0;this.defaultCalloutTemplateName=
null;this.calloutfillColor="#000000";this.calloutBorderColor=null;this.calloutCornerRadius=this.calloutOffset=4;this.calloutPointerWidth="10%";this.calloutLineWidth=1;this.calloutOpacity=0.2;this.buttonsPanelSize=28;this.checkBoxPanelSize=this.groupTitlePanelSize=24;this.distance=3;this.scale=1;this.minimumScale=0.5;this.maximumScale=1;this.showLabels=0;this.labelSize=new primitives.common.Size(80,24);this.labelOffset=1;this.labelOrientation=0;this.labelPlacement=1;this.labelFontSize="10px";this.labelFontFamily=
"Arial";this.labelColor="#000000";this.labelFontStyle=this.labelFontWeight="normal";this.enablePanning=!0;this.printPreviewPageSize=new primitives.common.Size(612,792);this.autoSizeMinimum=new primitives.common.Size(800,600);this.autoSizeMaximum=new primitives.common.Size(1024,768)};
primitives.famdiagram.ConnectorAnnotationConfig=function(a,b){var c;this.annotationType=0;this.zOrderType=2;this.toItem=this.fromItem=null;this.connectorShapeType=0;this.labelPlacementType=primitives.common.ConnectorLabelPlacementType.Between;this.offset=new primitives.common.Thickness(0,0,0,0);this.lineWidth=2;this.color="#000000";this.lineType=0;this.selectItems=!0;this.label=null;this.labelSize=new primitives.common.Size(60,30);switch(arguments.length){case 1:for(c in a)a.hasOwnProperty(c)&&(this[c]=
a[c]);break;case 2:this.fromItem=a,this.toItem=b}};primitives.famdiagram.HighlightPathAnnotationConfig=function(a){var b;this.annotationType=2;this.items=[];this.selectItems=!1;switch(arguments.length){case 1:if(null!==a)if(a instanceof Array)this.items=a;else if("object"==typeof a)for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])}};
primitives.famdiagram.ItemConfig=function(a,b,c,d,e){var f;this.id=null;this.parents=[];this.spouses=[];this.context=this.image=this.description=this.title=null;this.itemTitleColor="#4169e1";this.groupTitle=this.minimizedItemShapeType=null;this.groupTitleColor="#4169e1";this.isActive=!0;this.hasButtons=this.hasSelectorCheckbox=0;this.templateName=null;this.showCallout=0;this.label=this.calloutTemplateName=null;this.showLabel=0;this.labelSize=null;this.labelOrientation=3;this.labelPlacement=0;switch(arguments.length){case 1:for(f in a)a.hasOwnProperty(f)&&
(this[f]=a[f]);break;case 5:this.id=a,this.parent=b,this.title=c,this.description=d,this.image=e}};primitives.famdiagram.LabelAnnotationConfig=function(a,b){var c;this.annotationType=3;this.fromItem=null;this.toItems=[];this.title=null;this.itemTitleColor="#4169e1";this.templateName=null;switch(arguments.length){case 1:for(c in a)a.hasOwnProperty(c)&&(this[c]=a[c]);break;case 2:this.fromItem=a,this.toItem=b}};
primitives.famdiagram.PaletteItemConfig=function(a,b,c){var d;this.lineColor="#c0c0c0";this.lineWidth=1;this.lineType=0;switch(arguments.length){case 1:for(d in a)a.hasOwnProperty(d)&&(this[d]=a[d]);break;case 3:this.lineColor=a,this.lineWidth=b,this.lineType=c}};
primitives.famdiagram.ShapeAnnotationConfig=function(a){var b;this.annotationType=1;this.zOrderType=0;this.items=[];this.shapeType=0;this.offset=new primitives.common.Thickness(0,0,0,0);this.lineWidth=2;this.cornerRadius="10%";this.opacity=1;this.fillColor=this.borderColor=null;this.lineType=0;this.selectItems=!1;this.label=null;this.labelSize=new primitives.common.Size(60,30);this.labelPlacement=0;this.labelOffset=4;switch(arguments.length){case 1:if(null!==a)if(a instanceof Array)this.items=a;else if("object"==
typeof a)for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])}};primitives.famdiagram.EdgeItem=function(a,b,c,d){this.values=[b,d];this[a]=0;this[c]=1};primitives.famdiagram.EdgeItem.prototype.getNear=function(a){return this.values[this[a]]};primitives.famdiagram.EdgeItem.prototype.getFar=function(a){return this.values[Math.abs(this[a]-1)]};primitives.famdiagram.EdgeItem.prototype.setNear=function(a,b){this.values[this[a]]=b};
primitives.famdiagram.EdgeItem.prototype.setFar=function(a,b){this.values[Math.abs(this[a]-1)]=b};primitives.famdiagram.EdgeItem.prototype.toString=function(){return this.parent+","+this.child};primitives.famdiagram.ExtraGravity=function(a){this.toParent=this.fromParent=this.commonParent=null;this.level=a};primitives.famdiagram.Family=function(a){this.id=null;this.familyPriority=1;this.childFamilies=[];this.items=[];this.links=[];this.backLinks=[];1==arguments.length&&(this.id=a)};
primitives.famdiagram.FamilyItem=function(a){var b;this.itemConfig=this.familyId=this.id=null;this.isActive=this.isVisible=!0;this.isLevelNeutral=!1;this.level=null;this.levelGravity=0;this.hideChildrenConnection=this.hideParentConnection=!1;switch(arguments.length){case 1:for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])}};primitives.famdiagram.FamLink=function(a,b){this.fromItem=a;this.toItem=b};
primitives.famdiagram.Slot=function(a){this.position=this.next=this.prev=this.id=null;this.balance=0;this.itemId=a;this.left={};this.right={};this.crossings={}};
primitives.famdiagram.Slot.prototype.clone=function(){var a=new primitives.famdiagram.Slot,b;a.itemId=this.itemId;for(b in this.left)this.left.hasOwnProperty(b)&&(a.left[b]=this.left[b]);for(b in this.right)this.right.hasOwnProperty(b)&&(a.right[b]=this.right[b]);for(b in this.crossings)this.crossings.hasOwnProperty(b)&&(a.crossings[b]=this.crossings[b]);return a};primitives.famdiagram.Slots=function(){this.last=this.first=null;this.slots={};this.items={};this.counter=0};
primitives.famdiagram.Slots.prototype.add=function(a){a.id=this.counter;this.counter+=1;this.slots[a.id]=a;null!=a.itemId&&(this.items[a.itemId]=a);null==this.last?this.first=this.last=a.id:(this.slots[this.last].next=a.id,a.prev=this.last,this.last=a.id)};
primitives.famdiagram.Slots.prototype.insertBefore=function(a,b){b.id=this.counter;this.counter+=1;this.slots[b.id]=b;null!=b.itemId&&(this.items[b.itemId]=b);if(null==a.prev)b.next=a.id,this.first=b.id;else{var c=this.slots[a.prev];c.next=b.id;b.next=a.id;a.prev=b.id;b.prev=c.id}};primitives.famdiagram.Slots.prototype.loop=function(a,b){for(var c=null!=b?b.id:this.first;null!=c;){c=this.slots[c];if(a(c))break;c=c.next}};
primitives.famdiagram.Slots.prototype.backwardLoop=function(a,b){for(var c=null!=b?b.id:this.last;null!=c;){c=this.slots[c];if(a(c))break;c=c.prev}};primitives.famdiagram.Slots.prototype.getSlot=function(a){return this.items[a]};
primitives.famdiagram.LabelAnnotationOptionTask=function(a,b,c){var d=[],e={},f=null,g={},h=new primitives.common.ArrayReader(new primitives.common.ObjectReader({zOrderType:new primitives.common.EnumerationReader(primitives.common.ZOrderType,!1,c.zOrderType),fromItem:new primitives.common.ValueReader(["string","number"],!0),toItems:new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0),title:new primitives.common.ValueReader(["string"],!0),itemTitleColor:new primitives.common.ValueReader(["string"],
!1,c.itemTitleColor),templateName:new primitives.common.ValueReader(["string"],!0)},!1),!1,null,!0);return{process:function(){var c={isChanged:!1,hash:g,sourceHash:{}},j=b.getMaximumId(),k,l,n;d=h.read(d,a.getAnnotations(3),"annotations",c);e={};var m=c.sourceHash.annotations;k=0;for(l=d.length;k<l;k+=1)n=d[k],j+=1,n.id=j,e[n.id]=m[k];f=j;return c.isChanged},getAnnotations:function(){return d},getMaximumId:function(){return f},getConfig:function(a){return e[a]}}};
primitives.famdiagram.LabelAnnotationPlacementOptionTask=function(a){var b=[],c={},d=new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["number"],!0),fromItem:new primitives.common.ValueReader(["string","number"],!0),toItems:new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0)}),!0,"id");return{process:function(){var e={isChanged:!1,hash:c};b=d.read(b,a.getAnnotations(),"annotations",e);return e.isChanged},
getAnnotations:function(){return b},getMaximumId:function(){return a.getMaximumId()}}};
primitives.famdiagram.LabelAnnotationTemplateOptionTask=function(a,b){var c=[],d={},e=new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["number"],!0),title:new primitives.common.ValueReader(["string"],!0),itemTitleColor:new primitives.common.ValueReader(["string"],!1,b.itemTitleColor),templateName:new primitives.common.ValueReader(["string"],!0)}),!0,"id");return{process:function(){var b={isChanged:!1,hash:d};c=e.read(c,a.getAnnotations(),
"annotations",b);return b.isChanged},getAnnotations:function(){return c}}};primitives.famdiagram.NeighboursSelectionModeOptionTask=function(a,b){var c={},d=new primitives.common.ObjectReader({neighboursSelectionMode:new primitives.common.EnumerationReader(primitives.common.NeighboursSelectionMode,!1,b.neighboursSelectionMode)});return{process:function(){var b={isChanged:!1};c=d.read(c,a.getOptions(),"options",b);return b.isChanged},getNeighboursSelectionMode:function(){return c.neighboursSelectionMode}}};
primitives.famdiagram.ItemsOptionTask=function(a,b){var c={},d={},e={},f=new primitives.common.ObjectReader({items:new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["string","number"],!0),parents:new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0),isActive:new primitives.common.ValueReader(["boolean"],!1,b.isActive)}),!0,"id",!0)});return{process:function(){var b={isChanged:!1,hash:d,sourceHash:e};
c=f.read(c,a.getOptions(),"options",b);return b.isChanged},getItems:function(){return c.items},getConfig:function(a){return e["options-items"][a]}}};
primitives.famdiagram.LinePaletteOptionTask=function(a,b){var c={},d={},e=new primitives.common.ObjectReader({linesPalette:new primitives.common.ArrayReader(new primitives.common.ObjectReader({lineColor:new primitives.common.ValueReader(["string"],!1,b.lineColor),lineWidth:new primitives.common.ValueReader(["number"],!1,b.lineWidth),lineType:new primitives.common.EnumerationReader(primitives.common.LineType,!1,b.lineType)}),!1)});return{process:function(){var b={isChanged:!1,hash:d};c=e.read(c,a.getOptions(),
"options",b);return b.isChanged},getOptions:function(){return c}}};primitives.famdiagram.NormalizeOptionTask=function(a,b){var c={},d={},e=new primitives.common.ObjectReader({groupByType:new primitives.common.EnumerationReader(primitives.common.GroupByType,!1,b.groupByType)});return{process:function(){var b={isChanged:!1,hash:d};c=e.read(c,a.getOptions(),"options",b);return b.isChanged},getOptions:function(){return c}}};
primitives.famdiagram.SpousesOptionTask=function(a){var b={},c={},d=new primitives.common.ObjectReader({items:new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["string","number"],!0),spouses:new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0)}),!0,"id")});return{process:function(){var e={isChanged:!1,hash:c};b=d.read(b,a.getOptions(),"options",e);return e.isChanged},getItems:function(){return b.items}}};
primitives.famdiagram.VisualTreeOptionTask=function(){var a={leavesPlacementType:2,childrenPlacementType:2,maximumColumnsInMatrix:6,horizontalAlignment:0};return{process:function(){return!1},getOptions:function(){return a}}};primitives.famdiagram.CombinedTemplateParamsTask=function(a,b){return{process:function(){return!0},getTemplateParams:function(c){return a.getTemplateParams(c)||b.getTemplateParams(c)}}};
primitives.famdiagram.LabelAnnotationTemplateParamsTask=function(a,b,c){var d={};return{process:function(){var e=a.getOptions(),f=b.getAnnotations(),g,h;d={};g=0;for(h=f.length;g<h;g+=1){var i=f[g],j=new primitives.orgdiagram.TemplateParams,k=c.getTemplate(i.templateName,e.defaultLabelAnnotationTemplate,c.DefaultWidgetLabelAnnotationTemplateName);j.template=k;d[i.id]=j}return!0},getTemplateParams:function(a){return d[a]}}};
primitives.famdiagram.CursorNeighboursTask=function(a,b,c,d,e){function f(a,b,c,d,f){var e;if(null!==a)switch(b){case 0:c.loopParents(this,a,function(a){var b=d.node(a);e=f.node(a);null!=e&&0===e.visibility&&(e.visibility=1);if(b.isActive)return c.SKIP});c.loopChildren(this,a,function(a){var b=d.node(a);e=f.node(a);null!=e&&0===e.visibility&&(e.visibility=1);if(b.isActive)return c.SKIP});break;case 1:c.loopNeighbours(this,a,function(a){var b=d.node(a);e=f.node(a);null!=e&&0===e.visibility&&(e.visibility=
1);if(b.isActive)return!0})}return[]}var g=[];return{process:function(){var h=a.getCursorTreeItem(),i=c.getNavigationFamily(),j=d.getOrgTree(),k=e.getVisualTree(),l=b.getNeighboursSelectionMode();g=f(h,l,i,j,k);return!0},getItems:function(){return g}}};
primitives.famdiagram.AddLabelAnnotationsTask=function(a,b){function c(a,b){var c=primitives.common.graph(),d={},e,k,l,n;if(0<b.length){n=0;for(e=b.length;n<e;n+=1)k=b[n],d.hasOwnProperty(k.fromItem)?d[k.fromItem].push(k):(d[k.fromItem]=[k],a.loopChildren(this,k.fromItem,function(b){c.addEdge(k.fromItem,b,new primitives.famdiagram.EdgeItem(k.fromItem,k.fromItem,b,b));return a.SKIP}),a.loopParents(this,k.fromItem,function(b){c.addEdge(b,k.fromItem,new primitives.famdiagram.EdgeItem(b,b,k.fromItem,
k.fromItem));return a.SKIP}));for(l in d)if(d.hasOwnProperty(l)){e=d[l];e.sort(function(a,b){return b.toItems.length-a.toItems.length});for(n=0;n<e.length;n+=1){k=e[n];for(var m=a,t=c,q=k.fromItem,p=k.toItems,r=void 0,s=!0,u=null,v=void 0,y=void 0,A=void 0,w=void 0,B=[],y=0,A=p.length;y<A;y+=1)if(v=p[y],r=t.edge(q,v),null!=r){if(null==u)u=r.getFar(v);else if(u!=r.getFar(v)){s=!1;break}B.push(r.getNear(v))}else{s=!1;break}if(s&&(w=new primitives.famdiagram.FamilyItem({id:k.id,isVisible:!0,isLevelNeutral:!0,
isActive:!1,itemConfig:k}),m.bundleParents(u,B,w.id,w)?(w.levelGravity=2,s=!0):m.bundleChildren(u,B,w.id,w)?(w.levelGravity=1,s=!0):m.bundleParents(u,p,w.id,w)?(w.levelGravity=2,s=!0):m.bundleParents(u,p,w.id,w)&&(w.levelGravity=1,s=!0),s)){y=0;for(A=p.length;y<A;y+=1)v=p[y],r=t.edge(q,v),r.setFar(v,w.id)}}}}}var d=null,e=null;return{process:function(f){var g=b.getLogicalFamily(),h=a.getAnnotations(),g=g.clone();c(g,h);d=g;e=a.getMaximumId();if(f&&!g.validate())throw"References are broken in family structure!";
return!0},getNavigationFamily:function(){return d},getMaximumId:function(){return e}}};
primitives.famdiagram.AddSpousesTask=function(a,b){var c=null,d=null;return{process:function(e){var f=b.getLogicalFamily(),g=b.getMaximumId(),h=a.getItems(),i=f=f.clone(),j,k,l,n,m,t,q,p;l=0;for(n=h.length;l<n;l+=1){m=h[l];p=m.spouses.slice(0);t=0;for(q=p.length;t<q;t+=1)j=[m.id,p[t]],i.hasCommonChild(j)||(g+=1,k=new primitives.famdiagram.FamilyItem({id:g,isVisible:!1,isActive:!0,isLevelNeutral:!0,hideParentConnection:!0,hideChildrenConnection:!0,itemConfig:{title:"fake child #"+g,description:"This is fake child keeps spouses together."}}),
i.add(j,k.id,k))}c=f;d=g;if(e&&!f.validate())throw"References are broken in family structure!";return!0},getLogicalFamily:function(){return c},getMaximumId:function(){return d}}};
primitives.famdiagram.LogicalFamilyTask=function(a){var b=null,c=null;return{process:function(d){var e,f,g,h,i=a.getItems(),j=primitives.common.family(),k=0;if(0<i.length){e=0;for(f=i.length;e<f;e+=1)g=i[e],null!=g&&(h=new primitives.famdiagram.FamilyItem({id:g.id,itemConfig:g,isActive:g.isActive}),j.add(g.parents,h.id,h),g=parseInt(g.id,10),k=Math.max(isNaN(g)?0:g,k))}b=j;c=k;if(d&&!j.validate())throw"References are broken in family structure!";return!0},getLogicalFamily:function(){return b},getMaximumId:function(){return c}}};
primitives.famdiagram.NormalizeLogicalFamilyTask=function(a,b){function c(a,b,c){if(0<a.hasNodes()){a.loopLevels(this,1==j.groupByType,function(a,b,c){b.level=c});a.optimizeReferences(function(){b+=1;return new primitives.famdiagram.FamilyItem({id:b,isVisible:!1,isActive:!1,itemConfig:{title:"bundle #"+b,description:" This item was created by references optimizer."},levelGravity:2})});if(c&&!a.validate())throw"References are broken in family structure!";a.eliminateManyToMany(function(){b+=1;return new primitives.famdiagram.FamilyItem({id:b,
isVisible:!1,isActive:!1,itemConfig:{title:"dummy #"+b,description:"This is item used to eliminate M:M relations."},levelGravity:2})});if(c&&!a.validate())throw"References are broken in family structure!";d(a);c&&g(a,!1);f(a,function(){b+=1;return new primitives.famdiagram.FamilyItem({id:b,levelGravity:2,isVisible:!1,isActive:!1,itemConfig:{title:"extension #"+b,description:"This is item used to fill gaps in levels."}})});c&&g(a,!0)}return b}function d(a){var b=[],c=null,d=null,f,g,j;a.loop(this,
function(a,f){f.originalLevel=f.level;f.level=null;null!=f.originalLevel&&(b[f.originalLevel]||(b[f.originalLevel]={}),b[f.originalLevel][a]=f,c=null!=c?Math.min(f.originalLevel,c):f.originalLevel,d=null!=d?Math.max(f.originalLevel,d):f.originalLevel)});f=0;for(g=c;g<=d;g+=1)j=b[g],f=e(j,a,f,g+1);a.loopTopoReversed(this,function(b,c){var d;2==c.levelGravity&&(d=null,a.loopChildren(this,b,function(b,c,f){if(0<f)return a.BREAK;d=null==d?c.level-1:Math.min(c.level-1,d)}),c.level=!d?c.level:d)})}function e(a,
b,c,d){for(var f=c,e,g,j;!primitives.common.isEmptyObject(a);){e={};for(g in a)a.hasOwnProperty(g)&&(j=a[g],null==j.level&&(j.level=c),b.loopChildren(this,g,function(a,c,g){if(0<g)return b.BREAK;null==c.originalLevel||c.isLevelNeutral?(c.level=null==c.level?j.level+1:Math.max(c.level,j.level+1),e[a]=c):c.originalLevel==d&&(f=Math.max(f,j.level+1))}));a=e}return f}function f(a,b){var c;a.loop(this,function(d,f){for(var e=!0,g;e;)e=!1,g=[],a.loopParents(this,d,function(b,c){f.level-1>c.level&&g.push(b);
return a.SKIP}),1<g.length&&(c=b(f),c.level=f.level-1,a.bundleParents(d,g,c.id,c),e=!0,d=c.id,f=c)});a.loop(this,function(d,f){for(var e=!0,g,j=!0;e;)e=!1,g=[],a.loopChildren(this,d,function(b,c){f.level+1<c.level?g.push(b):j=!1;return a.SKIP}),0<g.length&&(c=b(f),c.level=f.level+1,j&&(c.hideParentConnection=f.hideChildrenConnection,c.hideChildrenConnection=f.hideChildrenConnection),a.bundleChildren(d,g,c.id,c),e=!0,d=c.id,f=c)})}function g(a,b){if(!a.validate())throw"Family structure failed to pass validation!";
a.loop(this,function(c,d){a.loopChildren(this,c,function(c,f,e){if(0<e)return a.BREAK;if(null===f.level||null===d.level||(b?f.level!=d.level+1:f.level<=d.level))throw"Family tree is broken. Children/Parents or levels mismatch!";})})}var h=null,i=null,j;return{process:function(d){var f=b.getLogicalFamily(),e=b.getMaximumId();j=a.getOptions();f=f.clone();e=c(f,e,d);h=f;i=e;if(d&&!f.validate())throw"References are broken in family structure!";return!0},getLogicalFamily:function(){return h},getMaximumId:function(){return i}}};
primitives.famdiagram.OrgTreeTask=function(a,b){function c(a){var b,c,g,k,n,m,y,A,w=[],B,D,z,F,C,x,L,E,G,Q,I,M=[],J;if(0<a.hasNodes()){I={};D=0;J=[];a.loopRoots(this,function(b){var c=z=new primitives.famdiagram.Family(D),d,f=[],e,g,b=a.node(b),f=i(b.id,null,c.id,b.level,b.itemConfig);f.hideParentConnection=!0;f.isVisible=b.isVisible;f.isActive=b.isActive;f.hideParentConnection=b.hideParentConnection;f.hideChildrenConnection=b.hideChildrenConnection;c.items.push(f);I[b.id]=!0;b.familyId=c.id;for(f=
h(b,a,I,c);0<f.length;){e=[];b=0;for(d=f.length;b<d;b+=1)g=f[b],e=e.concat(h(g,a,I,c));f=e}M.push(z);J.push(z);D+=1});J.sort(function(a,b){var c=a.items[0].level,d=b.items[0].level;return c!=d?c-d:b.items.length-a.items.length});w=[];B={};if(0<M.length){n=primitives.common.graph();b=0;for(c=M.length;b<c;b+=1){z=M[b];g=0;for(k=z.links.length;g<k;g+=1)m=z.links[g],A=a.node(m.fromItem).familyId,y=a.node(m.toItem).familyId,A!=y&&(n.addEdge(A,y,{weight:0}),n.edge(A,y).weight+=1),M[y].backLinks.push(new primitives.famdiagram.FamLink(m.toItem,
m.fromItem))}for(;w.length<M.length;){b=0;for(c=J.length;b<c;b+=1)z=J[b],B.hasOwnProperty(z.id)||(G=n.getSpanningTree(z.id,function(a,b){return a.weight-b.weight}),null!=G.node(z.id)?(G.loopPostOrder(this,function(a,b,c){var b=M[a],d=M[c],f=[];null!=c&&(d.familyPriority+=b.familyPriority);f=[];G.loopChildren(this,a,function(a){f.push(a)});f.sort(function(a,b){return M[a].familyPriority-M[b].familyPriority});G.arrangeChildren(a,f)}),G.loopPreOrder(this,function(a){w.push(a);B[a]=!0})):(w.push(z.id),
B[z.id]=!0))}}j.maximumId+=1;A=i(j.maximumId,null,null,l-1,null);A.hideParentConnection=!0;A.hideChildrenConnection=!0;A.title="internal root";A.isVisible=!1;A.isActive=!1;A.childIndex=0;k={};b=0;for(c=w.length;b<c;b+=1){z=M[w[b]];L={};n=A;E=0;y=z.links.concat(z.backLinks);for(g=0;g<y.length;g+=1)m=y[g],C=j.orgTree.node(m.toItem),j.orgTree.node(m.fromItem),!0===k[C.familyId]&&(F=z.items[0],x=C,x.level>=F.level&&j.orgTree.loopParents(this,x.id,function(a,b){x=b;if(b.level<F.level)return!0}),L[x.id]=
L.hasOwnProperty(x.id)?L[x.id]+1:1,E<L[x.id]&&(n=x,E=L[x.id]));g=z;m=void 0;y=g.items[0];C=null;C=n;for(m=n.level+1;m<y.level;m+=1)j.maximumId+=1,C=i(j.maximumId,C.id,null,m,null),C.title="shift",C.isVisible=!1,C.isActive=!1,C.hideParentConnection=!0,C.hideChildrenConnection=!0,g.items.push(C);y.hideParentConnection=!0;j.orgTree.adopt(C.id,y.id,y);k[z.id]=!0}b={};for(Q in j.orgPartners)if(j.orgPartners.hasOwnProperty(Q)){c=j.orgTree.node(Q);A=j.orgPartners[Q];k=0;for(n=A.length;k<n;k+=1)g=j.orgTree.node(A[k]),
f(b,g,c)}Q=d();e(j.orgTree,b,Q)}}function d(){var a={};j.orgTree.loopPostOrder(this,function(b,c,d){l=null!=l?Math.min(l,c.level):c.level;n=null!=n?Math.max(n,c.level):c.level;if(null!=d&&(a[d]||(a[d]={}),c=c.level-1,a[d][c]=a[d][c]?a[d][c]+1:1,null!=a[b]))for(c in a[b])a[b].hasOwnProperty(c)&&(a[d][c]=a[d][c]?a[d][c]+a[b][c]:a[b][c])});return a}function e(a,b,c){var d,f,e,g,j,k,i,h,l,n,m;a.loopLevels(this,function(C,x){var L=primitives.common.graph(),E={},G=null,Q;i=[];a.loopChildren(this,x.id,function(c,
e,g){var i;null==G&&(G=e);E[e.id]={};if(b.hasOwnProperty(e.id))for(i in k=b[e.id],k)if(k.hasOwnProperty(i)){n=k[i];E[e.id][i]={};d=0;for(f=n.length;d<f;d+=1)j=n[d],Q=j.commonParent==x.id?j.toParent:a.node(j.fromParent).childIndex<a.node(j.toParent).childIndex?"__right__":"__left__",e.id!=Q&&(L.addEdge(e.id,Q,{weight:0}),L.edge(e.id,Q).weight+=1,null==E[e.id][i][Q]&&(E[e.id][i][Q]=0),E[e.id][i][Q]+=1)}0<g&&L.addEdge(e.id,G.id,{weight:0})});if(null!=G){m=L.getGrowthSequence(function(a){return a.weight});
0===m.length&&(m=[G.id]);var I=m,M=[],J,P,K,R,W,aa,V,N,T,O,S,H,X,da,ga,U,ba,ea,$,Z;P=new primitives.famdiagram.Slots;P.add(new primitives.famdiagram.Slot("__left__"));P.add(new primitives.famdiagram.Slot(null));P.add(new primitives.famdiagram.Slot("__right__"));K=0;P.loop(function(a){K+=1;a.position=K});for(J=0;J<I.length;J+=1)if(R=I[J],"__left__"!=R&&"__right__"!=R)for(ba in T=N=V=aa=W=null,P.loop(function(a){var b,d,f,e;if(null==a.itemId){da=c[R];X=H=S=O=0;for(b in a.crossings)a.crossings.hasOwnProperty(b)&&
(da&&null!=da[b]&&(O+=a.crossings[b]*da[b]),X+=a.crossings[b]);for(b in E[R])if(E[R].hasOwnProperty(b))for(d in f=E[R][b],f)f.hasOwnProperty(d)&&(e=P.getSlot(d),null!=e&&(e.position<a.position?(O+=(a.left[b]||0)-(e.left[b]||0),H+=Math.abs(e.balance+1)):(O+=(a.right[b]||0)-(e.right[b]||0),H+=Math.abs(e.balance-1)),S+=Math.abs(e.position-a.position)));if(null==aa||aa>O||aa==O&&(V>S||V==S&&(N>H||N==H&&T>X)))aa=O,W=a,V=S,N=H,T=X}}),ga=W.clone(),U=W.clone(),U.itemId=R,P.insertBefore(W,ga),P.insertBefore(W,
U),K=U.position=0,P.loop(function(a){var b,d;if(a.id!=U.id){d=c[R];for(b in d)d.hasOwnProperty(b)&&(a.left[b]=a.left[b]?a.left[b]+d[b]:d[b]);K+=1;a.position=K}},U),K=0,P.backwardLoop(function(a){var b,d;if(a.id!=U.id){d=c[R];for(b in c[R])c[R].hasOwnProperty(b)&&(a.right[b]=a.right[b]?a.right[b]+d[b]:d[b]);K-=1;a.position=K}},U),E[R])if(E[R].hasOwnProperty(ba))for($ in ea=E[R][ba],ea)ea.hasOwnProperty($)&&(Z=P.getSlot($),null!=Z&&(0>Z.position?(Z.balance+=1,U.balance-=1,P.backwardLoop(function(a){if(a.id!=
U.id)if(a.id!=Z.id)a.crossings[ba]=a.crossings[ba]?a.crossings[ba]+ea[$]:ea[$];else return!0},U)):(Z.balance-=1,U.balance+=1,P.loop(function(a){if(a.id!=U.id)if(a.id!=Z.id)a.crossings[ba]=a.crossings[ba]?a.crossings[ba]+ea[$]:ea[$];else return!0},U))));P.loop(function(a){a=a.itemId;null!=a&&("__left__"!=a&&"__right__"!=a)&&M.push(a)});h=M;e=0;for(g=h.length;e<g;e+=1)l=a.node(h[e]),l.childIndex=e,i.push(l.id)}a.arrangeChildren(x.id,i)})}function f(a,b,c){var d=new primitives.famdiagram.ExtraGravity(b.level),
f=new primitives.famdiagram.ExtraGravity(c.level);j.orgTree.zipUp(this,b.id,c.id,function(b,c,e,j){g(a,b,d);g(a,e,f);if(c==j)return d.commonParent=c,d.fromParent=b,d.toParent=e,f.commonParent=c,f.fromParent=e,f.toParent=b,!0})}function g(a,b,c){a.hasOwnProperty(b)||(a[b]={});null==a[b][c.level]&&(a[b][c.level]=[]);a[b][c.level].push(c)}function h(a,b,c,d){var f=[],e={},g=null,h=null,l;1==b.countChildren(a.id)&&(g=b.firstChild(a.id));null!=k[g]?(h=k[g],null==j.orgPartners[h.id]&&(j.orgPartners[h.id]=
[]),j.orgPartners[h.id].push(a.id),d.links.push(new primitives.famdiagram.FamLink(a.id,g))):(null!=g&&(k[g]=a),b.loopChildren(this,a.id,function(g,j){var k=null;c[j.id]||(1==b.countChildren(g)&&(k=b.firstChild(g)),null!=e[k]?(l=i(j.id,e[k].id,d.id,j.level,j.itemConfig),l.itemType=6):(null!=k&&(e[k]=j),f.push(j),l=i(j.id,a.id,d.id,j.level,j.itemConfig)),l.hideParentConnection=j.hideParentConnection,l.hideChildrenConnection=j.hideChildrenConnection,l.isVisible=j.isVisible,l.isActive=j.isActive,d.items.push(l),
c[j.id]=!0,j.familyId=d.id);return b.SKIP}));return f}function i(a,c,d,f,e){var g=new primitives.orgdiagram.OrgItem({});g.id=a;g.familyId=d;g.level=f;a=0;for(d=m.length;a<d;a+=1)f=m[a],g[f]=null!=e&&void 0!==e[f]?e[f]:b[f];j.orgTree.add(c,g.id,g);return g}var j={orgTree:null,maximumId:null,orgPartners:null},k={},l,n,m="title description image itemTitleColor groupTitle groupTitleColor isActive hasSelectorCheckbox hasButtons templateName showCallout calloutTemplateName label showLabel labelSize labelOrientation labelPlacement minimizedItemShapeType".split(" ");
return{process:function(){var b=a.getLogicalFamily(),b=b.clone();j.orgTree=primitives.common.tree();j.maximumId=a.getMaximumId();j.orgPartners={};k={};n=l=null;c(b);return!0},getOrgTree:function(){return j.orgTree},getMaximumId:function(){return j.maximumId},getOrgPartners:function(a){return j.orgPartners[a]||[]}}};
primitives.famdiagram.RemoveLoopsTask=function(a,b){function c(a,b,c){var d,e,k,l,n,m,t,q,p;d=b.clone();b.loopTopo(this,function(a){d.removeNode(a)});if(d.hasNodes()){l=0;for(n=a.length;l<n;l+=1)if(e=a[l],null!=d.node(e.id)){p=[];d.loopParents(this,e.id,function(a){p.push(a);return d.SKIP});m=0;for(t=p.length;m<t;m+=1)d.removeRelation(p[m],e.id),b.removeRelation(p[m],e.id);c+=1;k=new primitives.famdiagram.FamilyItem({id:c,isVisible:!1,isActive:!0,isLevelNeutral:!0,hideParentConnection:!0,hideChildrenConnection:!0,
itemConfig:{title:"fake parent #"+c,description:"This is fake parent item was created by loops reversal."}});b.add([],k.id,k);b.adopt([k.id],e.id);m=0;for(t=p.length;m<t;m+=1)c+=1,e=new primitives.famdiagram.FamilyItem({id:c,isVisible:!1,isActive:!0,isLevelNeutral:!0,hideParentConnection:!0,hideChildrenConnection:!0,itemConfig:{title:"fake child #"+c,description:"This is fake child item was created by loops reversal."}}),b.add([k.id,p[m]],e.id,e);q=[];d.loopTopo(this,function(a){q.push(a)});m=0;for(t=
q.length;m<t;m+=1)d.removeNode(q[m])}}return c}var d=null,e=null;return{process:function(f){var g=b.getNavigationFamily(),h=b.getMaximumId(),i=a.getItems(),g=g.clone(),h=c(i,g,h,f);d=g;e=h;if(f&&!g.validate())throw"References are broken in family structure!";return!0},getLogicalFamily:function(){return d},getMaximumId:function(){return e}}};
primitives.common.LabelAnnotationTemplate=function(){var a,b=jQuery('<div class="bp-label-annotation"></div>');b.addClass("bp-item");a=b.wrap("<div>").parent().html();var c=primitives.common.hashCode(a);return{template:function(){return a},getHashCode:function(){return c},render:function(a,b){b.element.text(b.context.title)}}};
primitives.famdiagram.Control=function(a,b){return primitives.orgdiagram.BaseControl(a,b,function(a,b,e){var f=new primitives.common.TaskManager;f.addDependency("options",a);f.addDependency("graphics",b);f.addDependency("layout",e);f.addDependency("defaultConfig",new primitives.famdiagram.Config);f.addDependency("defaultItemConfig",new primitives.famdiagram.ItemConfig);f.addDependency("defaultTemplateConfig",new primitives.famdiagram.TemplateConfig);f.addDependency("defaultButtonConfig",new primitives.famdiagram.ButtonConfig);
f.addDependency("defaultPaletteItemConfig",new primitives.famdiagram.PaletteItemConfig);f.addDependency("defaultBackgroundAnnotationConfig",new primitives.famdiagram.BackgroundAnnotationConfig);f.addDependency("defaultConnectorAnnotationConfig",new primitives.famdiagram.ConnectorAnnotationConfig);f.addDependency("defaultHighlightPathAnnotationConfig",new primitives.famdiagram.HighlightPathAnnotationConfig);f.addDependency("defaultShapeAnnotationConfig",new primitives.famdiagram.ShapeAnnotationConfig);
f.addDependency("defaultLabelAnnotationConfig",new primitives.famdiagram.LabelAnnotationConfig);f.addDependency("isFamilyChartMode",!0);f.addDependency("showElbowDots",!0);f.addDependency("null",null);f.addTask("OptionsTask",["options"],primitives.orgdiagram.OptionsTask,"#000000");f.addTask("CurrentControlSizeTask",["layout","OptionsTask","ItemsSizesOptionTask"],primitives.orgdiagram.CurrentControlSizeTask,"#000000");f.addTask("CurrentScrollPositionTask",["layout","OptionsTask"],primitives.orgdiagram.CurrentScrollPositionTask,
"#000000");f.addTask("CalloutOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],primitives.orgdiagram.CalloutOptionTask,"#000080");f.addTask("ConnectorsOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.ConnectorsOptionTask,"#000080");f.addTask("ItemsOptionTask",["OptionsTask","defaultItemConfig"],primitives.famdiagram.ItemsOptionTask,"#000080");f.addTask("SpousesOptionTask",["OptionsTask","defaultItemConfig"],primitives.famdiagram.SpousesOptionTask,"#000080");f.addTask("ItemsSizesOptionTask",
["OptionsTask","defaultConfig","defaultItemConfig","defaultButtonConfig"],primitives.orgdiagram.ItemsSizesOptionTask,"#000080");f.addTask("LabelsOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],primitives.orgdiagram.LabelsOptionTask,"#000080");f.addTask("PrintPreviewOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.PrintPreviewOptionTask,"#000080");f.addTask("TemplatesOptionTask",["OptionsTask","defaultConfig","defaultButtonConfig","defaultTemplateConfig"],primitives.orgdiagram.TemplatesOptionTask,
"#000080");f.addTask("OrientationOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.OrientationOptionTask,"#000080");f.addTask("VisualTreeOptionTask",["OptionsTask"],primitives.famdiagram.VisualTreeOptionTask,"#000080");f.addTask("MinimizedItemsOptionTask",["OptionsTask"],primitives.orgdiagram.MinimizedItemsOptionTask,"#000080");f.addTask("NormalizeOptionTask",["OptionsTask","defaultConfig"],primitives.famdiagram.NormalizeOptionTask,"#000080");f.addTask("LinePaletteOptionTask",["OptionsTask",
"defaultPaletteItemConfig"],primitives.famdiagram.LinePaletteOptionTask,"#000080");f.addTask("CursorItemOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.CursorItemOptionTask,"#000080");f.addTask("HighlightItemOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.HighlightItemOptionTask,"#000080");f.addTask("SelectedItemsOptionTask",["OptionsTask"],primitives.orgdiagram.SelectedItemsOptionTask,"#000080");f.addTask("CursorSelectionPathModeOptionTask",["OptionsTask","defaultConfig"],
primitives.orgdiagram.CursorSelectionPathModeOptionTask,"#000080");f.addTask("NeighboursSelectionModeOptionTask",["OptionsTask","defaultConfig"],primitives.famdiagram.NeighboursSelectionModeOptionTask,"#000080");f.addTask("SplitAnnotationsOptionTask",["OptionsTask"],primitives.orgdiagram.SplitAnnotationsOptionTask,"#00ffff");f.addTask("ShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig"],primitives.orgdiagram.ShapeAnnotationOptionTask,"#000080");f.addTask("HighlightPathAnnotationOptionTask",
["SplitAnnotationsOptionTask","defaultConfig","defaultHighlightPathAnnotationConfig"],primitives.orgdiagram.HighlightPathAnnotationOptionTask,"#000080");f.addTask("ConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig"],primitives.orgdiagram.ConnectorAnnotationOptionTask,"#000080");f.addTask("BackgroundAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultBackgroundAnnotationConfig"],primitives.orgdiagram.BackgroundAnnotationOptionTask,"#000080");f.addTask("ScaleOptionTask",
["OptionsTask","defaultConfig"],primitives.orgdiagram.ScaleOptionTask,"#000080");f.addTask("IntervalsTask",["ItemsSizesOptionTask"],primitives.orgdiagram.IntervalsTask,"#00ffff");f.addTask("LogicalFamilyTask",["ItemsOptionTask"],primitives.famdiagram.LogicalFamilyTask,"#00ffff");f.addTask("LabelAnnotationOptionTask",["SplitAnnotationsOptionTask","LogicalFamilyTask","defaultLabelAnnotationConfig"],primitives.famdiagram.LabelAnnotationOptionTask,"#000080");f.addTask("LabelAnnotationTemplateOptionTask",
["LabelAnnotationOptionTask","defaultLabelAnnotationConfig"],primitives.famdiagram.LabelAnnotationTemplateOptionTask,"#000080");f.addTask("LabelAnnotationPlacementOptionTask",["LabelAnnotationOptionTask","defaultLabelAnnotationConfig"],primitives.famdiagram.LabelAnnotationPlacementOptionTask,"#000080");f.addTask("CombinedContextsTask",["ItemsOptionTask","LabelAnnotationOptionTask"],primitives.orgdiagram.CombinedContextsTask,"#00ffff");f.addTask("AddLabelAnnotationsTask",["LabelAnnotationPlacementOptionTask",
"LogicalFamilyTask"],primitives.famdiagram.AddLabelAnnotationsTask,"#ff0000");f.addTask("RemoveLoopsTask",["ItemsOptionTask","AddLabelAnnotationsTask"],primitives.famdiagram.RemoveLoopsTask,"#ff0000");f.addTask("AddSpousesTask",["SpousesOptionTask","RemoveLoopsTask"],primitives.famdiagram.AddSpousesTask,"#ff0000");f.addTask("NormalizeLogicalFamilyTask",["NormalizeOptionTask","AddSpousesTask"],primitives.famdiagram.NormalizeLogicalFamilyTask,"#ff0000");f.addTask("OrgTreeTask",["NormalizeLogicalFamilyTask",
"defaultItemConfig"],primitives.famdiagram.OrgTreeTask,"#ff0000");f.addTask("ReadTemplatesTask",["TemplatesOptionTask"],primitives.orgdiagram.ReadTemplatesTask,"#00ffff");f.addTask("ItemTemplateParamsTask",["ItemsSizesOptionTask","CursorItemOptionTask","ReadTemplatesTask"],primitives.orgdiagram.ItemTemplateParamsTask,"#00ffff");f.addTask("LabelAnnotationTemplateParamsTask",["ItemsSizesOptionTask","LabelAnnotationTemplateOptionTask","ReadTemplatesTask"],primitives.famdiagram.LabelAnnotationTemplateParamsTask,
"#00ffff");f.addTask("CombinedTemplateParamsTask",["ItemTemplateParamsTask","LabelAnnotationTemplateParamsTask"],primitives.famdiagram.CombinedTemplateParamsTask,"#00ffff");f.addTask("GroupTitleTemplateTask",["TemplatesOptionTask"],primitives.orgdiagram.GroupTitleTemplateTask,"#00ffff");f.addTask("CheckBoxTemplateTask",["ItemsSizesOptionTask"],primitives.orgdiagram.CheckBoxTemplateTask,"#00ffff");f.addTask("ButtonsTemplateTask",["ItemsSizesOptionTask"],primitives.orgdiagram.ButtonsTemplateTask,"#00ffff");
f.addTask("VisualTreeTask",["OrgTreeTask","CombinedTemplateParamsTask","VisualTreeOptionTask","isFamilyChartMode"],primitives.orgdiagram.VisualTreeTask,"#ff0000");f.addTask("VisualTreeLevelsTask",["VisualTreeTask","CombinedTemplateParamsTask"],primitives.orgdiagram.VisualTreeLevelsTask,"#ff0000");f.addTask("VisualTreeMarginsTask",["VisualTreeTask"],primitives.orgdiagram.VisualTreeMarginsTask,"#ff0000");f.addTask("ConnectionsGraphTask",["VisualTreeTask","VisualTreeLevelsTask","OrgTreeTask"],primitives.orgdiagram.ConnectionsGraphTask,
"#00ffff");f.addTask("TracePathAnnotationsTask",["HighlightPathAnnotationOptionTask","ConnectionsGraphTask","OrgTreeTask","VisualTreeTask","AddLabelAnnotationsTask"],primitives.orgdiagram.TracePathAnnotationsTask,"#00ffff");f.addTask("HighlightItemTask",["HighlightItemOptionTask","OrgTreeTask"],primitives.orgdiagram.HighlightItemTask,"#00ffff");f.addTask("CursorItemTask",["CursorItemOptionTask","OrgTreeTask"],primitives.orgdiagram.CursorItemTask,"#00ffff");f.addTask("CursorNeighboursTask",["CursorItemTask",
"NeighboursSelectionModeOptionTask","AddLabelAnnotationsTask","OrgTreeTask","VisualTreeTask"],primitives.famdiagram.CursorNeighboursTask,"#00ffff");f.addTask("SelectedItemsTask",["SelectedItemsOptionTask"],primitives.orgdiagram.SelectedItemsTask,"#00ffff");f.addTask("SelectionPathItemsTask",["AddLabelAnnotationsTask","CursorItemTask","SelectedItemsTask","CursorSelectionPathModeOptionTask"],primitives.orgdiagram.SelectionPathItemsTask,"#00ffff");f.addTask("NormalVisibilityItemsByShapeAnnotationTask",
["ShapeAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");f.addTask("NormalVisibilityItemsByBackgroundAnnotationTask",["BackgroundAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");f.addTask("NormalVisibilityItemsByHighlightPathAnnotationTask",["HighlightPathAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");f.addTask("NormalVisibilityItemsByConnectorAnnotationTask",["ConnectorAnnotationOptionTask"],
primitives.orgdiagram.NormalVisibilityItemsByConnectorAnnotationTask,"#00ffff");f.addTask("CombinedNormalVisibilityItemsTask","ItemsSizesOptionTask CursorItemTask CursorNeighboursTask SelectedItemsTask SelectionPathItemsTask NormalVisibilityItemsByShapeAnnotationTask NormalVisibilityItemsByBackgroundAnnotationTask NormalVisibilityItemsByHighlightPathAnnotationTask NormalVisibilityItemsByConnectorAnnotationTask".split(" "),primitives.orgdiagram.CombinedNormalVisibilityItemsTask,"#00ffff");f.addTask("ItemsPositionsTask",
"CurrentControlSizeTask ScaleOptionTask OrientationOptionTask ItemsSizesOptionTask ConnectorsOptionTask VisualTreeOptionTask OrgTreeTask IntervalsTask VisualTreeTask VisualTreeLevelsTask VisualTreeMarginsTask CombinedTemplateParamsTask CursorItemTask CombinedNormalVisibilityItemsTask".split(" "),primitives.orgdiagram.ItemsPositionsTask,"#ff0000");f.addTask("AlignDiagramTask","OrientationOptionTask ItemsSizesOptionTask VisualTreeOptionTask ScaleOptionTask PrintPreviewOptionTask CurrentControlSizeTask VisualTreeTask VisualTreeLevelsTask ItemsPositionsTask isFamilyChartMode".split(" "),
primitives.orgdiagram.AlignDiagramTask,"#ff0000");f.addTask("CreateTransformTask",["OrientationOptionTask","AlignDiagramTask"],primitives.orgdiagram.CreateTransformTask,"#00ffff");f.addTask("CenterOnCursorTask","layout CurrentControlSizeTask CurrentScrollPositionTask CursorItemTask AlignDiagramTask CreateTransformTask ScaleOptionTask".split(" "),primitives.orgdiagram.CenterOnCursorTask,"#00ffff");f.addTask("BackgroundAnnotationManagerTask",["ItemsSizesOptionTask","OrgTreeTask","VisualTreeLevelsTask",
"AlignDiagramTask"],primitives.orgdiagram.BackgroundAnnotationManagerTask,"#00ffff");f.addTask("PaletteManagerTask",["ConnectorsOptionTask","LinePaletteOptionTask"],primitives.orgdiagram.PaletteManagerTask,"#00ffff");f.addTask("ApplyLayoutChangesTask","graphics layout ItemsSizesOptionTask PrintPreviewOptionTask CurrentControlSizeTask ScaleOptionTask AlignDiagramTask".split(" "),primitives.orgdiagram.ApplyLayoutChangesTask,"#00ffff");f.addTask("DrawBackgroundAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask BackgroundAnnotationOptionTask AddLabelAnnotationsTask AlignDiagramTask BackgroundAnnotationManagerTask".split(" "),
primitives.orgdiagram.DrawBackgroundAnnotationTask,"#008000");f.addTask("DrawConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ConnectorAnnotationOptionTask AlignDiagramTask".split(" "),primitives.orgdiagram.DrawConnectorAnnotationTask,"#008000");f.addTask("DrawShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ShapeAnnotationOptionTask AlignDiagramTask".split(" "),primitives.orgdiagram.DrawShapeAnnotationTask,
"#008000");f.addTask("DrawCursorTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask CombinedTemplateParamsTask CursorItemTask SelectedItemsTask".split(" "),primitives.orgdiagram.DrawCursorTask,"#008000");f.addTask("DrawHighlightTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask CombinedTemplateParamsTask HighlightItemTask CursorItemTask SelectedItemsTask".split(" "),primitives.orgdiagram.DrawHighlightTask,"#008000");
f.addTask("DrawHighlightAnnotationTask","layout graphics CreateTransformTask ApplyLayoutChangesTask ScaleOptionTask CombinedContextsTask CalloutOptionTask ReadTemplatesTask AlignDiagramTask CenterOnCursorTask HighlightItemTask CursorItemTask SelectedItemsTask".split(" "),primitives.orgdiagram.DrawHighlightAnnotationTask,"#008000");f.addTask("DrawTreeItemsTask","graphics CreateTransformTask ApplyLayoutChangesTask ItemsSizesOptionTask CombinedContextsTask VisualTreeTask AlignDiagramTask CombinedTemplateParamsTask CursorItemTask SelectedItemsTask GroupTitleTemplateTask CheckBoxTemplateTask ButtonsTemplateTask".split(" "),
primitives.orgdiagram.DrawTreeItemsTask,"#008000");f.addTask("DrawMinimizedItemsTask","graphics CreateTransformTask ApplyLayoutChangesTask MinimizedItemsOptionTask VisualTreeTask CombinedTemplateParamsTask AlignDiagramTask".split(" "),primitives.orgdiagram.DrawMinimizedItemsTask,"#008000");f.addTask("DrawConnectorsTask","graphics CreateTransformTask ApplyLayoutChangesTask ConnectorsOptionTask VisualTreeTask VisualTreeLevelsTask AlignDiagramTask TracePathAnnotationsTask OrgTreeTask showElbowDots PaletteManagerTask".split(" "),
primitives.orgdiagram.DrawConnectorsTask,"#008000");f.addTask("DrawItemLabelsTask","graphics CreateTransformTask ApplyLayoutChangesTask LabelsOptionTask VisualTreeLevelsTask AlignDiagramTask".split(" "),primitives.orgdiagram.DrawItemLabelsTask,"#008000");f.addTask("DrawPrintPreviewTask",["graphics","ApplyLayoutChangesTask","PrintPreviewOptionTask","AlignDiagramTask","ScaleOptionTask"],primitives.orgdiagram.DrawPrintPreviewTask,"#008000");return f},function(a,b,e,f){var g=new primitives.famdiagram.EventArgs,
h=a.tasks.getTask("CombinedContextsTask"),i=a.tasks.getTask("AlignDiagramTask"),j=a.tasks.getTask("AddLabelAnnotationsTask"),b=h.getConfig(b),k=h.getConfig(e),l=j.getNavigationFamily();b&&null!=b.id&&(g.oldContext=b);k&&null!=k.id&&(g.context=k,l.loopParents(this,k.id,function(a,b,c){if(0<c)return l.BREAK;g.parentItems.push(h.getConfig(a))}),j=a.layout.mousePanel.offset(),a=a.layout.element.offset(),g.position=(new primitives.common.Rect(i.getItemPosition(e))).translate(j.left,j.top).translate(-a.left,
-a.top));null!=f&&(g.name=f);return g})};
primitives.orgdiagram.TemplateConfig=function(){this.name=null;this.isActive=!0;this.itemSize=new primitives.common.Size(120,100);this.itemBorderWidth=1;this.minimizedItemShapeType=this.itemTemplate=null;this.minimizedItemSize=new primitives.common.Size(4,4);this.minimizedItemCornerRadius=null;this.minimizedItemLineWidth=1;this.minimizedItemBorderColor=null;this.minimizedItemLineType=0;this.minimizedItemFillColor=null;this.minimizedItemOpacity=1;this.highlightPadding=new primitives.common.Thickness(2,
2,2,2);this.highlightBorderWidth=1;this.highlightTemplate=null;this.cursorPadding=new primitives.common.Thickness(3,3,3,3);this.cursorBorderWidth=2;this.buttons=this.cursorTemplate=null};
primitives.orgdiagram.BackgroundAnnotationConfig=function(a){var b;this.annotationType=4;this.items=[];this.includeChildren=!1;this.zOrderType=0;this.lineWidth=2;this.opacity=1;this.fillColor=this.borderColor=null;this.lineType=0;this.selectItems=!1;switch(arguments.length){case 1:if(null!==a)if(a instanceof Array)this.items=a;else if("object"==typeof a)for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])}};
primitives.orgdiagram.ButtonConfig=function(a,b,c){this.name=a;this.icon=b;this.text=!1;this.label=null;this.tooltip=c;this.size=new primitives.common.Size(16,16)};
primitives.orgdiagram.Config=function(a){this.name=void 0!==a?a:"OrgDiagram";this.classPrefix="orgdiagram";this.graphicsType=this.navigationMode=0;this.actualGraphicsType=null;this.pageFitMode=3;this.minimalVisibility=2;this.horizontalAlignment=this.orientationType=0;this.verticalAlignment=1;this.connectorType=this.arrowsDirection=0;this.bevelSize=4;this.elbowType=0;this.elbowDotSize=4;this.emptyDiagramMessage="Diagram is empty.";this.items=[];this.annotations=[];this.highligtItem=this.cursorItem=
null;this.selectedItems=[];this.hasSelectorCheckbox=0;this.selectCheckBoxLabel="Selected";this.selectionPathMode=1;this.templates=[];this.defaultTemplateName=null;this.hasButtons=0;this.buttons=[];this.onCursorRender=this.onHighlightRender=this.onItemRender=this.onMouseDblClick=this.onMouseClick=this.onButtonClick=this.onSelectionChanged=this.onSelectionChanging=this.onCursorChanged=this.onCursorChanging=this.onHighlightChanged=this.onHighlightChanging=null;this.dotLevelShift=this.normalLevelShift=
20;this.normalItemsInterval=this.lineLevelShift=10;this.dotItemsInterval=1;this.lineItemsInterval=2;this.cousinsIntervalMultiplier=5;this.itemTitleFirstFontColor="#ffffff";this.itemTitleSecondFontColor="#000080";this.minimizedItemShapeType=6;this.linesColor="#c0c0c0";this.linesWidth=1;this.linesType=0;this.highlightLinesColor="#ff0000";this.highlightLinesWidth=1;this.highlightLinesType=0;this.showCallout=!0;this.defaultCalloutTemplateName=null;this.calloutfillColor="#000000";this.calloutBorderColor=
null;this.calloutCornerRadius=this.calloutOffset=4;this.calloutPointerWidth="10%";this.calloutLineWidth=1;this.calloutOpacity=0.2;this.leavesPlacementType=this.childrenPlacementType=2;this.maximumColumnsInMatrix=6;this.buttonsPanelSize=28;this.checkBoxPanelSize=this.groupTitlePanelSize=24;this.distance=3;this.scale=1;this.minimumScale=0.5;this.maximumScale=2;this.showLabels=0;this.labelSize=new primitives.common.Size(80,24);this.labelOffset=1;this.labelOrientation=0;this.labelPlacement=1;this.labelFontSize=
"10px";this.labelFontFamily="Arial";this.labelColor="#000000";this.labelFontStyle=this.labelFontWeight="normal";this.enablePanning=!0;this.printPreviewPageSize=new primitives.common.Size(612,792);this.autoSizeMinimum=new primitives.common.Size(800,600);this.autoSizeMaximum=new primitives.common.Size(1024,768)};
primitives.orgdiagram.ConnectorAnnotationConfig=function(a,b){var c;this.annotationType=0;this.zOrderType=2;this.toItem=this.fromItem=null;this.connectorShapeType=0;this.labelPlacementType=primitives.common.ConnectorLabelPlacementType.Between;this.offset=new primitives.common.Thickness(0,0,0,0);this.lineWidth=2;this.color="#000000";this.lineType=0;this.selectItems=!0;this.label=null;this.labelSize=new primitives.common.Size(60,30);switch(arguments.length){case 1:for(c in a)a.hasOwnProperty(c)&&(this[c]=
a[c]);break;case 2:this.fromItem=a,this.toItem=b}};primitives.orgdiagram.HighlightPathAnnotationConfig=function(a){var b;this.annotationType=2;this.items=[];this.selectItems=!1;switch(arguments.length){case 1:if(null!==a)if(a instanceof Array)this.items=a;else if("object"==typeof a)for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])}};
primitives.orgdiagram.ItemConfig=function(a,b,c,d,e){var f;this.context=this.image=this.description=this.title=this.parent=this.id=null;this.itemTitleColor="#4169e1";this.groupTitle=this.minimizedItemShapeType=null;this.groupTitleColor="#4169e1";this.isActive=this.isVisible=!0;this.rightAdvisersPlacementType=this.leftAdvisersPlacementType=this.directorsPlacementType=this.childrenPlacementType=this.adviserPlacementType=this.itemType=this.hasButtons=this.hasSelectorCheckbox=0;this.templateName=this.groupName=
null;this.showCallout=0;this.label=this.calloutTemplateName=null;this.showLabel=0;this.labelSize=null;this.labelOrientation=3;this.labelPlacement=0;switch(arguments.length){case 1:for(f in a)a.hasOwnProperty(f)&&(this[f]=a[f]);break;case 5:this.id=a,this.parent=b,this.title=c,this.description=d,this.image=e}};
primitives.orgdiagram.ShapeAnnotationConfig=function(a){var b;this.annotationType=1;this.zOrderType=0;this.items=[];this.shapeType=0;this.offset=new primitives.common.Thickness(0,0,0,0);this.lineWidth=2;this.cornerRadius="10%";this.opacity=1;this.fillColor=this.borderColor=null;this.lineType=0;this.selectItems=!1;this.label=null;this.labelSize=new primitives.common.Size(60,30);this.labelPlacement=0;this.labelOffset=4;switch(arguments.length){case 1:if(null!==a)if(a instanceof Array)this.items=a;else if("object"==
typeof a)for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])}};primitives.orgdiagram.EventArgs=function(){this.name=this.position=this.parentItem=this.context=this.oldContext=null;this.cancel=!1};primitives.orgdiagram.ConnectorPoint=function(){this.parent=primitives.common.Point.prototype;this.parent.constructor.apply(this,arguments);this.hasElbow=!1;this.visibility=this.elbowPoint2=this.elbowPoint1=null;this.isSquared=!0;this.highlightPath=0;this.connectorStyleType=1};
primitives.orgdiagram.ConnectorPoint.prototype=new primitives.common.Point;
primitives.orgdiagram.Template=function(a,b){this.templateConfig=b;this.minimizedItemCornerRadius=null===b.minimizedItemCornerRadius?b.minimizedItemSize.width/2:b.minimizedItemCornerRadius;this.itemTemplate=primitives.common.isNullOrEmpty(b.itemTemplate)?new primitives.common.ItemTemplate(a,b):new primitives.common.UserTemplate(a,b.itemTemplate,a.onItemRender);this.highlightTemplate=primitives.common.isNullOrEmpty(b.highlightTemplate)?new primitives.common.HighlightTemplate(a,b):new primitives.common.UserTemplate(a,
b.highlightTemplate,a.onHighlightRender);this.dotHighlightTemplate=new primitives.common.DotHighlightTemplate(a,b);this.cursorTemplate=primitives.common.isNullOrEmpty(b.cursorTemplate)?new primitives.common.CursorTemplate(a,b):new primitives.common.UserTemplate(a,b.cursorTemplate,a.onCursorRender)};primitives.orgdiagram.LevelVisibility=function(a,b){this.level=a;this.currentvisibility=b};
primitives.orgdiagram.OrgItem=function(a){var b,c,d;this.id=null;this.isActive=this.isVisible=!0;this.hasVisibleChildren=!1;this.childrenPlacementType=this.adviserPlacementType=this.itemType=0;this.level=null;this.hideChildrenConnection=this.hideParentConnection=!1;this.childIndex=null;var e="id parent isVisible isActive itemType adviserPlacementType childrenPlacementType".split(" ");b=0;for(c=e.length;b<c;b+=1)d=e[b],a.hasOwnProperty(d)&&(this[d]=a[d])};
primitives.orgdiagram.Template=function(a,b){this.cursorTemplate=this.dotHighlightTemplate=this.highlightTemplate=this.itemTemplate=this.templateConfig=null;null!=b&&(this.templateConfig=b,this.itemTemplate=primitives.common.isNullOrEmpty(b.itemTemplate)?new primitives.common.ItemTemplate(a,b):new primitives.common.UserTemplate(a,b.itemTemplate,a.onItemRender),this.highlightTemplate=primitives.common.isNullOrEmpty(b.highlightTemplate)?new primitives.common.HighlightTemplate(a,b):new primitives.common.UserTemplate(a,
b.highlightTemplate,a.onHighlightRender),this.dotHighlightTemplate=new primitives.common.DotHighlightTemplate(a,b),this.cursorTemplate=primitives.common.isNullOrEmpty(b.cursorTemplate)?new primitives.common.CursorTemplate(a,b):new primitives.common.UserTemplate(a,b.cursorTemplate,a.onCursorRender))};primitives.orgdiagram.TemplateParams=function(){this.template=null;this.hasGroupTitle=this.hasButtons=this.hasSelectorCheckbox=this.isActive=!1;this.buttons=[]};
primitives.orgdiagram.TreeItem=function(){this.visualAggregatorId=this.id=null;this.visualDepth=1;this.partners=[];this.visibility=1;this.actualItemType=null;this.relationDegree=this.gravity=this.connectorPlacement=0};primitives.orgdiagram.TreeItemHighlightPath=function(){this.partnerHighlightPath=this.highlightPath=0};
primitives.orgdiagram.TreeItemPosition=function(a){this.partnerConnectorOffset=0;this.levelPosition=this.level=null;this.rightPadding=this.leftPadding=this.offset=0;this.actualVisibility=1;this.contentPosition=this.actualPosition=this.actualSize=null;if(null!=a)for(var b in a)if(a.hasOwnProperty(b))switch(b){case "actualPosition":this.actualPosition=new primitives.common.Rect(a.actualPosition);break;default:this[b]=a[b]}};
primitives.orgdiagram.TreeItemPosition.prototype.setSize=function(a,b,c,d){var e;switch(this.actualVisibility){case 1:e=b.template.templateConfig;this.actualSize=new primitives.common.Size(e.itemSize);this.contentPosition=new primitives.common.Rect(0,0,this.actualSize.width,this.actualSize.height);a&&(this.actualSize.height+=e.cursorPadding.top+e.cursorPadding.bottom,this.actualSize.width+=e.cursorPadding.left+e.cursorPadding.right,this.contentPosition.x=e.cursorPadding.left,this.contentPosition.y=
e.cursorPadding.top);b.hasSelectorCheckbox&&(this.actualSize.height+=c.checkBoxPanelSize);b.hasButtons&&(this.actualSize.width+=c.buttonsPanelSize);b.hasGroupTitle&&(this.actualSize.width+=c.groupTitlePanelSize,this.contentPosition.x+=c.groupTitlePanelSize);break;case 2:e=b.template.templateConfig;this.actualSize=new primitives.common.Size(e.minimizedItemSize);break;case 3:case 4:this.actualSize=new primitives.common.Size}switch(d.orientationType){case 2:case 3:this.actualSize.invert()}};
primitives.orgdiagram.TreeItemPosition.prototype.setPosition=function(a,b){var c=0;switch(this.actualVisibility){case 1:switch(b.verticalAlignment){case 0:c=0;break;case 1:c=(a.depth-this.actualSize.height)/2;break;case 2:c=a.depth-this.actualSize.height}break;case 2:case 3:case 4:c=a.horizontalConnectorsDepth-this.actualSize.height/2}this.actualPosition=new primitives.common.Rect(this.offset,a.shift+c,this.actualSize.width,this.actualSize.height);this.actualPosition.validate()};
primitives.orgdiagram.TreeLevelPosition=function(a){this.actualVisibility=this.currentvisibility=1;this.currentOffset=this.partnerConnectorOffset=this.levelSpace=this.connectorShift=this.topConnectorShift=this.horizontalConnectorsDepth=this.nextLevelShift=this.depth=this.shift=0;this.labels=[];this.labelsRect=null;this.showLabels=!0;this.hasFixedLabels=!1;if(null!=a)for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b])};
primitives.orgdiagram.TreeLevelPosition.prototype.setShift=function(a,b,c,d){this.shift=a;this.levelSpace=b;this.topConnectorShift=-b/2-c;this.connectorShift=this.depth+d+(this.partnerConnectorOffset+1)*(b/2);return this.nextLevelShift=c+this.depth+d+b+this.partnerConnectorOffset*b/2};primitives.orgdiagram.TreeLevelPosition.prototype.shiftDown=function(a){this.shift+=a};primitives.orgdiagram.TreeLevelPosition.prototype.toString=function(){return this.currentvisibility};
primitives.orgdiagram.AlignDiagramTask=function(a,b,c,d,e,f,g,h,i,j){function k(a,b){var c=new primitives.common.Size(y.printPreviewPageSize),d,f,e;c.scale(1/w.scale);switch(v.orientationType){case 2:case 3:c.invert()}d=0;f=c.width;q.loopMerged(this,function(a){return r[a].actualPosition.x},function(b){var e=new primitives.orgdiagram.TreeItemPosition(r[b]);a[b]=e;e.actualPosition.left()+d<f&&e.actualPosition.right()+d>f&&(d+=f-e.actualPosition.left()-d+u.normalItemsInterval/2);e.actualPosition.translate(d,
0);e.actualPosition.left()>f&&(f+=c.width)});d=0;e=c.height;q.loopLevels(this,function(f){var g=new primitives.orgdiagram.TreeLevelPosition(s[f]);g.shift+d<e&&g.shift+g.depth+d>e&&(d+=e-g.shift-d+u.normalLevelShift/2);g.shiftDown(d);q.loopLevelItems(this,f,function(b){a[b].actualPosition.translate(0,d)});g.shift>e&&(e+=c.height);b.push(g)});return new primitives.common.Size(f+1,e+1)}var l={},n=[],m=null,t,q,p,r,s,u,v,y,A,w;return{process:function(){var B=new primitives.common.Size(i.getContentSize()),
D=new primitives.common.Size(f.getOptimalPanelSize());t=g.getVisualTree();q=h.getTreeLevels();p=h.getActiveTreeLevels();r=i.getItemsPositions();s=i.getTreeLevelsPositions();u=b.getOptions();v=a.getOptions();y=e.getOptions();A=c.getOptions();w=d.getOptions();switch(v.orientationType){case 2:case 3:D.invert()}D.scale(1/w.scale);m=D;l=r;n=s;switch(u.pageFitMode){case 4:l={};n=[];m=k(l,n);break;case 5:m=new primitives.common.Size(B);break;default:m=new primitives.common.Size(B);if(B.width<D.width){l=
{};var z=B.width,F=D.width,C;if(j)C=(F-z)/2;else switch(A.horizontalAlignment){case 1:C=0;break;case 2:C=F-z;break;case 0:C=(F-z)/2}var z=l,x;for(x in r)r.hasOwnProperty(x)&&(F=new primitives.orgdiagram.TreeItemPosition(r[x]),F.actualPosition.translate(C,0),z[x]=F);m.width=D.width}B.height<D.height&&(m.height=D.height)}switch(v.orientationType){case 2:case 3:m.invert()}return!0},getTreeLevelsPositions:function(){return n},getItemPosition:function(a){return l[a]},getItemsPositions:function(){return l},
getContentSize:function(){return m},getTreeItemForMousePosition:function(a,b){var c=null,d=w.scale,a=a/d,b=b/d;p.loopLevels(this,function(d){var f=n[d];if(b>f.shift+f.topConnectorShift&&b<=f.shift+f.connectorShift)return c=t.node(p.binarySearch(this,d,function(c){c=l[c];switch(c.actualVisibility){case 1:if(c.actualPosition.contains(a,b))return 0;case 2:case 3:return a-c.actualPosition.horizontalCenter();case 4:throw"Clickable items collection should contain only visible items.";}})),!0});return c},
getNextLevelTreeItem:function(a,b){var c=l[a].actualPosition.horizontalCenter(),d=a,f=null,e;q.loopLevelsFromItem(this,a,b,function(a){q.loopLevelItems(this,a,function(a){var b=l[a];if(1==b.actualVisibility)if(e=Math.abs(c-b.actualPosition.horizontalCenter()),e<f||null==f)f=e,d=a;else return!0});if(null!=f)return!0});return t.node(d)},getNextTreeItem:function(a,b){var c=a.id,d;q.loopFromItem(this,a,b,function(a){d=r[a];if(1==d.actualVisibility)return c=a,!0});return t.node(c)}}};
primitives.orgdiagram.ApplyLayoutChangesTask=function(a,b,c,d,e,f,g){var h=null,i,j;return{process:function(){var k=b(),l=a(),n=f.getOptions().scale;i=d.getOptions();j=c.getOptions();var m=new primitives.common.Size(g.getContentSize());m.scale(1*n);k.mousePanel.css(m.getCSS());var t=new primitives.common.Size(g.getContentSize());k.placeholder.css(t.getCSS());l.resize("placeholder",t.width,t.height);switch(i.pageFitMode){case 5:h=new primitives.common.Size(m.width+25,m.height+25);h.cropBySize(j.autoSizeMaximum);
h.addSize(j.autoSizeMinimum);k.element.css({width:h.width+"px",height:h.height+"px"});break;case 4:h=new primitives.common.Size(m.width+25,m.height+25);k.element.css({width:h.width+"px",height:h.height+"px"});break;default:h=new primitives.common.Size(e.getScrollPanelSize())}l=k.element.offset();k.scrollPanel.css({top:"0px",left:"0px",width:h.width+"px",height:h.height+"px","margin-bottom":"0px","margin-right":"0px","margin-top":-l.top+Math.floor(l.top)+"px","margin-left":-l.left+Math.floor(l.left)+
"px"});n="scale("+n+","+n+")";k.placeholder.css({"transform-origin":"0 0",transform:n,"-ms-transform":n,"-webkit-transform":n,"-o-transform":n,"-moz-transform":n});return!0},getOptimalPanelSize:function(){return new primitives.common.Size(h.width-25,h.height-25)}}};
primitives.orgdiagram.CenterOnCursorTask=function(a,b,c,d,e,f,g){function h(a){var b=!1;j.transformRect(a.x,a.y,a.width,a.height,!0,this,function(a,c,d,f){b=new primitives.common.Rect(a,c,d,f)});return b}var i=null,j;return{process:function(){var k;k=a();var l=d.getCursorTreeItem(),n=e.getItemPosition(l),l=g.getOptions().scale;i=c.getPlaceholderOffset();k.forceCenterOnCursor&&(j=f.getTransform(),null!=n&&(k=h(n.actualPosition),k.scale(l),l=b.getScrollPanelSize(),i=new primitives.common.Point(Math.max(k.horizontalCenter()-
l.width/2,0),Math.max(k.verticalCenter()-l.height/2,0))));return!0},getPlaceholderOffset:function(){return i}}};
primitives.orgdiagram.CreateTransformTask=function(a,b){var c=null;return{process:function(){var d=a.getOptions(),e=new primitives.common.Size(b.getContentSize());c=new primitives.common.Transform;c.setOrientation(d.orientationType);c.size=new primitives.common.Size(e);return!0},getTransform:function(){return c},getTreeItemForMousePosition:function(a,e){var f=null;c.transformPoint(a,e,!1,this,function(a,c){f=b.getTreeItemForMousePosition(a,c)});return f},description:"Create oordiante system tranfromation object."}};
primitives.orgdiagram.CurrentControlSizeTask=function(a,b,c){var d={scrollPanelSize:null},e={},f=new primitives.common.ObjectReader({scrollPanelSize:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!0),height:new primitives.common.ValueReader(["number"],!0)},!0)});return{process:function(){var b={isChanged:!1,hash:e},h=a(),h={scrollPanelSize:new primitives.common.Size(h.element.outerWidth(),h.element.outerHeight())},i=!1;switch(c.getOptions().pageFitMode){case 1:case 2:case 3:i=
b.isChanged}d=f.read(d,h,"layout",b);return i},getScrollPanelSize:function(){return d.scrollPanelSize},getOptimalPanelSize:function(){return new primitives.common.Size(d.scrollPanelSize.width-25,d.scrollPanelSize.height-25)}}};
primitives.orgdiagram.CurrentScrollPositionTask=function(a){var b={placeholderOffset:null},c={},d=new primitives.common.ObjectReader({placeholderOffset:new primitives.common.ObjectReader({x:new primitives.common.ValueReader(["number"],!0),y:new primitives.common.ValueReader(["number"],!0)},!0)});return{process:function(){var e={isChanged:!1,hash:c},f=a(),f={placeholderOffset:new primitives.common.Point(f.scrollPanel.scrollLeft(),f.scrollPanel.scrollTop())};b=d.read(b,f,"layout",e);return e.isChanged},
getPlaceholderOffset:function(){return b.placeholderOffset}}};
primitives.orgdiagram.BackgroundAnnotationOptionTask=function(a,b){var c=[],d={},e=new primitives.common.ArrayReader(new primitives.common.ObjectReader({items:new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0),includeChildren:new primitives.common.ValueReader(["boolean"],!1,b.includeChildren),zOrderType:new primitives.common.EnumerationReader(primitives.common.ZOrderType,!1,b.zOrderType),lineWidth:new primitives.common.ValueReader(["number"],!1,b.lineWidth),
opacity:new primitives.common.ValueReader(["number"],!1,b.opacity),borderColor:new primitives.common.ValueReader(["string"],!1,b.borderColor),fillColor:new primitives.common.ValueReader(["string"],!1,b.fillColor),lineType:new primitives.common.EnumerationReader(primitives.common.LineType,!1,b.lineType),selectItems:new primitives.common.ValueReader(["boolean"],!1,b.selectItems)}),!1);return{process:function(){var b={isChanged:!1,hash:d};c=e.read(c,a.getAnnotations(4),"annotations",b);return b.isChanged},
getAnnotations:function(){return c}}};
primitives.orgdiagram.ConnectorAnnotationOptionTask=function(a,b){var c=[],d={},e=new primitives.common.ArrayReader(new primitives.common.ObjectReader({zOrderType:new primitives.common.EnumerationReader(primitives.common.ZOrderType,!1,b.zOrderType),fromItem:new primitives.common.ValueReader(["string","number"],!0),toItem:new primitives.common.ValueReader(["string","number"],!0),connectorShapeType:new primitives.common.EnumerationReader(primitives.common.ShapeType,!1,b.connectorShapeType),labelPlacementType:new primitives.common.EnumerationReader(primitives.common.ConnectorLabelPlacementType,
!1,b.labelPlacementType),offset:new primitives.common.ObjectReader({left:new primitives.common.ValueReader(["number"],!1,b.offset.left),top:new primitives.common.ValueReader(["number"],!1,b.offset.top),right:new primitives.common.ValueReader(["number"],!1,b.offset.right),bottom:new primitives.common.ValueReader(["number"],!1,b.offset.bottom)},!1,b.offset),lineWidth:new primitives.common.ValueReader(["number"],!1,b.lineWidth),color:new primitives.common.ValueReader(["string"],!1,b.color),lineType:new primitives.common.EnumerationReader(primitives.common.LineType,
!1,b.lineType),selectItems:new primitives.common.ValueReader(["boolean"],!1,b.selectItems),label:new primitives.common.ValueReader(["string"],!1,b.label),labelSize:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,b.labelSize.width),height:new primitives.common.ValueReader(["number"],!1,b.labelSize.height)},!1,b.labelSize)}),!1);return{process:function(){var b={isChanged:!1,hash:d};c=e.read(c,a.getAnnotations(0),"annotations",b);return b.isChanged},getAnnotations:function(){return c}}};
primitives.orgdiagram.HighlightPathAnnotationOptionTask=function(a,b,c){var d={},e=[],f={},g=new primitives.common.ObjectReader({highlightLinesColor:new primitives.common.ValueReader(["string"],!1,b.highlightLinesColor),highlightLinesWidth:new primitives.common.ValueReader(["number"],!1,b.highlightLinesWidth),highlightLinesType:new primitives.common.EnumerationReader(primitives.common.LineType,!1,b.highlightLinesType)}),h=new primitives.common.ArrayReader(new primitives.common.ObjectReader({items:new primitives.common.ArrayReader(new primitives.common.ValueReader(["string",
"number"],!0),!1),selectItems:new primitives.common.ValueReader(["boolean"],!1,c.selectItems)},!1));return{process:function(){var b={isChanged:!1,hash:f};d=g.read(d,a.getAnnotations(2),"options",b);e=h.read(e,a.getAnnotations(2),"annotations",b);return b.isChanged},getAnnotations:function(){return e},getHighlighPathOptions:function(){return d}}};
primitives.orgdiagram.ShapeAnnotationOptionTask=function(a,b){var c=[],d={},e=new primitives.common.ArrayReader(new primitives.common.ObjectReader({zOrderType:new primitives.common.EnumerationReader(primitives.common.ZOrderType,!1,b.zOrderType),items:new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0),shapeType:new primitives.common.EnumerationReader(primitives.common.ShapeType,!1,b.shapeType),offset:new primitives.common.ObjectReader({left:new primitives.common.ValueReader(["number"],
!1,b.offset.left),top:new primitives.common.ValueReader(["number"],!1,b.offset.top),right:new primitives.common.ValueReader(["number"],!1,b.offset.right),bottom:new primitives.common.ValueReader(["number"],!1,b.offset.bottom)},!1,b.offset),lineWidth:new primitives.common.ValueReader(["number"],!1,b.lineWidth),cornerRadius:new primitives.common.ValueReader(["string"],!1,b.cornerRadius),opacity:new primitives.common.ValueReader(["number"],!1,b.opacity),borderColor:new primitives.common.ValueReader(["string"],
!1,b.borderColor),fillColor:new primitives.common.ValueReader(["string"],!1,b.fillColor),lineType:new primitives.common.EnumerationReader(primitives.common.LineType,!1,b.lineType),selectItems:new primitives.common.ValueReader(["boolean"],!1,b.selectItems),label:new primitives.common.ValueReader(["string"],!1,b.label),labelSize:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,b.labelSize.width),height:new primitives.common.ValueReader(["number"],!1,b.labelSize.height)},
!1,b.labelSize),labelPlacement:new primitives.common.EnumerationReader(primitives.common.PlacementType,!1,b.labelPlacement),labelOffset:new primitives.common.ValueReader(["number"],!1,b.labelOffset)},!1));return{process:function(){var b={isChanged:!1,hash:d};c=e.read(c,a.getAnnotations(1),"annotations",b);return b.isChanged},getAnnotations:function(){return c}}};
primitives.orgdiagram.SplitAnnotationsOptionTask=function(a){var b={};return{process:function(){var c=a.getOptions().annotations,d,e,f,g,h={};if(Array.isArray(c)){d=0;for(e=c.length;d<e;d+=1)f=c[d],g=f.annotationType,null!=g&&(h.hasOwnProperty(g)?h[g].push(f):h[g]=[f])}b=h;return!0},getAnnotations:function(a){return b[a]}}};
primitives.orgdiagram.CursorItemOptionTask=function(a,b){var c={},d=new primitives.common.ObjectReader({cursorItem:new primitives.common.ValueReader(["string","number"],!0),navigationMode:new primitives.common.EnumerationReader(primitives.common.NavigationMode,!1,b.navigationMode)});return{process:function(){var b={isChanged:!1};c=d.read(c,a.getOptions(),"options",b);return b.isChanged},getCursorItem:function(){return c.cursorItem},hasCursorEnabled:function(){switch(c.navigationMode){case 0:case 1:return!0}return!1},
description:"Checks currenct cursor item option."}};primitives.orgdiagram.CursorSelectionPathModeOptionTask=function(a,b){var c={},d=new primitives.common.ObjectReader({selectionPathMode:new primitives.common.EnumerationReader(primitives.common.SelectionPathMode,!1,b.selectionPathMode)});return{process:function(){var b={isChanged:!1};c=d.read(c,a.getOptions(),"options",b);return b.isChanged},getSelectionPathMode:function(){return c.selectionPathMode},description:"Checks cursor selection path option."}};
primitives.orgdiagram.HighlightItemOptionTask=function(a,b){var c={},d=new primitives.common.ObjectReader({highlightItem:new primitives.common.ValueReader(["string","number"],!0),navigationMode:new primitives.common.EnumerationReader(primitives.common.NavigationMode,!1,b.navigationMode)});return{process:function(){var b={isChanged:!1};c=d.read(c,a.getOptions(),"options",b);return b.isChanged},getHighlightItem:function(){return c.highlightItem},hasHighlightEnabled:function(){switch(c.navigationMode){case 0:return!0}return!1},
description:"Checks highlight item option."}};primitives.orgdiagram.SelectedItemsOptionTask=function(a){var b={},c={},d=new primitives.common.ObjectReader({selectedItems:new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0)});return{process:function(){var e={isChanged:!1,hash:c},f=a.getOptions();b=d.read(b,f,"options",e);return e.isChanged},getSelectedItems:function(){return b.selectedItems},description:"Checks user selected items option."}};
primitives.orgdiagram.CalloutOptionTask=function(a,b,c){var d={},e={},f=new primitives.common.ObjectReader({showCallout:new primitives.common.ValueReader(["boolean"],!1,b.showCallout),defaultTemplateName:new primitives.common.ValueReader(["string"],!0),defaultCalloutTemplateName:new primitives.common.ValueReader(["string"],!0),calloutfillColor:new primitives.common.ValueReader(["string"],!1,b.calloutfillColor),calloutBorderColor:new primitives.common.ValueReader(["string"],!0),calloutOffset:new primitives.common.ValueReader(["number"],
!1,b.calloutOffset),calloutCornerRadius:new primitives.common.ValueReader(["number"],!1,b.calloutCornerRadius),calloutPointerWidth:new primitives.common.ValueReader(["string"],!1,b.calloutPointerWidth),calloutLineWidth:new primitives.common.ValueReader(["number"],!1,b.calloutLineWidth),calloutOpacity:new primitives.common.ValueReader(["number"],!1,b.calloutOpacity),items:new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["string","number"],
!0),showCallout:new primitives.common.ValueReader(["boolean"],!1,c.showCallout),calloutTemplateName:new primitives.common.ValueReader(["string"],!0),templateName:new primitives.common.ValueReader(["string"],!0)}),!0,"id")});return{process:function(){var b={isChanged:!1,hash:e};d=f.read(d,a.getOptions(),"options",b);return b.isChanged},getOptions:function(){return d},getItemOptions:function(a){return e["options-items"][a]},description:"Checks item callout options."}};
primitives.orgdiagram.ConnectorsOptionTask=function(a,b){var c={},d={},e=new primitives.common.ObjectReader({arrowsDirection:new primitives.common.EnumerationReader(primitives.common.GroupByType,!1,b.arrowsDirection),connectorType:new primitives.common.EnumerationReader(primitives.common.ConnectorType,!1,b.hasOwnProperty("connectorType")?b.connectorType:0),showNeigboursConnectorsHighlighted:new primitives.common.EnumerationReader(primitives.common.ConnectorType,!1,b.hasOwnProperty("showNeigboursConnectorsHighlighted")?
b.showNeigboursConnectorsHighlighted:!1),elbowType:new primitives.common.EnumerationReader(primitives.common.ElbowType,!1,b.elbowType),bevelSize:new primitives.common.ValueReader(["number"],!1,b.bevelSize),elbowDotSize:new primitives.common.ValueReader(["number"],!1,b.elbowDotSize),linesColor:new primitives.common.ValueReader(["string"],!1,b.linesColor),linesWidth:new primitives.common.ValueReader(["number"],!1,b.linesWidth),linesType:new primitives.common.EnumerationReader(primitives.common.LineType,
!1,b.linesType),highlightLinesColor:new primitives.common.ValueReader(["string"],!1,b.highlightLinesColor),highlightLinesWidth:new primitives.common.ValueReader(["number"],!1,b.highlightLinesWidth),highlightLinesType:new primitives.common.EnumerationReader(primitives.common.LineType,!1,b.highlightLinesType)});return{process:function(){var b={isChanged:!1,hash:d};c=e.read(c,a.getOptions(),"options",b);return b.isChanged},getOptions:function(){return c},description:"Checks connector lines drawing options."}};
primitives.orgdiagram.ItemsOptionTask=function(a,b){var c={},d={},e={},f=new primitives.common.ObjectReader({items:new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["string","number"],!0),parent:new primitives.common.ValueReader(["string","number"],!0),itemType:new primitives.common.EnumerationReader(primitives.orgdiagram.ItemType,!1,b.itemType),adviserPlacementType:new primitives.common.EnumerationReader(primitives.common.AdviserPlacementType,
!1,b.adviserPlacementType),childrenPlacementType:new primitives.common.EnumerationReader(primitives.common.ChildrenPlacementType,!1,b.childrenPlacementType),isVisible:new primitives.common.ValueReader(["boolean"],!1,b.isVisible),isActive:new primitives.common.ValueReader(["boolean"],!1,b.isActive)}),!0,"id",!0)});return{process:function(){var b={isChanged:!1,hash:d,sourceHash:e};c=f.read(c,a.getOptions(),"options",b);return b.isChanged},getItems:function(){return c.items},getConfig:function(a){return e["options-items"][a]},
description:"Checks items configuration options effecting their placement in layout."}};
primitives.orgdiagram.ItemsSizesOptionTask=function(a,b,c,d){var e={},f={},g=new primitives.common.ObjectReader({defaultTemplateName:new primitives.common.ValueReader(["string"],!0),defaultLabelAnnotationTemplate:new primitives.common.ValueReader(["string"],!0),hasSelectorCheckbox:new primitives.common.EnumerationReader(primitives.common.Enabled,!1,b.hasSelectorCheckbox),hasButtons:new primitives.common.EnumerationReader(primitives.common.Enabled,!1,b.hasButtons),buttonsPanelSize:new primitives.common.ValueReader(["number"],
!1,b.buttonsPanelSize),groupTitlePanelSize:new primitives.common.ValueReader(["number"],!1,b.groupTitlePanelSize),checkBoxPanelSize:new primitives.common.ValueReader(["number"],!1,b.checkBoxPanelSize),selectCheckBoxLabel:new primitives.common.ValueReader(["string"],!1,b.selectCheckBoxLabel),buttons:new primitives.common.ArrayReader(new primitives.common.ObjectReader({name:new primitives.common.ValueReader(["string"],!0),icon:new primitives.common.ValueReader(["string"],!0),text:new primitives.common.ValueReader(["boolean"],
!1,!1),tooltip:new primitives.common.ValueReader(["string"],!0),size:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,d.size.width),height:new primitives.common.ValueReader(["number"],!1,d.size.height)},!1,d.size)}),!0,"name"),pageFitMode:new primitives.common.EnumerationReader(primitives.common.PageFitMode,!1,b.pageFitMode),minimalVisibility:new primitives.common.EnumerationReader(primitives.common.Visibility,!1,b.minimalVisibility),selectionPathMode:new primitives.common.EnumerationReader(primitives.common.SelectionPathMode,
!1,b.selectionPathMode),autoSizeMinimum:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,b.autoSizeMinimum.width),height:new primitives.common.ValueReader(["number"],!1,b.autoSizeMinimum.height)},!1,b.autoSizeMinimum),autoSizeMaximum:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,b.autoSizeMaximum.width),height:new primitives.common.ValueReader(["number"],!1,b.autoSizeMaximum.height)},!1,b.autoSizeMaximum),scale:new primitives.common.ValueReader(["number"],
!1,b.scale),maximumScale:new primitives.common.ValueReader(["number"],!1,b.maximumScale),minimumScale:new primitives.common.ValueReader(["number"],!1,b.minimumScale),normalLevelShift:new primitives.common.ValueReader(["number"],!1,b.normalLevelShift),dotLevelShift:new primitives.common.ValueReader(["number"],!1,b.dotLevelShift),lineLevelShift:new primitives.common.ValueReader(["number"],!1,b.lineLevelShift),normalItemsInterval:new primitives.common.ValueReader(["number"],!1,b.normalItemsInterval),
dotItemsInterval:new primitives.common.ValueReader(["number"],!1,b.dotItemsInterval),lineItemsInterval:new primitives.common.ValueReader(["number"],!1,b.lineItemsInterval),cousinsIntervalMultiplier:new primitives.common.ValueReader(["number"],!1,b.cousinsIntervalMultiplier),verticalAlignment:new primitives.common.EnumerationReader(primitives.common.VerticalAlignmentType,!1,b.verticalAlignment),items:new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["string",
"number"],!0),groupTitle:new primitives.common.ValueReader(["string","number"],!0),isVisible:new primitives.common.ValueReader(["boolean","number"],!1,c.isVisible),isActive:new primitives.common.ValueReader(["boolean","number"],!1,c.isActive),hasSelectorCheckbox:new primitives.common.EnumerationReader(primitives.common.Enabled,!1,c.hasSelectorCheckbox),hasButtons:new primitives.common.EnumerationReader(primitives.common.Enabled,!1,c.hasButtons),templateName:new primitives.common.ValueReader(["string"],
!0)}),!0,"id")});return{process:function(){var b={isChanged:!1,hash:f};e=g.read(e,a.getOptions(),"options",b);return b.isChanged},getItemOptions:function(a){return f["options-items"][a]},getOptions:function(){return e},description:"Checks items size options."}};
primitives.orgdiagram.LabelsOptionTask=function(a,b,c){var d={},e={},f=new primitives.common.ObjectReader({showLabels:new primitives.common.EnumerationReader(primitives.common.Enabled,!1,b.showLabels),labelOffset:new primitives.common.ValueReader(["number"],!1,b.labelOffset),labelFontSize:new primitives.common.ValueReader(["string"],!1,b.labelFontSize),labelFontFamily:new primitives.common.ValueReader(["string"],!1,b.labelFontFamily),labelFontStyle:new primitives.common.ValueReader(["string"],!1,
b.labelFontStyle),labelFontWeight:new primitives.common.ValueReader(["string"],!1,b.labelFontWeight),labelColor:new primitives.common.ValueReader(["string"],!1,b.labelColor),labelSize:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,b.labelSize.width),height:new primitives.common.ValueReader(["number"],!1,b.labelSize.height)},!1,b.labelSize),labelOrientation:new primitives.common.EnumerationReader(primitives.text.TextOrientationType,!1,b.labelOrientation),
labelPlacement:new primitives.common.EnumerationReader(primitives.common.PlacementType,!1,b.labelPlacement),arrowsDirection:new primitives.common.EnumerationReader(primitives.common.GroupByType,!1,b.arrowsDirection),items:new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["string","number"],!0),label:new primitives.common.ValueReader(["string","number"],!0),showLabel:new primitives.common.EnumerationReader(primitives.common.Enabled,!1,c.showLabel),
labelSize:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,0),height:new primitives.common.ValueReader(["number"],!1,0)},!0),labelOrientation:new primitives.common.EnumerationReader(primitives.text.TextOrientationType,!1,c.labelOrientation),labelPlacement:new primitives.common.EnumerationReader(primitives.common.PlacementType,!1,c.labelPlacement)}),!0,"id")});return{process:function(){var b={isChanged:!1,hash:e};d=f.read(d,a.getOptions(),"options",b);return b.isChanged},
getItemOptions:function(a){return e["options-items"][a]},getOptions:function(){return d},description:"Checks items labels options."}};
primitives.orgdiagram.MinimizedItemsOptionTask=function(a){var b={},c={},d=new primitives.common.ObjectReader({minimizedItemShapeType:new primitives.common.EnumerationReader(primitives.common.ShapeType,!0),items:new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["string","number"],!0),minimizedItemShapeType:new primitives.common.EnumerationReader(primitives.common.ShapeType,!0),itemTitleColor:new primitives.common.ValueReader(["string"],!0)}),
!0,"id")});return{process:function(){var e={isChanged:!1,hash:c};b=d.read(b,a.getOptions(),"options",e);return e.isChanged},getItemOptions:function(a){return c["options-items"][a]},getOptions:function(){return b},description:"Checks minimized items drawing options."}};primitives.orgdiagram.OptionsTask=function(a){return{process:function(){return!0},getOptions:a,description:"Raw options."}};
primitives.orgdiagram.OrientationOptionTask=function(a,b){var c={},d={},e=new primitives.common.ObjectReader({orientationType:new primitives.common.EnumerationReader(primitives.common.OrientationType,!1,b.orientationType)});return{process:function(){var b={isChanged:!1,hash:d};c=e.read(c,a.getOptions(),"options",b);return b.isChanged},getOptions:function(){return c},description:"Checks diagram orientation options."}};
primitives.orgdiagram.PrintPreviewOptionTask=function(a,b){var c={},d={},e=new primitives.common.ObjectReader({pageFitMode:new primitives.common.EnumerationReader(primitives.common.PageFitMode,!1,b.pageFitMode),printPreviewPageSize:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,b.printPreviewPageSize.width),height:new primitives.common.ValueReader(["number"],!1,b.printPreviewPageSize.height)},!1,b.printPreviewPageSize)});return{process:function(){var b={isChanged:!1,
hash:d};c=e.read(c,a.getOptions(),"options",b);return b.isChanged},getOptions:function(){return c},description:"Checks options of print preview mode."}};
primitives.orgdiagram.ScaleOptionTask=function(a,b){var c={},d={},e=new primitives.common.ObjectReader({scale:new primitives.common.ValueReader(["number"],!1,b.scale),minimumScale:new primitives.common.ValueReader(["number"],!1,b.minimumScale),maximumScale:new primitives.common.ValueReader(["number"],!1,b.maximumScale)});return{process:function(){var b={isChanged:!1,hash:d};c=e.read(c,a.getOptions(),"options",b);return b.isChanged},getOptions:function(){return c},description:"Checks control scale options."}};
primitives.orgdiagram.TemplatesOptionTask=function(a,b,c,d){var e={},f={},g=new primitives.common.ObjectReader({itemTitleFirstFontColor:new primitives.common.ValueReader(["string"],!1,b.itemTitleFirstFontColor),itemTitleSecondFontColor:new primitives.common.ValueReader(["string"],!1,b.itemTitleSecondFontColor),selectCheckBoxLabel:new primitives.common.ValueReader(["string"],!1,b.selectCheckBoxLabel),onItemRender:new primitives.common.FunctionReader,onCursorRender:new primitives.common.FunctionReader,
onHighlightRender:new primitives.common.FunctionReader,templates:new primitives.common.ArrayReader(new primitives.common.ObjectReader({name:new primitives.common.ValueReader(["string"],!0),isActive:new primitives.common.ValueReader(["boolean"],!1,d.isActive),itemSize:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,d.itemSize.width),height:new primitives.common.ValueReader(["number"],!1,d.itemSize.height)},!1,d.itemSize),itemBorderWidth:new primitives.common.ValueReader(["number"],
!1,d.itemBorderWidth),itemTemplate:new primitives.common.ValueReader(["string"],!0),minimizedItemShapeType:new primitives.common.EnumerationReader(primitives.common.ShapeType,!0),minimizedItemSize:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,d.minimizedItemSize.width),height:new primitives.common.ValueReader(["number"],!1,d.minimizedItemSize.height)},!1,d.minimizedItemSize),minimizedItemCornerRadius:new primitives.common.ValueReader(["number"],!0),minimizedItemLineWidth:new primitives.common.ValueReader(["number"],
!1,d.minimizedItemLineWidth),minimizedItemBorderColor:new primitives.common.ValueReader(["string"],!0),minimizedItemLineType:new primitives.common.EnumerationReader(primitives.common.LineType,!1,d.minimizedItemLineType),minimizedItemFillColor:new primitives.common.ValueReader(["string"],!0),minimizedItemOpacity:new primitives.common.ValueReader(["number"],!1,d.minimizedItemOpacity),highlightPadding:new primitives.common.ObjectReader({left:new primitives.common.ValueReader(["number"],!1,d.highlightPadding.left),
top:new primitives.common.ValueReader(["number"],!1,d.highlightPadding.top),right:new primitives.common.ValueReader(["number"],!1,d.highlightPadding.right),bottom:new primitives.common.ValueReader(["number"],!1,d.highlightPadding.bottom)},!1,d.highlightPadding),highlightBorderWidth:new primitives.common.ValueReader(["number"],!1,d.highlightBorderWidth),highlightTemplate:new primitives.common.ValueReader(["string"],!0),cursorPadding:new primitives.common.ObjectReader({left:new primitives.common.ValueReader(["number"],
!1,d.cursorPadding.left),top:new primitives.common.ValueReader(["number"],!1,d.cursorPadding.top),right:new primitives.common.ValueReader(["number"],!1,d.cursorPadding.right),bottom:new primitives.common.ValueReader(["number"],!1,d.cursorPadding.bottom)},!1,d.cursorPadding),cursorBorderWidth:new primitives.common.ValueReader(["number"],!1,d.cursorBorderWidth),cursorTemplate:new primitives.common.ValueReader(["string"],!0),buttons:new primitives.common.ArrayReader(new primitives.common.ObjectReader({name:new primitives.common.ValueReader(["string"],
!0),icon:new primitives.common.ValueReader(["string"],!0),text:new primitives.common.ValueReader(["boolean"],!1,!1),tooltip:new primitives.common.ValueReader(["string"],!0),size:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,c.size.width),height:new primitives.common.ValueReader(["number"],!1,c.size.height)},!1,c.size)}),!0,"name")}),!0,"name")});return{process:function(){var b={isChanged:!1,hash:f};e=g.read(e,a.getOptions(),"options",b);return b.isChanged},
getOptions:function(){return e},description:"Checks items template options."}};
primitives.orgdiagram.VisualTreeOptionTask=function(a,b){var c={},d={},e=new primitives.common.ObjectReader({leavesPlacementType:new primitives.common.EnumerationReader(primitives.common.ChildrenPlacementType,!1,b.leavesPlacementType),childrenPlacementType:new primitives.common.EnumerationReader(primitives.common.ChildrenPlacementType,!1,b.childrenPlacementType),maximumColumnsInMatrix:new primitives.common.ValueReader(["number"],!1,b.maximumColumnsInMatrix),horizontalAlignment:new primitives.common.EnumerationReader(primitives.common.HorizontalAlignmentType,
!1,b.horizontalAlignment)});return{process:function(){var b={isChanged:!1,hash:d};c=e.read(c,a.getOptions(),"options",b);return b.isChanged},getOptions:function(){return c},description:"Checks items layout options."}};
primitives.orgdiagram.DrawBackgroundAnnotationTask=function(a,b,c,d,e,f,g){function h(a,b,c){var d,e,g,h,r,s,u,v,y,A,w;d=0;for(e=a.length;d<e;d+=1)if(w=a[d],null!=w.items&&0<w.items.length){r=new primitives.common.Perimeter(i);r.transform=j;s=new primitives.orgdiagram.BackgroundAnnotationConfig;y=["opacity","lineWidth","borderColor","fillColor","lineType"];g=0;for(h=y.length;g<h;g+=1)A=y[g],r[A]=w.hasOwnProperty(A)?w[A]:s[A];i.activate("placeholder",2);u=[];v={};if(w.includeChildren){g=0;for(h=w.items.length;g<
h;g+=1)s=w.items[g],y=f.getItemPosition(s),null!=y&&(v[s]=!0,u.push(s),c.loopChildren(this,s,function(a){v[a]||(v[a]=!0,u.push(a))}))}else u=w.items;w=b.getMergedPerimeters(u);for(g=0;g<w.length;g+=1)r.draw(w[g])}}var i,j;return{process:function(){var c=d.getAnnotations(),f,n;i=a();i.reset("placeholder",2);0<c.length&&(j=b.getTransform(),f=g.getBackgroundManager(),n=e.getNavigationFamily(),h(c,f,n));return!1}}};
primitives.orgdiagram.DrawConnectorAnnotationTask=function(a,b,c,d,e,f){function g(a,b){var c;c=12;var d,f,e,g,s,u,v,y,A,w,B;d=0;for(f=a.length;d<f;d+=1)if(c=a[d],null!=c.fromItem&&null!=c.toItem&&(s=b(c.fromItem),e=b(c.toItem),null!=s&&null!=e)){s=s.actualPosition;u=e.actualPosition;y=new primitives.orgdiagram.ConnectorAnnotationConfig;v=new primitives.common.Connector(h);v.orientationType=j.orientationType;A="connectorShapeType labelPlacementType offset lineWidth color lineType labelSize zOrderType".split(" ");
e=0;for(g=A.length;e<g;e+=1)w=A[e],v[w]=c.hasOwnProperty(w)?c[w]:y[w];v.labelTemplate=k;v.hasLabel=!primitives.common.isNullOrEmpty(c.label);B=new primitives.common.RenderEventArgs;B.context=c;switch(v.zOrderType){case 1:c=4;break;default:c=12}c=h.activate("placeholder",c);v.panelSize=c.size;i.transformRect(s.x,s.y,s.width,s.height,!0,this,function(a,b,c,d){var f=new primitives.common.Rect(a,b,c,d);i.transformRect(u.x,u.y,u.width,u.height,!0,this,function(a,b,c,d){a=new primitives.common.Rect(a,b,
c,d);v.draw(f,a,B)})})}}var h,i,j,k=new primitives.common.AnnotationLabelTemplate;return{process:function(){h=a();i=b.getTransform();j=d.getOptions();h.reset("placeholder",4);h.reset("placeholder",12);g(e.getAnnotations(),f.getItemPosition);return!1}}};
primitives.orgdiagram.DrawConnectorsTask=function(a,b,c,d,e,f,g,h,i,j,k){function l(a){var b=p.activate("placeholder",5),c;u.hasNodes()&&(c=new primitives.common.PolylinesBuffer,v.loopLevels(this,function(d){var f=y[d];v.loopLevelItems(this,d,function(d){var e=u.node(d);n(b.hasGraphics,c,w,e,A[d],f,a)})}),p.polylinesBuffer(c))}function n(a,b,c,d,f,e,g){var j,k,l,n,p,B,q,w,W,aa,V,N,T,O,S=0,H,X=0==s.connectorType,da,ga;O=0<f.partnerConnectorOffset?e.shift+e.connectorShift-e.levelSpace/2*(e.partnerConnectorOffset-
f.partnerConnectorOffset+1):d.connectorPlacement&4?f.actualPosition.bottom():e.shift+e.connectorShift;1>=f.partnerConnectorOffset?c.selectPalette(0):1<f.partnerConnectorOffset?c.selectPalette(f.partnerConnectorOffset-1):c.selectPalette(e.partnerConnectorOffset);u.hasChildren(d.id)&&(j=4===f.actualVisibility&&null==u.parentid(d.id),T=f.actualPosition.horizontalCenter());l=[];var U=i.getOrgPartners(d.id);if(1<d.partners.length||0<U.length){f=d.partners;0===d.partners.length&&f.push(d.id);for(w=0;w<
f.length;w+=1)n=f[w],u.node(n),B=h.getHighlightPath(n),p=A[n],H=new primitives.orgdiagram.ConnectorPoint(p.actualPosition.horizontalCenter(),p.actualPosition.bottom()),H.isSquared=!0,H.highlightPath=B.partnerHighlightPath,H.connectorStyleType=B.partnerHighlightPath?2:1,H.visibility=p.actualVisibility,l.push(H);f=U;for(w=0;w<f.length;w+=1)n=f[w],u.node(n),B=h.getHighlightPath(n),p=A[n],H=new primitives.orgdiagram.ConnectorPoint(p.actualPosition.horizontalCenter(),p.actualPosition.bottom()),H.isSquared=
!0,H.highlightPath=B.partnerHighlightPath,H.connectorStyleType=B.partnerHighlightPath?2:0,H.visibility=p.actualVisibility,l.push(H);0<l.length&&(l.sort(function(a,b){return a.x-b.x}),u.hasChildren(d.id)||(T=(l[0].x+l[l.length-1].x)/2),b.addInverted(function(b){t(b,c,T,O,l,!0,a,1==s.arrowsDirection)}))}k=[];u.hasChildren(d.id)&&(N=!1,u.loopChildren(this,d.id,function(d,f){q=y[v.getLevelIndex(d)];p=A[d];B=h.getHighlightPath(d);da=c.getPalette(B.highlightPath?2:1);ga=b.getPolyline(da);if(f.connectorPlacement&
8)W=A[v.getPrevItem(d)],r.transformPoints(p.actualPosition.x,q.shift+q.horizontalConnectorsDepth,W.actualPosition.right(),q.shift+q.horizontalConnectorsDepth,!0,this,function(a,c,d,f){m(a,c,d,f,b,ga,p.actualVisibility,W.actualVisibility)});else if(f.connectorPlacement&2)aa=A[v.getNextItem(d)],r.transformPoints(p.actualPosition.right(),q.shift+q.horizontalConnectorsDepth,aa.actualPosition.x,q.shift+q.horizontalConnectorsDepth,!0,this,function(a,c,d,f){m(a,c,d,f,b,ga,p.actualVisibility,aa.actualVisibility)});
else if(f.connectorPlacement&1&&!j){V=!0;if(a)switch(p.actualVisibility){case 2:case 3:V=X}H=new primitives.orgdiagram.ConnectorPoint(p.actualPosition.horizontalCenter()+0,p.actualPosition.top());H.isSquared=V;H.connectorStyleType=B.highlightPath?2:1;H.visibility=p.actualVisibility;k.push(H);S=Math.max(S,H.connectorStyleType);N=N||H.isSquared}}),!j&&0<k.length&&(r.transformPoints(T,O,T,e.shift+e.connectorShift,!0,this,function(a,f,e,j){var i=Math.round(s.elbowDotSize/2),h=c.getPalette(S),n=b.getPolyline(h),
n=b.getPolyline(n.arrowPaletteItem);g&&(0!=s.elbowType&&0<d.partners.length)&&n.addSegment(new primitives.common.DotSegment(a-i,f-i,2*i,2*i,i));b.addInverted(function(c){c=c.getPolyline(h);c.addSegment(new primitives.common.MoveSegment(e,j));c.addSegment(new primitives.common.LineSegment(a,f));1==s.arrowsDirection&&(4!=d.visibility&&1>=l.length)&&c.addArrow(s.linesWidth,function(a){a.mergeTo(b.getPolyline(a.paletteItem))})});g&&(0!=s.elbowType&&1<k.length)&&n.addSegment(new primitives.common.DotSegment(e-
i,j-i,2*i,2*i,i))}),t(b,c,T,e.shift+e.connectorShift,k,N,a,2==s.arrowsDirection)))}function m(a,b,c,d,f,e,g,j){a=new primitives.common.Point(a,b);c=new primitives.common.Point(c,d);d=!1;switch(s.arrowsDirection){case 1:4!=j&&(d=!0);break;case 2:4!=g&&(a.swap(c),d=!0)}e.addSegment(new primitives.common.MoveSegment(a));e.addSegment(new primitives.common.LineSegment(c));d&&e.addArrow(s.linesWidth,function(a){a.mergeTo(f.getPolyline(a.paletteItem))})}function t(a,b,c,d,f,e,g,j){var k,i,h,l=[],n,m,v;if(e){l=
[];e=0;for(i=f.length;e<i;e+=1)if(h=f[e],h.x<c&&!h.isSquared)l.push(h);else break;i=l.length;0<i&&q(a,b,c,d,l,!1,j);l=[];for(k=f.length-1;k>=e;k-=1)if(h=f[k],h.x>c&&!h.isSquared)l.push(h);else break;i=l.length;0<i&&q(a,b,c,d,l,!1,j);l={};i={};for(m in primitives.common.ConnectorStyleType)primitives.common.ConnectorStyleType.hasOwnProperty(m)&&(l[primitives.common.ConnectorStyleType[m]]=c,i[primitives.common.ConnectorStyleType[m]]=c);for(m=e;m<=k;m+=1){h=f[m];n=b.getPalette(h.connectorStyleType);v=
a.getPolyline(n);n=s.bevelSize;2>n&&(n=0);if(g)switch(s.elbowType){case 2:case 3:0<n&&(Math.abs(c-h.x)>n&&Math.abs(d-h.y)>n)&&(h.hasElbow=!0,h.elbowPoint1=new primitives.common.Point(h.x,d+(d>h.y?-n:n)),h.elbowPoint2=new primitives.common.Point(h.x+(c>h.x?n:-n),d));break;case 1:0<k-e&&r.transformPoints(h.x,d,h.x,h.y,!0,this,function(b,c){var d=Math.round(s.elbowDotSize/2);a.getPolyline(v.arrowPaletteItem).addSegment(new primitives.common.DotSegment(b-d,c-d,2*d,2*d,d))})}l[h.connectorStyleType]=Math.min(l[h.connectorStyleType],
h.hasElbow?h.elbowPoint2.x:h.x);i[h.connectorStyleType]=Math.max(i[h.connectorStyleType],h.hasElbow?h.elbowPoint2.x:h.x)}n=[Math.max(0,e-1),Math.min(k+1,f.length-1)];for(m=0;m<n.length;m+=1)h=f[n[m]],l[h.connectorStyleType]=Math.min(l[h.connectorStyleType],h.hasElbow?h.elbowPoint2.x:h.x),i[h.connectorStyleType]=Math.max(i[h.connectorStyleType],h.hasElbow?h.elbowPoint2.x:h.x);h=c;for(m=2;0<=m;m-=1)n=b.getPalette(m),v=a.getPolyline(n),n=l[m],null!=n&&n<h&&(r.transformPoints(h,d,n,d,!0,this,function(a,
b,c,d){v.addSegment(new primitives.common.MoveSegment(a,b));v.addSegment(new primitives.common.LineSegment(c,d))}),h=n),n=i[m],null!=n&&n>c&&(r.transformPoints(c,d,n,d,!0,this,function(a,b,c,d){v.addSegment(new primitives.common.MoveSegment(a,b));v.addSegment(new primitives.common.LineSegment(c,d))}),c=n);for(m=e;m<=k;m+=1)h=f[m],n=b.getPalette(h.connectorStyleType),v=a.getPolyline(n),h.hasElbow?(r.transform3Points(h.elbowPoint2.x,h.elbowPoint2.y,h.elbowPoint1.x,h.elbowPoint2.y,h.elbowPoint1.x,h.elbowPoint1.y,
!0,this,function(a,b,c,d,f,e){switch(s.elbowType){case 2:v.addSegment(new primitives.common.MoveSegment(a,b));v.addSegment(new primitives.common.LineSegment(f,e));break;case 3:v.addSegment(new primitives.common.MoveSegment(a,b)),v.addSegment(new primitives.common.CubicArcSegment(a,b,c,d,f,e))}}),r.transformPoints(h.elbowPoint1.x,h.elbowPoint1.y,h.x,h.y,!0,this,function(a,b,c,d){v.addSegment(new primitives.common.LineSegment(c,d))})):r.transformPoints(h.x,d,h.x,h.y,!0,this,function(a,b,c,d){v.addSegment(new primitives.common.MoveSegment(a,
b));v.addSegment(new primitives.common.LineSegment(c,d))}),g&&(j&&4!=h.visibility)&&v.addArrow(s.linesWidth,function(b){b.mergeTo(a.getPolyline(b.paletteItem))})}else q(a,b,c,d,f,!0,j)}function q(a,b,c,d,f,e,g){var j=null,k=f.length,h,i,l,n,j=e?c:f[k-1].x;i=new primitives.common.Point(j,d);for(c=0;c<k;c+=1){l=f[c];h=b.getPalette(l.connectorStyleType);n=a.getPolyline(h);r.transformPoint(j,d,!0,this,function(a,b){n.addSegment(new primitives.common.MoveSegment(a,b))});switch(s.connectorType){case 1:r.transformPoint(l.x,
l.y,!0,this,function(a,b){n.addSegment(new primitives.common.LineSegment(a,b))});break;case 2:h=new primitives.common.Rect(i,l),e?j>h.x?r.transform3Points(h.right(),h.verticalCenter(),h.x,h.verticalCenter(),h.x,h.bottom(),!0,this,function(a,b,c,d,f,e){n.addSegment(new primitives.common.CubicArcSegment(a,b,c,d,f,e))}):r.transform3Points(h.x,h.verticalCenter(),h.right(),h.verticalCenter(),h.right(),h.bottom(),!0,this,function(a,b,c,d,f,e){n.addSegment(new primitives.common.CubicArcSegment(a,b,c,d,f,
e))}):j>h.x?r.transformPoints(h.x,h.y,h.x,h.bottom(),!0,this,function(a,b,c,d){n.addSegment(new primitives.common.QuadraticArcSegment(a,b,c,d))}):r.transformPoints(h.right(),h.y,h.right(),h.bottom(),!0,this,function(a,b,c,d){n.addSegment(new primitives.common.QuadraticArcSegment(a,b,c,d))})}g&&4!=l.visibility&&n.addArrow(s.linesWidth,function(b,c){var d;b.mergeTo(a.getPolyline(b.paletteItem));B&&(d=a.getPolyline({fillColor:"#ff0000"}),d.addSegment(new primitives.common.DotSegment(c.x-1,c.y-1,2,2,
1)))})}}var p,r,s,u,v,y,A,w,B=!1;return{process:function(){p=a();r=b.getTransform();s=d.getOptions();u=e.getVisualTree();v=f.getTreeLevels();y=g.getTreeLevelsPositions();A=g.getItemsPositions();w=k.getPaletteManager();p.reset("placeholder",5);l(j);return!1}}};
primitives.orgdiagram.DrawCursorTask=function(a,b,c,d,e,f,g,h){function i(a){var b;j.activate("placeholder",9);var c=e.getItemPosition(a),g=c.actualPosition,i=new primitives.common.Rect(c.contentPosition),p=f.getTemplateParams(a).template,r=p.templateConfig,c=r.cursorPadding;i.offset(c.left,c.top,c.right,c.bottom);b=new primitives.common.RenderEventArgs;b.context=d.getConfig(a);b.isCursor=!0;b.isSelected=h.isSelected(a);b.templateName=r.name;k.transformRect(g.x,g.y,g.width,g.height,!0,this,function(a,
c,d,f){j.template(a,c,d,f,i.x,i.y,i.width,i.height,p.cursorTemplate.template(),p.cursorTemplate.getHashCode(),p.cursorTemplate.render,b,{"border-width":r.cursorBorderWidth})})}var j,k;return{process:function(){var c=g.getCursorTreeItem();j=a();j.reset("placeholder",9);null!=c&&(k=b.getTransform(),i(c));return!1}}};
primitives.orgdiagram.DrawHighlightAnnotationTask=function(a,b,c,d,e,f,g,h,i,j,k,l,n){function m(a){var b,c,k,m,B,D,z=!0,F,C=i.getItemPosition(a),x=C.actualPosition;switch(C.actualVisibility){case 2:case 3:case 1:b=g.getItemOptions(a);switch(b.showCallout){case 2:z=!1;break;case 1:z=!1;break;default:z=r.showCallout}z?(t.activate("placeholder",10),q.transformRect(x.x,x.y,x.width,x.height,!0,this,function(g,z,q,x){var z=new primitives.common.Rect(g,z,q,x),g=new primitives.common.Point(z.horizontalCenter(),
z.verticalCenter()),q=e.getOptions().scale,x=new primitives.common.Point(j.getPlaceholderOffset()),I=i.getContentSize(),M=d.getOptimalPanelSize();x.scale(1/q);M.scale(1/q);q=new primitives.common.Rect(x.x,x.y,Math.min(M.width,I.width),Math.min(M.height,I.height));1!=C.actualVisibility||!q.overlaps(z)?(B=!primitives.common.isNullOrEmpty(b.calloutTemplateName)?b.calloutTemplateName:!primitives.common.isNullOrEmpty(b.templateName)?b.templateName:!primitives.common.isNullOrEmpty(r.defaultCalloutTemplateName)?
r.defaultCalloutTemplateName:r.defaultTemplateName,D=h.getTemplate(B,h.DefaultWidgetTemplateName),z=D.templateConfig.itemSize,x=new primitives.common.Rect(g.x,g.y,z.width,z.height),g.y>q.bottom()-q.height/4?(x.y-=z.height/2,x.x=g.x<q.horizontalCenter()?x.x+z.width/4:x.x-(z.width/4+z.width)):(x.y+=z.height/4,x.x-=z.width/2),x.x<q.x?x.x=q.x+5:x.right()>q.right()&&(x.x-=x.right()-q.right()+5),x.y<q.y?x.y=q.y+5:x.bottom()>q.bottom()&&(x.y-=x.bottom()-q.bottom()+5),k=x,c=new primitives.common.Rect(k),
c.addRect(g.x,g.y),c.offset(50),F=c.getCSS(),F.display="inherit",F.visibility="inherit",s.calloutPlaceholder.css(F),g.x-=c.x,g.y-=c.y,k.x-=c.x,k.y-=c.y,m=new primitives.common.RenderEventArgs,m.context=f.getConfig(a),m.isCursor=l.getCursorTreeItem()==a,m.isSelected=n.isSelected(a),m.templateName=D.templateConfig.name,t.resize("calloutplaceholder",c.width,c.height),t.activate("calloutplaceholder",13),t.template(k.x,k.y,k.width,k.height,0,0,k.width,k.height,D.itemTemplate.template(),D.itemTemplate.getHashCode(),
D.itemTemplate.render,m,null),p.pointerPlacement=0,p.cornerRadius=r.calloutCornerRadius,p.offset=r.calloutOffset,p.opacity=r.calloutOpacity,p.lineWidth=r.calloutLineWidth,p.pointerWidth=r.calloutPointerWidth,p.borderColor=r.calloutBorderColor,p.fillColor=r.calloutfillColor,p.draw(g,k)):s.calloutPlaceholder.css({display:"none",visibility:"hidden"})})):s.calloutPlaceholder.css({display:"none",visibility:"hidden"});break;case 4:s.calloutPlaceholder.css({display:"none",visibility:"hidden"})}}var t,q,
p=new primitives.common.Callout(b()),r,s;return{process:function(){var d=k.getHighlightTreeItem();t=b();t.reset("calloutplaceholder",13);null!==d&&(q=c.getTransform(),r=g.getOptions(),s=a(),m(d));return!1}}};
primitives.orgdiagram.DrawHighlightTask=function(a,b,c,d,e,f,g,h,i){function j(a){var b;k.activate("placeholder",6);var c=e.getItemPosition(a),g=c.actualPosition,j=f.getTemplateParams(a).template,r=j.templateConfig,s=r.highlightPadding;b=new primitives.common.RenderEventArgs;b.context=d.getConfig(a);b.isCursor=h.getCursorTreeItem()==a;b.isSelected=i.isSelected(a);b.templateName=r.name;l.transformRect(g.x,g.y,g.width,g.height,!0,this,function(a,d,f,e){var g=new primitives.common.Rect(0,0,Math.round(f),
Math.round(e));g.offset(s.left,s.top,s.right,s.bottom);1==c.actualVisibility?k.template(a,d,f,e,g.x,g.y,g.width,g.height,j.highlightTemplate.template(),j.highlightTemplate.getHashCode(),j.highlightTemplate.render,b,null):k.template(a,d,f,e,g.x,g.y,g.width-1,g.height-1,j.dotHighlightTemplate.template(),j.dotHighlightTemplate.getHashCode(),j.dotHighlightTemplate.render,b,null)})}var k,l;return{process:function(){var c=g.getHighlightTreeItem();k=a();k.reset("placeholder",6);null!=c&&(l=b.getTransform(),
j(c));return!1}}};
primitives.orgdiagram.DrawItemLabelsTask=function(a,b,c,d,e,f){function g(){var a,b,c,e,g,p,r,s=[];j.loopLevels(this,function(a){var c=[];j.loopLevelItems(this,a,function(a){var e=d.getItemOptions(a),g=f.getItemPosition(a),a=g.actualPosition;null!=e&&i.transformRect(a.x,a.y,a.width,a.height,!0,this,function(a,d,f,j){switch(g.actualVisibility){case 1:0==k.showLabels&&(b=new primitives.common.Label,b.text="dummy",b.position=new primitives.common.Rect(a,d,f,j),b.weight=1E4,b.labelType=1,c.push(b));break;
case 2:var h,i,l=null,m=k.labelOffset,v,p;if(!primitives.common.isNullOrEmpty(e.label)){switch(e.showLabel){case 0:switch(k.showLabels){case 0:switch(g.actualVisibility){case 3:case 2:l=new primitives.common.Label,l.labelType=0,l.weight=g.leftPadding+g.rightPadding}break;case 1:l=new primitives.common.Label,l.labelType=2,l.weight=1E4}break;case 1:l=new primitives.common.Label,l.weight=1E4,l.labelType=2}if(null!=l){l.text=e.label;v=null!=e.labelSize?e.labelSize:k.labelSize;l.labelOrientation=3!=e.labelOrientation?
e.labelOrientation:3!=k.labelOrientation?k.labelOrientation:0;p=0!=e.labelPlacement?e.labelPlacement:0!=k.labelPlacement?k.labelPlacement:1;switch(l.labelOrientation){case 0:h=v.width;i=v.height;break;case 1:case 2:i=v.width,h=v.height}switch(p){case 0:case 1:l.position=new primitives.common.Rect(a+f/2-h/2,d-m-i,h,i);switch(l.labelOrientation){case 0:l.horizontalAlignmentType=0;l.verticalAlignmentType=2;break;case 1:l.horizontalAlignmentType=1;l.verticalAlignmentType=1;break;case 2:l.horizontalAlignmentType=
2,l.verticalAlignmentType=1}break;case 2:case 11:l.position=new primitives.common.Rect(a+f+m,d-m-i,h,i);switch(l.labelOrientation){case 0:l.horizontalAlignmentType=1;l.verticalAlignmentType=2;break;case 1:l.horizontalAlignmentType=1;l.verticalAlignmentType=0;break;case 2:l.horizontalAlignmentType=2,l.verticalAlignmentType=2}break;case 3:l.position=new primitives.common.Rect(a+f+m,d+j/2-i/2,h,i);switch(l.labelOrientation){case 0:l.horizontalAlignmentType=1;l.verticalAlignmentType=1;break;case 1:l.horizontalAlignmentType=
0;l.verticalAlignmentType=0;break;case 2:l.horizontalAlignmentType=0,l.verticalAlignmentType=2}break;case 4:case 12:l.position=new primitives.common.Rect(a+f+m,d+j+m,h,i);switch(l.labelOrientation){case 0:l.horizontalAlignmentType=1;l.verticalAlignmentType=0;break;case 1:l.horizontalAlignmentType=2;l.verticalAlignmentType=0;break;case 2:l.horizontalAlignmentType=1,l.verticalAlignmentType=2}break;case 5:l.position=new primitives.common.Rect(a+f/2-h/2,d+j+m,h,i);switch(l.labelOrientation){case 0:l.horizontalAlignmentType=
0;l.verticalAlignmentType=0;break;case 1:l.horizontalAlignmentType=2;l.verticalAlignmentType=1;break;case 2:l.horizontalAlignmentType=1,l.verticalAlignmentType=1}break;case 6:case 10:l.position=new primitives.common.Rect(a-h-m,d+j+m,h,i);switch(l.labelOrientation){case 0:l.horizontalAlignmentType=2;l.verticalAlignmentType=0;break;case 1:l.horizontalAlignmentType=2;l.verticalAlignmentType=2;break;case 2:l.horizontalAlignmentType=1,l.verticalAlignmentType=0}break;case 7:l.position=new primitives.common.Rect(a-
h-m,d+j/2-i/2,h,i);switch(l.labelOrientation){case 0:l.horizontalAlignmentType=2;l.verticalAlignmentType=1;break;case 1:l.horizontalAlignmentType=0;l.verticalAlignmentType=2;break;case 2:l.horizontalAlignmentType=0,l.verticalAlignmentType=0}break;case 8:case 9:switch(l.position=new primitives.common.Rect(a-h-m,d-m-i,h,i),l.labelOrientation){case 0:l.horizontalAlignmentType=2;l.verticalAlignmentType=2;break;case 1:l.horizontalAlignmentType=1;l.verticalAlignmentType=2;break;case 2:l.horizontalAlignmentType=
2,l.verticalAlignmentType=0}}}}b=l;null!=b&&c.push(b)}})});s[a]=c});var u=[],v=[],y=[];0==k.showLabels&&(j.loopLevels(this,function(a){var b=s[a],c,d,f=!1;e=0;for(p=b.length;e<p;e+=1)c=b[e],null==d?d=new primitives.common.Rect(c.position):d.addRect(c.position),f=f||2==c.labelType;u[a]=d;v[a]=f}),j.loopLevelsReversed(this,function(a){var b=u[a-1],c=u[a];y[a]=!0;null!=b&&null!=c&&b.overlaps(c)&&(y[a]=!1)}),j.loopLevels(this,function(d){a=s[d];if(y[d]){e=0;for(p=a.length;e<p;e+=1)if(b=a[e],b.isActive)for(g=
e+1;g<p;g+=1)if(c=a[g],c.isActive)if(b.position.overlaps(c.position))if(b.weight>=c.weight)0==c.labelType&&(c.isActive=!1);else{0==b.labelType&&(b.isActive=!1);break}else break}}));h.activate("placeholder",8);r={"font-size":k.labelFontSize,"font-family":k.labelFontFamily,"font-style":k.labelFontStyle,"font-weight":k.labelFontWeight,"font-color":k.labelColor};j.loopLevels(this,function(a){if(1==k.showLabels||y[a]||v[a]){a=s[a];e=0;for(p=a.length;e<p;e+=1)if(b=a[e],b.isActive)switch(b.labelType){case 0:case 2:h.text(b.position.x,
b.position.y,b.position.width,b.position.height,b.text,b.labelOrientation,b.horizontalAlignmentType,b.verticalAlignmentType,r)}}})}var h,i,j,k;return{process:function(){h=a();i=b.getTransform();k=d.getOptions();j=e.getTreeLevels();h.reset("placeholder",8);g();return!1}}};
primitives.orgdiagram.DrawMinimizedItemsTask=function(a,b,c,d,e,f,g){function h(){var a=new primitives.common.PolylinesBuffer,b={},c,e=new primitives.common.Marker,h,s,u,v;n.loop(this,function(i){var n=d.getItemOptions(i),w=g.getItemPosition(i),B=w.actualPosition,D,z;j.transformRect(B.x,B.y,B.width,B.height,!0,this,function(d,g,j,B){switch(w.actualVisibility){case 2:D=f.getTemplateParams(i);z=D.template.templateConfig;u=s=h=null;v=0;null!=n&&(s=h=n.itemTitleColor,u=n.minimizedItemShapeType);h=h||
z.minimizedItemBorderColor||"#000080";s=s||z.minimizedItemFillColor||"#000080";null==u&&(u=null!==z.minimizedItemShapeType?z.minimizedItemShapeType:l.minimizedItemShapeType);v=null===z.minimizedItemCornerRadius?z.minimizedItemSize.width/2:z.minimizedItemCornerRadius;null==u||6==u?(c=a.getPolyline(new primitives.common.PaletteItem({lineColor:h,lineWidth:z.minimizedItemLineWidth,lineType:z.minimizedItemLineType,fillColor:s,opacity:z.minimizedItemOpacity})),c.addSegment(new primitives.common.DotSegment(d,
g,j,B,v))):e.draw(a,u,new primitives.common.Rect(d,g,j,B),new primitives.common.PaletteItem({lineColor:h,lineWidth:z.minimizedItemLineWidth,lineType:z.minimizedItemLineType,fillColor:s,opacity:z.minimizedItemOpacity}));break;default:k&&(h="#ff0000",b.hasOwnProperty(h)||(b[h]=new primitives.common.PaletteItem({lineColor:h,lineWidth:1,lineType:0,fillColor:h,opacity:1})),c=a.getPolyline(b[h]),c.addSegment(new primitives.common.DotSegment(d-1,g-1,2,2,1)))}})});i.activate("placeholder",7);i.polylinesBuffer(a)}
var i,j,k,l,n;return{process:function(){i=a();j=b.getTransform();n=e.getVisualTree();l=d.getOptions();i.reset("placeholder",7);h();return!1}}};
primitives.orgdiagram.DrawPrintPreviewTask=function(a,b,c,d,e){var f;return{process:function(){var b=c.getOptions(),h=e.getOptions();f=a();f.reset("placeholder",1);if(4==b.pageFitMode){var i=new primitives.common.Size(b.printPreviewPageSize),j,k,l=d.getContentSize(),b=new primitives.common.PrintPreviewTemplate(b);i.scale(1/h.scale);f.activate("placeholder",1);for(h=0;(h+1)*i.width<l.width;){for(j=0;(j+1)*i.height<l.height;)k=f.template(h*i.width,j*i.height,i.width,i.height,0,0,i.width,i.height,b.template(),
b.getHashCode(),b.render,null,null),k.data({column:h,row:j}),j+=1;h+=1}}return!1}}};
primitives.orgdiagram.DrawShapeAnnotationTask=function(a,b,c,d,e,f){function g(a,b){var c;c=11;var d,f,e,g,s,u,v,y,A,w;d=0;for(f=a.length;d<f;d+=1)if(A=a[d],null!=A.items&&0<A.items.length){u=new primitives.common.Rect;c=0;for(e=A.items.length;c<e;c+=1)s=b(A.items[c]),null!=s&&u.addRect(s.actualPosition);if(!u.isEmpty()){g=new primitives.common.Shape(h);s=new primitives.orgdiagram.ShapeAnnotationConfig;v="opacity cornerRadius shapeType offset lineWidth borderColor fillColor lineType labelSize labelOffset labelPlacement zOrderType".split(" ");c=
0;for(e=v.length;c<e;c+=1)y=v[c],g[y]=A.hasOwnProperty(y)?A[y]:s[y];switch(g.zOrderType){case 2:c=11;break;case 1:c=3;break;default:switch(g.shapeType){case 3:case 1:case 2:c=11;break;default:c=3}}c=h.activate("placeholder",c);g.position=u;g.orientationType=j.orientationType;g.panelSize=c.size;g.labelTemplate=k;g.hasLabel=null!=A.templateName||null!=A.label;w=new primitives.common.RenderEventArgs;w.context=A;w.templateName=g.labelTemplate;i.transformRect(u.x,u.y,u.width,u.height,!0,this,function(a,
b,c,d){a=new primitives.common.Rect(a,b,c,d);g.draw(a,w)})}}}var h,i,j,k=new primitives.common.AnnotationLabelTemplate;return{process:function(){h=a();i=b.getTransform();j=d.getOptions();h.reset("placeholder",11);h.reset("placeholder",3);g(e.getAnnotations(),f.getItemPosition);return!1}}};
primitives.orgdiagram.DrawTreeItemsTask=function(a,b,c,d,e,f,g,h,i,j,k,l,n){function m(){var a,b=i.getCursorTreeItem();t.loop(this,function(c){var d=q[c],f=d.actualPosition;1==d.actualVisibility&&r.transformRect(f.x,f.y,f.width,f.height,!0,this,function(f,g,k,i){var l=h.getTemplateParams(c),n=l.template;a=new primitives.common.RenderEventArgs;a.context=e.getConfig(c);a.isCursor=c==b;a.isSelected=j.isSelected(c);a.templateName=n.templateConfig.name;p.activate("placeholder",10);p.template(f,g,k,i,d.contentPosition.x,
d.contentPosition.y,d.contentPosition.width,d.contentPosition.height,n.itemTemplate.template(),n.itemTemplate.getHashCode(),n.itemTemplate.render,a,{"border-width":n.templateConfig.itemBorderWidth});l.hasGroupTitle&&p.template(f,g,k,i,2,d.contentPosition.y,s.groupTitlePanelSize-4,d.contentPosition.height+2,y.template(),y.getHashCode(),y.render,a,null);l.hasSelectorCheckbox&&(p.activate("placeholder",14),p.template(f,g,k,i,d.contentPosition.x,i-(s.checkBoxPanelSize-4),d.contentPosition.width,s.checkBoxPanelSize-
4,v.template(),v.getHashCode(),v.render,a,null));l.hasButtons&&(p.activate("placeholder",14),p.template(f,g,k,i,k-(s.buttonsPanelSize-4),d.contentPosition.y,s.buttonsPanelSize-4,Math.max(d.contentPosition.height,i-d.contentPosition.y),u.template(),n.templateConfig.name+u.getHashCode(),u.render,l,null))})})}var t,q,p,r,s,u,v,y;return{process:function(){p=a();s=d.getOptions();t=f.getVisualTree();q=g.getItemsPositions();r=b.getTransform();u=n.getTemplate();v=l.getTemplate();y=k.getTemplate();p.reset("placeholder",
10);p.reset("placeholder",14);m();return!1}}};primitives.orgdiagram.ButtonsTemplateTask=function(){var a=null;return{process:function(){return!1},getTemplate:function(){null==a&&(a=new primitives.common.ButtonsTemplate);return a}}};primitives.orgdiagram.CheckBoxTemplateTask=function(a){var b=null;return{process:function(){b=null;return!0},getTemplate:function(){var c;null==b&&(c=a.getOptions(),b=new primitives.common.CheckBoxTemplate(c.selectCheckBoxLabel));return b}}};
primitives.orgdiagram.GroupTitleTemplateTask=function(a){var b=null;return{process:function(){b=null;return!0},getTemplate:function(){var c;null==b&&(c=a.getOptions(),b=new primitives.common.GroupTitleTemplate(c.itemTitleFirstFontColor,c.itemTitleSecondFontColor));return b}}};
primitives.orgdiagram.ItemTemplateParamsTask=function(a,b,c){function d(a,b,c){var d=!1;switch(b){case 0:switch(c){case 0:d=a;break;case 1:d=!0;break;case 2:d=!1}break;case 1:d=!0;break;case 2:d=!1}return d}var e={};return{process:function(){var f=a.getOptions(),g=0<f.buttons.length,h=b.getCursorItem(),i=f.items,j,k;e={};j=0;for(k=i.length;j<k;j+=1){var l=i[j],n=new primitives.orgdiagram.TemplateParams,m=h==l.id,t=c.getTemplate(l.templateName,f.defaultTemplateName,c.DefaultWidgetTemplateName),q=t.templateConfig,
p=null!=q.buttons&&0<q.buttons.length;n.template=t;n.hasSelectorCheckbox=d(m,l.hasSelectorCheckbox,f.hasSelectorCheckbox);n.hasButtons=(g||p)&&d(m,l.hasButtons,f.hasButtons);n.hasGroupTitle=!primitives.common.isNullOrEmpty(l.groupTitle);n.isActive=l.isActive&&q.isActive;n.hasButtons&&(n.buttons=p?q.buttons:f.buttons);e[l.id]=n}return!0},getTemplateParams:function(a){return e[a]}}};
primitives.orgdiagram.ReadTemplatesTask=function(a){var b={};return{process:function(){var c,d,e,f=a.getOptions(),g=f.templates;b={};b.DefaultWidgetTemplate=new primitives.orgdiagram.Template(f,new primitives.orgdiagram.TemplateConfig);c=new primitives.orgdiagram.TemplateConfig;c.name="DefaultWidgetLabelAnnotationTemplate";c.isActive=!1;c.itemSize=new primitives.common.Size(100,20);c.minimizedItemSize=new primitives.common.Size(0,0);d=new primitives.orgdiagram.Template;d.templateConfig=c;d.minimizedItemCornerRadius=
c.minimizedItemSize.width/2;d.itemTemplate=new primitives.common.LabelAnnotationTemplate;d.dotHighlightTemplate=new primitives.common.DotHighlightTemplate(f,c);b.DefaultWidgetLabelAnnotationTemplate=d;c=0;for(d=g.length;c<d;c+=1)e=g[c],b[e.name]=new primitives.orgdiagram.Template(f,e);return!0},getTemplate:function(a,d,e){return b[a]||b[d]||b[e]},DefaultWidgetTemplateName:"DefaultWidgetTemplate",DefaultWidgetLabelAnnotationTemplateName:"DefaultWidgetLabelAnnotationTemplate"}};
primitives.orgdiagram.CombinedNormalVisibilityItemsTask=function(a,b,c,d,e,f,g,h,i){function j(a){var b=[],c,d,f,e,g,j,k={};c=0;for(d=a.length;c<d;c+=1){f=a[c];g=f.getItems();f=0;for(e=g.length;f<e;f+=1)j=g[f],k.hasOwnProperty(j)||(b.push(j),k[j]=!0)}return b}var k=[],l={},n=[b,c,d,e,f,g,h,i],m=new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0);return{process:function(){var b={isChanged:!1,hash:l},c=a.getOptions();k=m.read(k,j(n),"items",b);if(0==c.pageFitMode||
1==c.minimalVisibility)b.isChanged=!1;return b.isChanged},isItemSelected:function(a){return l.items.hasOwnProperty(a)}}};primitives.orgdiagram.CursorItemTask=function(a,b){var c=null;return{process:function(){var d=a.getCursorItem(),e=b.getOrgTree().node(d);c=null!=d&&null!=e&&e.isActive&&e.isVisible?d:null;return!0},getCursorTreeItem:function(){return c},getItems:function(){return null!=c?[c]:[]}}};
primitives.orgdiagram.CursorNeighboursTask=function(a,b){function c(a,b){var c=[];null!==a&&b.loopNeighbours(this,a,function(a,b){0===b.visibility&&c.push(a);return!0});return c}var d=[];return{process:function(){var e=b.getNavigationFamily(),f=a.getCursorTreeItem();d=c(f,e);return!0},getItems:function(){return d}}};
primitives.orgdiagram.HighlightItemTask=function(a,b){var c=null;return{process:function(){var d=a.getHighlightItem(),e=b.getOrgTree().node(d);c=null!=d&&null!=e&&e.isActive&&e.isVisible?d:null;return!0},getHighlightTreeItem:function(){return c}}};
primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask=function(a){function b(a){var b=[],c={},d,e,k,l,n,m;d=0;for(e=a.length;d<e;d+=1)if(k=a[d],k.selectItems){n=k.items;k=0;for(l=n.length;k<l;k+=1)m=n[k],null!=m&&!c.hasOwnProperty(m)&&(b.push(m),c[m]=!0)}return b}var c=[],d={},e=new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0);return{process:function(){var f={isChanged:!1,hash:d},g=a.getAnnotations();c=e.read(c,b(g),"items",f);return f.isChanged},
getItems:function(){return c}}};
primitives.orgdiagram.NormalVisibilityItemsByConnectorAnnotationTask=function(a){function b(a){var b=[],c={},d,e,k;d=0;for(e=a.length;d<e;d+=1)k=a[d],k.selectItems&&(null!=k.fromItem&&!c.hasOwnProperty(k.fromItem)&&(b.push(k.fromItem),c[k.fromItem]=!0),null!=k.toItem&&!c.hasOwnProperty(k.toItem)&&(b.push(k.toItem),c[k.toItem]=!0));return b}var c=[],d={},e=new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0);return{process:function(){var f={isChanged:!1,hash:d},
g=a.getAnnotations();c=e.read(c,b(g),"items",f);return f.isChanged},getItems:function(){return c}}};
primitives.orgdiagram.SelectedItemsTask=function(a){function b(a){var b=[],c={},d,e,k;d=0;for(e=a.length;d<e;d+=1)k=a[d],null!=k&&!c.hasOwnProperty(k)&&(b.push(k),c[k]=!0);return b}var c=[],d={},e=new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0);return{process:function(){var f={isChanged:!1,hash:d},g=a.getSelectedItems();c=e.read(c,b(g),"items",f);return f.isChanged},getItems:function(){return c},isSelected:function(a){return d.items.hasOwnProperty(a)}}};
primitives.orgdiagram.SelectionPathItemsTask=function(a,b,c,d){function e(a,b,c){var d=[],f={},e,n,m;n=0;for(m=a.length;n<m;n+=1)switch(e=a[n],c){case 1:b.loopParents(this,e,function(a){if(null!=f[a])return b.SKIP;d.push(a);f[a]=!0})}return d}var f=[];return{process:function(){var g=d.getSelectionPathMode(),h=a.getNavigationFamily(),i=b.getCursorTreeItem(),j=c.getItems().slice(0);j.push(i);f=e(j,h,g);return!0},getItems:function(){return f}}};
primitives.orgdiagram.BackgroundAnnotationManagerTask=function(a,b,c,d){function e(){var a=new primitives.common.perimeter.Manager,b,c,d,e,h,i,m,A,w,B,D,z,F,C,x;if(!k.isEmpty()&&(m=[],A=[],k.loopLevels(this,function(a){D=B=null;x=l[a];4!=x.actualVisibility&&(m.push(a),F=[],k.loopLevelItems(this,a,function(a){var b=j.node(a);z=n[a];4!=z.actualVisibility&&null!=b&&(null!=D&&g(F,B,D,z),B=D,D=z)}),null!=D&&g(F,B,D,null),A.push(F))}),0<A.length)){w=[];h=[];b=0;for(c=A.length;b<c;b+=1)h=primitives.common.mergeSort([h,
A[b]],null,!0),w.push(h),h=A[b];w.push(primitives.common.mergeSort([A[b-1]],null,!0));h=[];b=0;for(c=w.length;b<c;b+=1){i={};F=w[b];d=0;for(e=F.length;d<e;d+=1)C=F[d],i[C]=d;h.push(i)}d=[];i=C=null;b=0;for(c=m.length;b<c;b+=1)e=m[b],null!=i&&f(d,b-1,h,w,l[C],i,l[i],l[e]),C=i,i=e;null!=i&&f(d,b-1,h,w,l[C],i,l[i],null);a.add(d)}return a}function f(a,b,c,d,f,e,g,i){var l=Math.floor(m.normalItemsInterval/2),w=null!=f?Math.floor(3*(f.shift+f.depth)/7+4*g.shift/7):g.shift-l,B=null!=i?Math.floor(3*(g.shift+
g.depth)/7+4*i.shift/7):g.shift+g.depth+l,D=null,z=null,F,C,x;k.loopLevelItems(this,e,function(f){x=j.node(f);F=n[f];4!=F.actualVisibility&&null!=x&&(null!=z&&h(a,c[b],c[b+1],d[b],d[b+1],w,B,D,z,F,C.id),D=z,z=F,C=x)});null!=z&&h(a,c[b],c[b+1],d[b],d[b+1],w,B,D,z,null,C.id)}function g(a,b,c,d){var f=Math.floor(m.normalItemsInterval/2),b=null!=b?Math.floor(3*b.actualPosition.right()/7+4*c.actualPosition.x/7):c.actualPosition.x-f,c=null!=d?Math.floor(3*c.actualPosition.right()/7+4*d.actualPosition.x/
7):c.actualPosition.right()+f;a.push(b);a.push(c)}function h(a,b,c,d,f,e,g,j,k,h,i){var l=[],n=primitives.common.perimeter.SegmentItem,F=Math.floor(m.normalItemsInterval/2),j=null!=j?Math.floor(3*j.actualPosition.right()/7+4*k.actualPosition.x/7):k.actualPosition.x-F,k=null!=h?Math.floor(3*k.actualPosition.right()/7+4*h.actualPosition.x/7):k.actualPosition.right()+F;l.push(new n(j,e,j,g));for(h=c[j]+1;h<=c[k];h+=1)l.push(new n(f[h-1],g,f[h],g));l.push(new n(k,g,k,e));for(h=b[k]-1;h>=b[j];h-=1)l.push(new n(d[h+
1],e,d[h],e));a.push(new primitives.common.perimeter.Item(i,l))}var i=null,j,k,l,n,m;return{process:function(){i=null;j=b.getOrgTree();k=c.getTreeLevels();l=d.getTreeLevelsPositions();n=d.getItemsPositions();m=a.getOptions();return!0},getBackgroundManager:function(){null==i&&(i=e());return i}}};primitives.orgdiagram.CombinedContextsTask=function(a,b){return{process:function(){return!0},getConfig:function(c){return a.getConfig(c)||null!=b&&b.getConfig(c)}}};
primitives.orgdiagram.ConnectionsGraphTask=function(a,b,c){function d(){var a,b,d,e,n,m,t,q=primitives.common.graph(),p,r;g.loopLevels(this,function(s){g.loopLevelItems(this,s,function(s){d=f.node(s);e=null!=h.hasItem(s)?100:1;if(d.connectorPlacement&8)m=[g.getPrevItem(s)];else if(d.connectorPlacement&2)m=[g.getNextItem(s)];else if(d.connectorPlacement&1){p=f.parent(s);m=1<p.partners.length?p.partners.slice(0):[p.id];var v=c.getOrgPartners(p.id);0<v.length&&(m=m.concat(v))}else m=[];a=0;for(b=m.length;a<
b;a+=1)t=m[a],n=null!=h.hasItem(t)?100:1,r=new primitives.famdiagram.EdgeItem(s,e,t,n),r.highlightItemId=s,1!=b&&(r.partnerid=t),q.addEdge(s,t,r)})});return q}var e=null,f,g,h;return{process:function(){e=null;f=a.getVisualTree();g=b.getTreeLevels();h=b.getActiveTreeLevels();return!0},getGraph:function(){null==e&&(e=d());return e}}};primitives.orgdiagram.DummyExtraPartnersTask=function(){var a={};return{process:function(){return!1},getOrgPartners:function(b){return a[b]||[]}}};
primitives.orgdiagram.IntervalsTask=function(a){var b={};return{process:function(){var c=a.getOptions();b[1]=c.normalItemsInterval;b[2]=c.dotItemsInterval;b[3]=c.lineItemsInterval;b[4]=c.lineItemsInterval;return!0},getInterval:function(a){return b[a]}}};
primitives.orgdiagram.ItemsPositionsTask=function(a,b,c,d,e,f,g,h,i,j,k,l,n,m){var t,q,p;function r(a){var b=new primitives.common.Rect(0,0,0,0),c,d,f,e,g;switch(M.orientationType){case 2:case 3:a.invert()}if(!E.isEmpty())switch(K.pageFitMode){case 0:case 4:case 5:c=[new primitives.orgdiagram.LevelVisibility(0,1)];b=s(c,0);break;default:c=[new primitives.orgdiagram.LevelVisibility(0,1)];d=[];switch(K.minimalVisibility){case 2:d.push(2);break;case 0:case 3:case 4:d.push(2),d.push(3)}E.loopLevelsReversed(this,
function(a){var b;for(b=0;b<d.length;b+=1)c.push(new primitives.orgdiagram.LevelVisibility(a,d[b]))});f=s(c,c.length-1);f.addRect(a);f.offset(0,0,5,5);g=e=a=null;b=s(c,0);if(!u(b,f)&&(a=0,b=s(c,c.length-1),u(b,f))){for(g=e=c.length-1;1<e-a;)g=Math.floor((e+a)/2),b=s(c,g),u(b,f)?e=g:a=g;e!==g&&(b=s(c,e))}}return b}function s(a,b){var c,d;t=[];E.loopLevels(this,function(){var a=new primitives.orgdiagram.TreeLevelPosition;a.currentvisibility=1;t.push(a)});for(c=0;c<=b;c+=1)d=a[c],t[d.level].currentvisibility=
d.currentvisibility;A();D();w();c=K.lineLevelShift;var f,e,g,j=d=0;f=8*J.linesWidth;switch(J.arrowsDirection){case 1:d=f;j=0;break;case 2:d=0,j=f}f=0;for(e=t.length;f<e;f+=1)g=t[f],c+=g.setShift(c,B(g.actualVisibility),j,d);return new primitives.common.Rect(0,0,Math.round(y()),Math.round(v()))}function u(a,b){var c=!1;switch(K.pageFitMode){case 1:b.width>=a.width&&(c=!0);break;case 2:b.height>=a.height&&(c=!0);break;case 3:b.height>=a.height&&b.width>=a.width&&(c=!0)}return c}function v(){var a=t[t.length-
1];return a.shift+a.nextLevelShift}function y(){var a=0,b,c;b=0;for(c=t.length;b<c;b+=1)a=Math.max(a,t[b].currentOffset);return a+=K.normalItemsInterval}function A(){var a=n.getCursorTreeItem();q={};E.loopLevels(this,function(b){var c=t[b];E.loopLevelItems(this,b,function(b,d){var f=new primitives.orgdiagram.TreeItemPosition,e=m.isItemSelected(b)?1:d.visibility,g=l.getTemplateParams(b);f.actualVisibility=0===e?c.currentvisibility:e;f.setSize(a==b,g,K,M);q[b]=f})})}function w(){var a,b,c,d,f,e,j,k,
h,i,l;E.loopLevels(this,function(n){var m=t[n];m.shift=0;m.depth=0;m.partnerConnectorOffset=0;m.actualVisibility=4;e=[];l=i=null;E.loopLevelItems(this,n,function(a,b){var c=q[a];m.depth=Math.max(m.depth,c.actualSize.height);switch(c.actualVisibility){case 2:case 3:case 4:l=!l?c.actualSize.height:Math.min(l,c.actualSize.height);break;default:i=!i?c.actualSize.height:Math.min(i,c.actualSize.height)}m.actualVisibility=Math.min(m.actualVisibility,c.actualVisibility);c=g.getOrgPartners(b.id);(0<b.partners.length||
0<c.length)&&e.push(new primitives.common.StackSegment(b))});null==i&&(i=m.depth);null!=l&&l>i&&(i=l);switch(K.verticalAlignment){case 0:m.horizontalConnectorsDepth=i/2;break;case 1:m.horizontalConnectorsDepth=m.depth/2;break;case 2:m.horizontalConnectorsDepth=m.depth-i/2}if(0<e.length){a=0;for(b=e.length;a<b;a+=1){j=e[a];n=g.getOrgPartners(j.context.id);k=j.context.partners.slice(0);0===k.length&&k.push(j.context.id);k=k.concat(n);c=0;for(d=k.length;c<d;c+=1)h=q[k[c]],f=h.offset+h.actualSize.width/
2,j.startIndex=null!=j.startIndex?Math.min(j.startIndex,f):f,j.endIndex=null!=j.endIndex?Math.max(j.endIndex,f):f}m.partnerConnectorOffset=primitives.common.stackSegments(e,function(a,b){q[a.context.id].partnerConnectorOffset=b})}})}function B(a){var b=0;switch(a){case 1:b=K.normalLevelShift;break;case 2:b=K.dotLevelShift;break;case 3:case 4:b=K.lineLevelShift}return b}function D(){var a,b;a=0;for(b=t.length;a<b;a+=1)t[a].currentOffset=0;E.loopItems(this,function(a,b){z(a,b,0);return!0})}function z(a,
b,c){var d=q[a],f=d.actualVisibility,e=t[c],f=h.getInterval(0===f?e.currentvisibility:f)/2,g,j,k,i,l,n,m;l=8*J.linesWidth;d.leftPadding=f+(0<e.currentOffset?f*b.relationDegree*K.cousinsIntervalMultiplier:0);d.rightPadding=f;0!=J.arrowsDirection&&(b.connectorPlacement&8&&(d.leftPadding+=l),b.connectorPlacement&2&&(d.rightPadding+=l));d.offset=e.currentOffset+d.leftPadding;e.currentOffset=d.offset+d.actualSize.width+d.rightPadding;if(G.hasChildren(a))if(G.loopChildren(this,b.id,function(a,b){z(a,b,
c+1)}),a=F(b),0<a)x(b,a);else if(0>a&&(a=-a,C(b,a),g=null,j={},i=null,d=G.parent(b.id),null!==d&&(G.loopChildrenReversed(this,d.id,function(a,c){if(c===b)g=[];else if(null!==g){var d=null,f=[],e,h,l,n;e=I[c.id];void 0===e&&(e=[]);e=e.slice();e.splice(0,0,c.id);h=0;for(l=e.length;h<l;h+=1)n=q[e[h]],f[h]=n.offset+n.actualSize.width+n.rightPadding;e=[];var m;h=Q[b.id];void 0===h&&(h=[]);h=h.slice();h.splice(0,0,b.id);l=0;for(n=h.length;l<n;l+=1)m=q[h[l]],e[l]=m.offset-m.leftPadding;h=Math.min(f.length,
e.length);for(l=0;l<h&&!(n=e[l]-f[l],d=null!==d?Math.min(d,n):n,0>=n);l+=1);k=Math.floor(d);j[c.id]=k;if(0<k)g.splice(0,0,c);else return i=c,!0}}),0<g.length))){e=null;if(null!==i){l=[i];l=l.concat(g);l.push(b);e=[[i]];d=1;for(f=l.length;d<f;d+=1)n=l[d-1],m=l[d],2==n.gravity||1==m.gravity?e[e.length-1].push(m):e.push([m])}else e=[g.slice(0)],e[e.length-1].push(b);if(0<e.length){g=e[e.length-1];for(d=g.length-2;0<=d;d-=1)m=g[d],k=j[m.id],a=Math.min(k,a),C(m,a),x(m,a)}l=a/(e.length-1);for(f=e.length-
2;0<f;f-=1){n=e[f];for(d=n.length-1;0<=d;d-=1)m=n[d],k=j[m.id],a=Math.min(f*l,Math.min(k,a)),C(m,a),x(m,a)}}}function F(a){var b=q[a.id],b=b.offset+b.actualSize.width/2,c=null,d,f,e;if(null===a.visualAggregatorId)switch(d=null,G.loopChildren(this,a.id,function(a,b){d=b;if(d.connectorPlacement&1)return!0}),f=q[d.id],e=null,G.loopChildrenReversed(this,a.id,function(a,b){e=b;if(e.connectorPlacement&1)return!0}),a=q[e.id],P.horizontalAlignment){case 1:c=f.offset+f.actualSize.width/2;break;case 2:c=a.offset+
a.actualSize.width/2;break;case 0:c=(f.offset+a.offset+a.actualSize.width)/2}else a=q[a.visualAggregatorId],c=a.offset+a.actualSize.width/2;return b-c}function C(a,b){var c=q[a.id];c.offset+=b;var d=t[E.getLevelIndex(a.id)];d.currentOffset=Math.max(d.currentOffset,c.offset+c.actualSize.width)}function x(a,b){var c,d,f;G.hasChildren(a.id)&&(G.loopChildren(this,a.id,function(a,f){c=f;d=q[a];d.offset+=b;x(c,b)}),f=t[E.getLevelIndex(c.id)],f.currentOffset=Math.max(f.currentOffset,d.offset+d.actualSize.width))}
function L(){E.loopLevels(this,function(a){var b=t[a];E.loopLevelItems(this,a,function(a){q[a].setPosition(b,K,M)})})}q={};t=[];p=null;var E,G,Q,I,M,J,P,K,R;return{process:function(){var g;K=d.getOptions();M=c.getOptions();J=e.getOptions();P=f.getOptions();E=j.getTreeLevels();G=i.getVisualTree();Q=k.getLeftMargins();I=k.getRightMargins();t=[];q={};g=a.getOptimalPanelSize();R=b.getOptions();g.scale(1/R.scale);g=new primitives.common.Rect(0,0,g.width,g.height);p=r(g);L();return!0},getTreeLevelsPositions:function(){return t},
getItemsPositions:function(){return q},getItemPosition:function(a){return q[a]},getContentSize:function(){return p}}};
primitives.orgdiagram.OrgTreeTask=function(a){var b,c;function d(a){var d,h,i,j,k,l=0,n,m=primitives.common.tree();j=0;for(k=a.length;j<k;j+=1)i=a[j],null!=i.id&&(d=new primitives.orgdiagram.OrgItem(i),n=parseInt(i.id,10),l=Math.max(isNaN(n)?0:n,l),m.add(i.parent,d.id,d));l+=1;a=new primitives.orgdiagram.ItemConfig;a.id=l;a.title="internal root";a.isVisible=!1;a.isActive=!1;h=new primitives.orgdiagram.OrgItem(a);h.hideParentConnection=!0;h.hideChildrenConnection=!0;m.add(null,h.id,h);m.loopLevels(this,
function(a,b,c){if(0<c)return m.BREAK;h.id!=a&&(m.adopt(h.id,a),b.itemType=0)});e(m);b=m;c=l;return!0}function e(a){a.loopLevels(this,function(b,c){var d=!0;if(c.isVisible)return a.SKIP;a.loopChildren(this,b,function(a,b){if(0!=b.itemType)return d=!1,!0});if(d)c.hideChildrenConnection=!0,a.loopChildren(this,b,function(a,b){b.hideParentConnection=!0});else return a.SKIP})}c=b=null;return{process:function(){d(a.getItems());return!0},getOrgTree:function(){return b},getMaximumId:function(){return c}}};
primitives.orgdiagram.PaletteManagerTask=function(a,b){var c;return{process:function(){var d=[];null!=b&&(d=b.getOptions().linesPalette);c=new primitives.common.PaletteManager(a.getOptions(),d);return!0},getPaletteManager:function(){return c}}};
primitives.orgdiagram.TracePathAnnotationsTask=function(a,b,c,d,e){function f(a,b,c,d,f){var e,h,i,r,s,u,v,y,A,w,B,D={};e=0;for(h=a.length;e<h;e+=1)if(i=a[e],null!=i.items&&0<i.items.length&&(w=i.items.slice(0),s=d.node(w[0]),null!=s&&(1==w.length&&f.loopParents(this,s.id,function(a){c.node(a).isActive&&w.push(a);return f.SKIP}),1<w.length))){i=1;for(r=w.length;i<r;i+=1)if(v=d.node(w[i]),null!=v){A=b.getShortestPath(s.id,v.id,function(a,b,c){return a.getNear(c)});s=1;for(u=A.length;s<u;s+=1)B=b.edge([A[s-
1]],[A[s]]),y=g(D,B.highlightItemId),y.highlightPath=1,B.hasOwnProperty("partnerid")&&(y=g(D,B.partnerid),y.partnerHighlightPath=1);s=v}}return D}function g(a,b){var c=a[b];null==c&&(c=new primitives.orgdiagram.TreeItemHighlightPath,a[b]=c);return c}var h={},i=new primitives.orgdiagram.TreeItemHighlightPath;return{process:function(){var g=e.getNavigationFamily(),k=c.getOrgTree(),i=d.getVisualTree(),n=b.getGraph(),m=a.getAnnotations();h=f(m,n,k,i,g);return!0},getHighlightPath:function(a){return h[a]||
i}}};primitives.orgdiagram.VisualTreeLevelsTask=function(a,b){var c=null,d=null;return{process:function(){var e=a.getVisualTree();c=primitives.common.TreeLevels();d=primitives.common.TreeLevels();e.loopLevels(this,function(a,e,h){var i=b.getTemplateParams(a);c.addItem(h,a,e);null!=i&&(i.isActive&&4!=e.visibility)&&d.addItem(h,a,e)});return!0},getTreeLevels:function(){return c},getActiveTreeLevels:function(){return d}}};
primitives.orgdiagram.VisualTreeMarginsTask=function(a){function b(a,b,c){a.loop(this,function(a){b[a]=[];c[a]=[]});a.loopPostOrder(this,function(a,d,e){var d=b[e],k=c[e],l=b[a],n=c[a],m;if(null!=e){d[0]||(d[0]=a);e=0;for(m=l.length;e<m;e+=1)d[e+1]||(d[e+1]=l[e]);k[0]=a;e=0;for(m=n.length;e<m;e+=1)k[e+1]=n[e]}})}var c={},d={};return{process:function(){c={};d={};b(a.getVisualTree(),c,d);return!0},getLeftMargins:function(){return c},getRightMargins:function(){return d}}};
primitives.orgdiagram.VisualTreeTask=function(a,b,c,d){function e(a,b,c){var e,g,r,B,D,z,F,C,x,L,E,G,Q={},I,M={},J,P,K,R={},W;a.loopPostOrder(this,function(a,b,c,d){b.hasVisibleChildren=b.isVisible||b.hasVisibleChildren;null!=d&&(d.hasVisibleChildren=d.hasVisibleChildren||b.hasVisibleChildren)});a.loopLevels(this,function(f,h){var i,C,F;if(!d&&!h.hasVisibleChildren)return a.SKIP;i=c.node(f);i||(i=t({visibility:4,connectorPlacement:0,parentId:null,actualItemType:0},h),c.add(null,f,i));K=P=0;if(null!=
(z=c.indexOf(f)))P=z,K=c.countSiblings(f)-z-1;C=[];a.loopChildren(this,f,function(a,b){if(d||b.hasVisibleChildren){e=t({parentId:f,actualItemType:b.itemType},b);switch(i.actualItemType){case 7:case 8:case 6:switch(e.actualItemType){case 7:case 8:case 6:e.actualItemType=2;break;case 0:e.actualItemType=1}}switch(e.actualItemType){case 5:q(i,e),e.connectorPlacement=5,F=t({visibility:4}),c.add(F.id,e.id,e),e=F;case 8:case 2:g=c.parent(f);if(i.connectorPlacement&2)B=l(c,p.navigationFamily,i),c.add(g.id,
e.id,e,B+1),e.connectorPlacement=6,e.gravity=2;else if(i.connectorPlacement&8)D=n(c,p.navigationFamily,i),c.add(g.id,e.id,e,D),e.connectorPlacement=12,e.gravity=1;else switch(b.adviserPlacementType){case 2:B=l(c,p.navigationFamily,i);c.add(g.id,e.id,e,B+1);e.connectorPlacement=6;e.gravity=2;break;default:D=n(c,p.navigationFamily,i),c.add(g.id,e.id,e,D),e.connectorPlacement=12,e.gravity=1}switch(e.actualItemType){case 8:null!=i.parentId?q(c.node(i.parentId),e):q(i,e,!0);break;case 2:q(i,e)}break;case 4:q(i,
e),e.connectorPlacement=5,F=t({visibility:4}),c.add(F.id,e.id,e),e=F;case 1:null===i.visualAggregatorId&&m(c,i,!1);switch(b.adviserPlacementType){case 2:c.add(f,e.id,e,0);e.connectorPlacement=6;e.gravity=2;break;default:c.add(f,e.id,e),e.connectorPlacement=12,e.gravity=1}1==e.actualItemType&&q(i,e);break;case 0:C.push(e);q(i,e);break;case 7:case 6:g=c.parent(f);if(i.connectorPlacement&2)c.add(g.id,e.id,e,P),e.connectorPlacement=6,e.gravity=2;else if(i.connectorPlacement&8)c.add(g.id,e.id,e,c.countChildren(g.id)-
K),e.connectorPlacement=12,e.gravity=1;else{switch(b.adviserPlacementType){case 2:c.add(g.id,e.id,e,P);e.gravity=2;break;default:c.add(g.id,e.id,e,c.countChildren(g.id)-K),e.gravity=1}switch(e.actualItemType){case 6:e.connectorPlacement=5;break;case 7:e.connectorPlacement=4}}null!=i.parentId?q(c.node(i.parentId),e):q(i,e,!0)}}});switch(i.actualItemType){case 7:case 8:case 6:break;default:W=[],null!=(g=c.parent(f))&&c.loopChildrenRange(this,g.id,P,c.countChildren(g.id)-K,function(b,c){if(c.id==f)W.push(c);
else switch(c.actualItemType){case 7:case 8:case 6:a.parentid(c.id)==f&&W.push(c)}}),1<W.length&&(R[f]=W)}Q[f]=[];M[f]=[];var x=i,r=h.childrenPlacementType,w=Q[f],L=M[f],E,G,I,J,$,Z,ca,Y,fa=4==x.visibility&&0===x.connectorPlacement;switch(b.horizontalAlignment){case 0:case 1:G=3;break;case 2:G=2}0===r&&(r=k(a,x)?0===b.leavesPlacementType?3:b.leavesPlacementType:0===b.childrenPlacementType?2:b.childrenPlacementType);E=x;null!==x.visualAggregatorId&&(E=c.node(x.visualAggregatorId));3==r&&3>C.length&&
(r=2);switch(r){case 2:r=0;for(J=C.length;r<J;r+=1)x=C[r],w=a.node(x.id),c.add(E.id,x.id,x),x.connectorPlacement=(w.hideParentConnection?0:1)|(w.hideChildrenConnection?0:4),0===r&&(x.relationDegree=1);break;case 3:J=Math.min(b.maximumColumnsInMatrix,Math.ceil(Math.sqrt(C.length)));$=Math.ceil(C.length/J);Z=Math.ceil(J/2);for(ca=0;ca<Z;ca+=1){G=E;for(Y=0;Y<$;Y+=1){x=j(C,2*ca,Y,J);r=j(C,2*ca+1,Y,J);void 0===w[Y]&&(w[Y]=[],L[Y]=[]);null!==x&&(0===ca&&(x.relationDegree=1),c.add(G.id,x.id,x),x.connectorPlacement=
(fa?0:2)|4,x.gravity=2,L[Y].push(x));if(null!==x||null!==r)I=t({visibility:4,connectorPlacement:fa?0:5}),c.add(G.id,I.id,I),w[Y].push(I);null!==r&&(c.add(G.id,r.id,r),r.connectorPlacement=(fa?0:8)|4,r.gravity=1,L[Y].push(r));G=I}}2<J&&(E.visualAggregatorId=null);break;case 1:r=0;for(J=C.length;r<J;r+=1){x=C[r];I=t({visibility:4,connectorPlacement:fa?0:5});E.visualAggregatorId=I.id;switch(G){case 2:c.add(E.id,x.id,x);c.add(E.id,I.id,I);x.connectorPlacement=(fa?0:2)|4;x.gravity=2;break;case 3:c.add(E.id,
I.id,I),c.add(E.id,x.id,x),x.connectorPlacement=(fa?0:8)|4,x.gravity=1}w[r]=[I];L[r]=[x];E=I}break;default:throw"Children placement is undefined!";}});a.loopPostOrder(this,function(a){var b=c.node(a),d,e,g;if(null!=b){d=M[a];e=Q[a];L=h(c,b);if(0<L&&(b.visualDepth=L+1,null!==b.visualAggregatorId)){r=c.node(b.visualAggregatorId);g=c.hasChildren(r.id);for(z=0;z<L-1;z+=1)r=m(c,r,!g)}g=0;var j=c.parent(b.id),k,l,n;if(null!==j){k=c.indexOf(b.id);for(l=1;null!=(n=c.getChild(j.id,k+l));)if(n.connectorPlacement&
8)g=Math.max(g,i(c,n)),l+=1;else break;for(l=1;null!=(n=c.getChild(j.id,k-l));)if(n.connectorPlacement&2)g=Math.max(g,i(c,n)),l+=1;else break}L=g;if(1<L){b.visualDepth+=L-1;g=c.hasChildren(a);r=b;for(z=0;z<L-1;z+=1)r=m(c,r,!g)}E=[];z=0;for(F=d.length;z<F;z+=1){J=d[z];C=E[z]=0;for(x=J.length;C<x;C+=1)E[z]=Math.max(E[z],i(c,J[C]))}z=0;for(F=E.length;z<F;z+=1)if(G=E[z],1<G){C=0;for(x=e[z].length;C<x;C+=1)if(I=e[z][C],c.hasChildren(I.id))for(L=G;1<L;)I=m(c,I,!1),L-=1}null!=R[a]&&f(c,b,R[a])}})}function f(a,
b,c){var d,e,f,j,k=0,h=[],i,n;e=0;for(f=c.length;e<f;e+=1)d=c[e],k=Math.max(k,d.visualDepth);e=0;for(f=c.length;e<f;e+=1){d=c[e];i=g(a,d);j=1;for(n=d;null!=n.visualAggregatorId;)n=a.node(n.visualAggregatorId),n.connectorPlacement=5,j+=1;for(;j<k;)i=m(a,i,!1),j+=1;h.push(g(a,i).id)}n=g(a,b);if(a.hasChildren(n.id)){i=c[Math.floor(c.length/2)];if(1<c.length&&0===c.length%2){e=a.parent(i.id);f=l(a,p.navigationFamily,i);j=a.getChild(e.id,f).gravity||a.getChild(e.id,f+1).gravity;i=t({visibility:4,connectorPlacement:i.connectorPlacement&
10,gravity:j});a.add(e.id,i.id,i,f+1);for(j=1;j<k;)i=m(a,i,!1),i.connectorPlacement=0,j+=1}e=0;for(f=c.length;e<f;e+=1)d=c[e],p.navigationFamily.loopChildren(this,b.id,function(a,c){switch(c.actualItemType){case 5:case 2:case 4:case 1:break;default:b.id!=d.id&&q(d,c)}return p.navigationFamily.SKIP});i=g(a,i);a.moveChildren(n.id,i.id)}i.partners=h}function g(a,b){for(var c=b;null!=c.visualAggregatorId;)c=a.node(c.visualAggregatorId);return c}function h(a,b){var c=0;null!=b.visualAggregatorId&&a.loopLevels(this,
b.id,function(d,e,f){if(b.visualAggregatorId==d)return a.SKIP;c=f+1});return c}function i(a,b){var c=0;a.loopLevels(this,b.id,function(a,b,d){c=d+1});return c+1}function j(a,b,c,d){0<d%2&&(b===d-1?b=a.length:b===d&&(b=d-1));b=c*d+b;return b>a.length-1?null:a[b]}function k(a,b){var c=!1,d=!0;a.loopChildren(this,b.id,function(b,e){c=!0;if(0===e.itemType&&a.hasChildren(b))return d=!1,!0});return c&&d}function l(a,b,c){var d=null,e={},f=a.parent(c.id);a.loopChildrenReversed(this,f.id,function(a,f,g){if(null===
d)a==c.id&&(d=-1,e[c.id]=!0,b.loopChildren(this,c.id,function(a,c,d){if(0<d)return b.BREAK;e[a]=!0}));else if(e.hasOwnProperty(a))b.loopChildren(this,f.id,function(a,c,d){if(0<d)return b.BREAK;e[a]=!0});else return d=g,!0});return d}function n(a,b,c){var d=null,e={},f=a.parent(c.id);a.loopChildren(this,f.id,function(a,f,g,j){if(null===d)a==c.id&&(d=j+1,e[c.id]=!0,b.loopChildren(this,c.id,function(a,c,d){if(0<d)return b.BREAK;e[a]=!0}));else if(e.hasOwnProperty(a))b.loopChildren(this,a,function(a,
c,d){if(0<d)return b.BREAK;e[a]=!0});else return d=g,!0});return d}function m(a,b,c){c=t({visibility:4,visualAggregatorId:b.visualAggregatorId,connectorPlacement:4==b.visibility&&0===b.connectorPlacement||c?0:5});a.insert(b.id,c.id,c);b.visualAggregatorId=c.id;return c}function t(a,b){var c=new primitives.orgdiagram.TreeItem,d;for(d in a)a.hasOwnProperty(d)&&(c[d]=a[d]);null!=b?(c.id=b.id,c.visibility=b.isVisible?0:4):(r+=1,c.id=r);return c}function q(a,c,d){var e=[];d||4==a.visibility||!b.getTemplateParams(a.id).isActive?
p.navigationFamily.loopParents(this,a.id,function(a,c){if(4!=c.visibility&&b.getTemplateParams(a).isActive)return e.push(a),p.navigationFamily.SKIP}):e.push(a.id);null!=p.navigationFamily.node(c.id)?p.navigationFamily.adopt(e,c.id):p.navigationFamily.add(e,c.id,c)}var p={visualTree:null,navigationFamily:null},r;return{process:function(){var b=a.getOrgTree(),d=c.getOptions();p.visualTree=primitives.common.tree();p.navigationFamily=primitives.common.family();r=a.getMaximumId();b.hasNodes()&&e(b,d,p.visualTree);
return!0},getVisualTree:function(){return p.visualTree},getNavigationFamily:function(){return p.navigationFamily}}};primitives.common.AnnotationLabelTemplate=function(){var a,b=jQuery("<div></div>");b.addClass("bp-item bp-corner-all bp-connector-label");a=b.wrap("<div>").parent().html();var c=primitives.common.hashCode(a);return{template:function(){return a},getHashCode:function(){return c},render:function(a,b){b.element.html(b.context.label)}}};
primitives.common.ButtonsTemplate=function(){var a,b=jQuery("<ul></ul>");b.css({position:"absolute"}).addClass("ui-widget ui-helper-clearfix");a=b.wrap("<div>").parent().html();var c=primitives.common.hashCode(a);return{template:function(){return a},getHashCode:function(){return c},render:function(a,b){var c=0,g,h=b.buttons,i,j;switch(b.renderingMode){case 0:for(j=0;j<h.length;j+=1)g=h[j],i=jQuery('<li data-buttonname="'+g.name+'"></li>').css({position:"absolute",top:c+"px",left:"0px",width:g.size.width+
"px",height:g.size.height+"px",padding:"3px"}).addClass("orgdiagrambutton"),b.element.append(i),i.button({icons:{primary:g.icon},text:g.text,label:g.label}),primitives.common.isNullOrEmpty(g.tooltip)||null!=i.tooltip&&i.tooltip({content:g.tooltip}),c+=10+g.size.height}}}};
primitives.common.CheckBoxTemplate=function(a){var b,c=jQuery("<div></div>");c.addClass("bp-item bp-selectioncheckbox-frame");c.append(jQuery('<label><nobr><input type="checkbox" name="checkbox" class="bp-selectioncheckbox" />&nbsp;<span name="selectiontext" class="bp-selectiontext">'+a+"</span></nobr></label>"));b=c.wrap("<div>").parent().html();var d=primitives.common.hashCode(b);return{template:function(){return b},getHashCode:function(){return d},render:function(a,b){b.element.find("[name=checkbox]").prop("checked",
b.isSelected)}}};primitives.common.CursorTemplate=function(a,b){var c;c=jQuery("<div></div>").css({width:b.itemSize.width+b.cursorPadding.left+b.cursorPadding.right+"px",height:b.itemSize.height+b.cursorPadding.top+b.cursorPadding.bottom+"px","border-width":b.cursorBorderWidth+"px"}).addClass("bp-item bp-corner-all bp-cursor-frame").wrap("<div>").parent().html();var d=primitives.common.hashCode(c);return{template:function(){return c},getHashCode:function(){return d},render:function(){}}};
primitives.common.DotHighlightTemplate=function(a,b){var c,d=b.minimizedItemCornerRadius+b.highlightPadding.left;c=jQuery("<div></div>").css({"border-width":b.highlightBorderWidth+"px","-moz-border-radius":d,"-webkit-border-radius":d,"-khtml-border-radius":d,"border-radius":d}).addClass("bp-item bp-highlight-dot-frame").wrap("<div>").parent().html();var e=primitives.common.hashCode(c);return{template:function(){return c},getHashCode:function(){return e},render:function(){}}};
primitives.common.GroupTitleTemplate=function(a,b){var c,d=jQuery("<div></div>");d.addClass("bp-item bp-corner-all bp-grouptitle-frame");c=d.wrap("<div>").parent().html();var e=primitives.common.hashCode(c);return{template:function(){return c},getHashCode:function(){return e},render:function(c,d){var e=new primitives.text.Config,i=d.context,j=i.groupTitleColor||"#4169e1";e.orientation=2;e.horizontalAlignment=0;e.verticalAlignment=1;e.text=i.groupTitle;e.fontSize="12px";e.color=primitives.common.highestContrast(j,
b,a);e.fontFamily="Arial";switch(d.renderingMode){case 0:d.element.bpText(e);break;case 1:d.element.bpText("option",e),d.element.bpText("update")}primitives.common.css(d.element,{background:j})}}};
primitives.common.HighlightTemplate=function(a,b){function c(){return d}var d;d=jQuery("<div></div>").css({"border-width":b.highlightBorderWidth+"px"}).addClass("bp-item bp-corner-all bp-highlight-frame").wrap("<div>").parent().html();var e=primitives.common.hashCode(c);return{template:c,getHashCode:function(){return e},render:function(){}}};
primitives.common.ItemTemplate=function(a,b){function c(){return d}var d,e=new primitives.common.Size(b.itemSize),f,g,h;e.width-=2*b.itemBorderWidth;e.height-=2*b.itemBorderWidth;f=jQuery("<div></div>").css({"border-width":b.itemBorderWidth+"px"}).addClass("bp-item bp-corner-all bt-item-frame");g=jQuery('<div name="titleBackground"></div>').css({top:"2px",left:"2px",width:e.width-4+"px",height:"18px"}).addClass("bp-item bp-corner-all bp-title-frame");f.append(g);h=jQuery('<div name="title"></div>').css({top:"1px",
left:"4px",width:e.width-4-8+"px",height:"16px"}).addClass("bp-item bp-title");g.append(h);g=jQuery("<div></div>").css({top:"24px",left:"2px",width:"50px",height:"60px"}).addClass("bp-item bp-photo-frame");f.append(g);h=jQuery('<img name="photo" alt=""></img>').css({width:"50px",height:"60px"});g.append(h);e=jQuery('<div name="description"></div>').css({top:"24px",left:"56px",width:e.width-4-56+"px",height:"74px"}).addClass("bp-item bp-description");f.append(e);d=f.wrap("<div>").parent().html();var i=
primitives.common.hashCode(c);return{template:c,getHashCode:function(){return i},render:function(b,c){var d=c.context,e=null!=d.itemTitleColor?d.itemTitleColor:"#4169e1",f=primitives.common.highestContrast(e,a.itemTitleSecondFontColor,a.itemTitleFirstFontColor);c.element.find("[name=titleBackground]").css({background:e});c.element.find("[name=photo]").attr({src:d.image,alt:d.title});c.element.find("[name=title]").css({color:f}).text(d.title);c.element.find("[name=description]").text(d.description)}}};
primitives.common.PrintPreviewTemplate=function(){function a(){return b}var b,c=jQuery("<div></div>");c.addClass("bp-item bp-printpreview");b=c.wrap("<div>").parent().html();var d=primitives.common.hashCode(a);return{template:a,getHashCode:function(){return d},render:function(){}}};
primitives.common.UserTemplate=function(a,b,c){var d=primitives.common.hashCode(b);return{template:function(){return b},getHashCode:function(){return d},render:function(b,d){if(null!=c)c(b,d);else{var g=d.context,h=null!=g.itemTitleColor?g.itemTitleColor:"#4169e1",i=primitives.common.highestContrast(h,a.itemTitleSecondFontColor,a.itemTitleFirstFontColor);d.element.find("[name=titleBackground]").css({background:h});d.element.find("[name=photo]").attr({src:g.image,alt:g.title});d.element.find("[name=title]").css({color:i}).text(g.title);
d.element.find("[name=description]").text(g.description)}}}};
primitives.orgdiagram.BaseControl=function(a,b,c,d){function e(a){switch(a){case 1:case 2:f(!0,u);break;default:null!=p.mouse&&p.mouse.destroy();j(p.layout);p.layout.element.find("."+p.name).remove();var a=p.layout,b=p.name,e=new primitives.common.Rect(0,0,a.element.outerWidth(),a.element.outerHeight()),r=new primitives.common.Rect(e),B=a.element.offset(),D;D=jQuery('<div tabindex="0"></div>');D.css({position:"relative",overflow:"auto","-webkit-overflow-scrolling":"touch",top:"0px",left:"0px",width:e.width+
"px",height:e.height+"px",padding:"0px","margin-bottom":"0px","margin-right":"0px","margin-top":-B.top+Math.floor(B.top)+"px","margin-left":-B.left+Math.floor(B.left)+"px"});D.addClass(b);e=jQuery("<div></div>");e.css({position:"absolute",overflow:"hidden",top:"0px",left:"0px"});e.addClass(b);e.css(r.getCSS());B=jQuery("<div></div>");B.css({position:"absolute",overflow:"hidden",top:"0px",left:"0px"});B.addClass("placeholder");B.addClass(b);B.css(r.getCSS());r=jQuery("<div></div>");r.css({position:"absolute",
overflow:"visible"});r.addClass("calloutplaceholder");r.addClass(b);r.css({top:"0px",left:"0px",width:"0px",height:"0px"});D.append(e);e.append(B);B.append(r);a.element.append(D);a.scrollPanel=D;a.mousePanel=e;a.placeholder=B;a.calloutPlaceholder=r;p.options.enablePanning&&(p.mouse=new primitives.common.Mouse,p.mouse.init(p.layout.element,{name:p.name,onMouseDrag:k,onMouseStop:l,onMouseCapture:n}));a=p.layout;a.mousePanel.mousemove(function(a){var b=p.layout.mousePanel.offset(),c=a.pageX-b.left,b=
a.pageY-b.top,d=p.tasks.getTask("CreateTransformTask"),e=p.tasks.getTask("HighlightItemOptionTask");if(!p.mouse||!p.mouse.isStarted())s=!1,e.hasHighlightEnabled()&&(c=d.getTreeItemForMousePosition(c,b),m(a,c))}).click(function(a){if(!p.mouse||!p.mouse.isStarted()){var b=p.layout.mousePanel.offset(),c=a.pageX-b.left,e=a.pageY-b.top,f=p.tasks.getTask("CreateTransformTask"),b=p.tasks.getTask("CursorItemOptionTask"),c=f.getTreeItemForMousePosition(c,e),g;null!==c&&(c=c.id,s||(e=jQuery(a.target),e.hasClass(p.name+
"button")||0<e.parent("."+p.name+"button").length?(g=e.hasClass(p.name+"button")?e:e.parent("."+p.name+"button"),g=g.data("buttonname"),g=d(p,null,c,g),q("onButtonClick",a,g)):"selectiontext"!==e.attr("name")&&("checkbox"===e.attr("name")?(b=(p.options.selectedItems||[]).slice(0),g=d(p,null,c,g),q("onSelectionChanging",a,g),e=primitives.common.indexOf(b,c),0<=e?b.splice(e,1):b.push(c),p.options.selectedItems=b,q("onSelectionChanged",a,g)):(g=d(p,null,c,void 0),q("onMouseClick",a,g),!g.cancel&&b.hasCursorEnabled()&&
(t(a,c),p.layout.scrollPanel.focus())))))}s=!1}).dblclick(function(a){var b;b=p.tasks.getTask("HighlightItemTask").getHighlightTreeItem();null!==b&&!s&&(b=d(p,null,b,void 0),q("onMouseDblClick",a,b));s=!1});a.scrollPanel.keydown(function(a){var b=p.tasks.getTask("HighlightItemTask"),c=p.tasks.getTask("HighlightItemOptionTask"),d=p.tasks.getTask("CursorItemTask"),e=p.tasks.getTask("CursorItemOptionTask"),f=p.tasks.getTask("AlignDiagramTask"),g=p.tasks.getTask("CreateTransformTask").getTransform(),
b=b.getHighlightTreeItem()||d.getCursorTreeItem(),j,d=null,k,h=p.layout;if(null!=b){switch(a.which){case 13:t(a,b);a.preventDefault();h.scrollPanel.focus();break;case 40:d=1;break;case 38:d=0;break;case 37:d=2;break;case 39:d=3}if(null!=d){for(k=!1;!k;){k=!0;d=g.getOrientation(d);switch(d){case 0:j=f.getNextLevelTreeItem(b,!1);break;case 1:j=f.getNextLevelTreeItem(b,!0);break;case 2:j=f.getNextTreeItem(b,!0);break;case 3:j=f.getNextTreeItem(b,!1)}null!=j&&(a.preventDefault(),c.hasHighlightEnabled()?
m(a,j):e.hasCursorEnabled()&&t(a,j))}h.scrollPanel.focus()}}});p.tasks=c(g,h,i);p.graphics=primitives.common.createGraphics(p.options.graphicsType,p.layout.element);p.graphics.debug=u;p.options.actualGraphicsType=p.graphics.graphicsType;f(!0,u)}}function f(a,b){var c;p.layout.forceCenterOnCursor=a;p.tasks.process(b);p.graphics.end();a&&(c=p.tasks.getTask("CenterOnCursorTask"),c=c.getPlaceholderOffset(),p.layout.scrollPanel.scrollLeft(c.x),p.layout.scrollPanel.scrollTop(c.y))}function g(){return p.options}
function h(){return p.graphics}function i(){return p.layout}function j(a){null!=a.mousePanel&&(a.mousePanel.unbind("mousemove"),a.mousePanel.unbind("click"),a.mousePanel.unbind("dblclick"));null!=a.scrollPanel&&a.scrollPanel.unbind("keydown")}function k(a){var b=new primitives.common.Point(a.pageX,a.pageY),a=-b.x+r.x,b=-b.y+r.y,c=p.layout.scrollPanel;c.css("visibility","hidden");c.scrollLeft(a).scrollTop(b);c.css("visibility","inherit");return!1}function l(){s=!0}function n(a){var b=p.layout.scrollPanel;
r=new primitives.common.Point(b.scrollLeft()+a.pageX,b.scrollTop()+a.pageY);return!0}function m(a,b){var c=!0,e;null!==b?b.id!==p.options.highlightItem&&(e=d(p,p.options.highlightItem,b.id,void 0),q("onHighlightChanging",a,e),p.options.highlightItem=b.id,e.cancel?c=!1:(f(!1,!1),q("onHighlightChanged",a,e))):null!==p.options.highlightItem&&(e=d(p,p.options.highlightItem,null,void 0),q("onHighlightChanging",a,e),p.options.highlightItem=null,e.cancel?c=!1:(f(!1,!1),q("onHighlightChanged",a,e)));return c}
function t(a,b){var c;b!==p.options.cursorItem&&(c=d(p,p.options.cursorItem,b,void 0),q("onCursorChanging",a,c),p.options.cursorItem=b,c.cancel||(f(!0,u),q("onCursorChanged",a,c)))}function q(a,b,c){a=p.options[a];null!=a&&a(b,c)}var p={name:"orgdiagram",options:b,tasks:null,graphics:null,mouse:null,layout:{element:a,scrollPanel:null,mousePanel:null,placeholder:null,calloutPlaceholder:null,forceCenterOnCursor:!0}},r,s,u=!1;e();return{destroy:function(){j(p.layout);p.layout.element.find("."+p.name).remove();
p.tasks=null;p.graphics=null},setOptions:function(a){for(var b in a)a.hasOwnProperty(b)&&(p.options[b]=a[b])},getOptions:g,setOption:function(a,b){return p.options[a]=b},getOption:function(a){return p.options[a]},update:e,getProcessDiagramConfig:function(){return c(g,h,i).getProcessDiagramConfig()}}};
primitives.orgdiagram.Control=function(a,b){return primitives.orgdiagram.BaseControl(a,b,function(a,b,e){var f=new primitives.common.TaskManager;f.addDependency("options",a);f.addDependency("graphics",b);f.addDependency("layout",e);f.addDependency("defaultConfig",new primitives.orgdiagram.Config);f.addDependency("defaultItemConfig",new primitives.orgdiagram.ItemConfig);f.addDependency("defaultTemplateConfig",new primitives.orgdiagram.TemplateConfig);f.addDependency("defaultButtonConfig",new primitives.orgdiagram.ButtonConfig);
f.addDependency("defaultBackgroundAnnotationConfig",new primitives.orgdiagram.BackgroundAnnotationConfig);f.addDependency("defaultConnectorAnnotationConfig",new primitives.orgdiagram.ConnectorAnnotationConfig);f.addDependency("defaultHighlightPathAnnotationConfig",new primitives.orgdiagram.HighlightPathAnnotationConfig);f.addDependency("defaultShapeAnnotationConfig",new primitives.orgdiagram.ShapeAnnotationConfig);f.addDependency("isFamilyChartMode",!1);f.addDependency("showElbowDots",!1);f.addDependency("null",
null);f.addTask("OptionsTask",["options"],primitives.orgdiagram.OptionsTask,"#000000");f.addTask("CurrentControlSizeTask",["layout","OptionsTask","ItemsSizesOptionTask"],primitives.orgdiagram.CurrentControlSizeTask,"#000000");f.addTask("CurrentScrollPositionTask",["layout","OptionsTask"],primitives.orgdiagram.CurrentScrollPositionTask,"#000000");f.addTask("CalloutOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],primitives.orgdiagram.CalloutOptionTask,"#000080");f.addTask("ConnectorsOptionTask",
["OptionsTask","defaultConfig"],primitives.orgdiagram.ConnectorsOptionTask,"#000080");f.addTask("ItemsOptionTask",["OptionsTask","defaultItemConfig"],primitives.orgdiagram.ItemsOptionTask,"#000080");f.addTask("ItemsSizesOptionTask",["OptionsTask","defaultConfig","defaultItemConfig","defaultButtonConfig"],primitives.orgdiagram.ItemsSizesOptionTask,"#000080");f.addTask("LabelsOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],primitives.orgdiagram.LabelsOptionTask,"#000080");f.addTask("PrintPreviewOptionTask",
["OptionsTask","defaultConfig"],primitives.orgdiagram.PrintPreviewOptionTask,"#000080");f.addTask("TemplatesOptionTask",["OptionsTask","defaultConfig","defaultButtonConfig","defaultTemplateConfig"],primitives.orgdiagram.TemplatesOptionTask,"#000080");f.addTask("OrientationOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.OrientationOptionTask,"#000080");f.addTask("VisualTreeOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.VisualTreeOptionTask,"#000080");f.addTask("MinimizedItemsOptionTask",
["OptionsTask"],primitives.orgdiagram.MinimizedItemsOptionTask,"#000080");f.addTask("CursorItemOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.CursorItemOptionTask,"#000080");f.addTask("HighlightItemOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.HighlightItemOptionTask,"#000080");f.addTask("SelectedItemsOptionTask",["OptionsTask"],primitives.orgdiagram.SelectedItemsOptionTask,"#000080");f.addTask("CursorSelectionPathModeOptionTask",["OptionsTask","defaultConfig"],
primitives.orgdiagram.CursorSelectionPathModeOptionTask,"#000080");f.addTask("SplitAnnotationsOptionTask",["OptionsTask"],primitives.orgdiagram.SplitAnnotationsOptionTask,"#00ffff");f.addTask("ShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig"],primitives.orgdiagram.ShapeAnnotationOptionTask,"#000080");f.addTask("HighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConfig","defaultHighlightPathAnnotationConfig"],primitives.orgdiagram.HighlightPathAnnotationOptionTask,
"#000080");f.addTask("ConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig"],primitives.orgdiagram.ConnectorAnnotationOptionTask,"#000080");f.addTask("BackgroundAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultBackgroundAnnotationConfig"],primitives.orgdiagram.BackgroundAnnotationOptionTask,"#000080");f.addTask("ScaleOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.ScaleOptionTask,"#000080");f.addTask("CombinedContextsTask",["ItemsOptionTask"],
primitives.orgdiagram.CombinedContextsTask,"#00ffff");f.addTask("IntervalsTask",["ItemsSizesOptionTask"],primitives.orgdiagram.IntervalsTask,"#00ffff");f.addTask("OrgTreeTask",["ItemsOptionTask"],primitives.orgdiagram.OrgTreeTask,"#ff0000");f.addTask("ReadTemplatesTask",["TemplatesOptionTask"],primitives.orgdiagram.ReadTemplatesTask,"#00ffff");f.addTask("ItemTemplateParamsTask",["ItemsSizesOptionTask","CursorItemOptionTask","ReadTemplatesTask"],primitives.orgdiagram.ItemTemplateParamsTask,"#00ffff");
f.addTask("GroupTitleTemplateTask",["TemplatesOptionTask"],primitives.orgdiagram.GroupTitleTemplateTask,"#00ffff");f.addTask("CheckBoxTemplateTask",["ItemsSizesOptionTask"],primitives.orgdiagram.CheckBoxTemplateTask,"#00ffff");f.addTask("ButtonsTemplateTask",["ItemsSizesOptionTask"],primitives.orgdiagram.ButtonsTemplateTask,"#00ffff");f.addTask("VisualTreeTask",["OrgTreeTask","ItemTemplateParamsTask","VisualTreeOptionTask","isFamilyChartMode"],primitives.orgdiagram.VisualTreeTask,"#ff0000");f.addTask("VisualTreeLevelsTask",
["VisualTreeTask","ItemTemplateParamsTask"],primitives.orgdiagram.VisualTreeLevelsTask,"#ff0000");f.addTask("VisualTreeMarginsTask",["VisualTreeTask"],primitives.orgdiagram.VisualTreeMarginsTask,"#ff0000");f.addTask("ExtraPartnersTask",["VisualTreeTask"],primitives.orgdiagram.DummyExtraPartnersTask,"#00ffff");f.addTask("ConnectionsGraphTask",["VisualTreeTask","VisualTreeLevelsTask","ExtraPartnersTask"],primitives.orgdiagram.ConnectionsGraphTask,"#00ffff");f.addTask("TracePathAnnotationsTask",["HighlightPathAnnotationOptionTask",
"ConnectionsGraphTask","OrgTreeTask","VisualTreeTask","VisualTreeTask"],primitives.orgdiagram.TracePathAnnotationsTask,"#00ffff");f.addTask("HighlightItemTask",["HighlightItemOptionTask","OrgTreeTask"],primitives.orgdiagram.HighlightItemTask,"#00ffff");f.addTask("CursorItemTask",["CursorItemOptionTask","OrgTreeTask"],primitives.orgdiagram.CursorItemTask,"#00ffff");f.addTask("CursorNeighboursTask",["CursorItemTask","VisualTreeTask"],primitives.orgdiagram.CursorNeighboursTask,"#00ffff");f.addTask("SelectedItemsTask",
["SelectedItemsOptionTask"],primitives.orgdiagram.SelectedItemsTask,"#00ffff");f.addTask("SelectionPathItemsTask",["VisualTreeTask","CursorItemTask","SelectedItemsTask","CursorSelectionPathModeOptionTask"],primitives.orgdiagram.SelectionPathItemsTask,"#00ffff");f.addTask("NormalVisibilityItemsByShapeAnnotationTask",["ShapeAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");f.addTask("NormalVisibilityItemsByBackgroundAnnotationTask",["BackgroundAnnotationOptionTask"],
primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");f.addTask("NormalVisibilityItemsByHighlightPathAnnotationTask",["HighlightPathAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");f.addTask("NormalVisibilityItemsByConnectorAnnotationTask",["ConnectorAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByConnectorAnnotationTask,"#00ffff");f.addTask("CombinedNormalVisibilityItemsTask","ItemsSizesOptionTask CursorItemTask CursorNeighboursTask SelectedItemsTask SelectionPathItemsTask NormalVisibilityItemsByShapeAnnotationTask NormalVisibilityItemsByBackgroundAnnotationTask NormalVisibilityItemsByHighlightPathAnnotationTask NormalVisibilityItemsByConnectorAnnotationTask".split(" "),
primitives.orgdiagram.CombinedNormalVisibilityItemsTask,"#00ffff");f.addTask("ItemsPositionsTask","CurrentControlSizeTask ScaleOptionTask OrientationOptionTask ItemsSizesOptionTask ConnectorsOptionTask VisualTreeOptionTask ExtraPartnersTask IntervalsTask VisualTreeTask VisualTreeLevelsTask VisualTreeMarginsTask ItemTemplateParamsTask CursorItemTask CombinedNormalVisibilityItemsTask".split(" "),primitives.orgdiagram.ItemsPositionsTask,"#ff0000");f.addTask("AlignDiagramTask","OrientationOptionTask ItemsSizesOptionTask VisualTreeOptionTask ScaleOptionTask PrintPreviewOptionTask CurrentControlSizeTask VisualTreeTask VisualTreeLevelsTask ItemsPositionsTask isFamilyChartMode".split(" "),
primitives.orgdiagram.AlignDiagramTask,"#ff0000");f.addTask("CreateTransformTask",["OrientationOptionTask","AlignDiagramTask"],primitives.orgdiagram.CreateTransformTask,"#00ffff");f.addTask("CenterOnCursorTask","layout CurrentControlSizeTask CurrentScrollPositionTask CursorItemTask AlignDiagramTask CreateTransformTask ScaleOptionTask".split(" "),primitives.orgdiagram.CenterOnCursorTask,"#00ffff");f.addTask("BackgroundAnnotationManagerTask",["ItemsSizesOptionTask","OrgTreeTask","VisualTreeLevelsTask",
"AlignDiagramTask"],primitives.orgdiagram.BackgroundAnnotationManagerTask,"#00ffff");f.addTask("PaletteManagerTask",["ConnectorsOptionTask","null"],primitives.orgdiagram.PaletteManagerTask,"#00ffff");f.addTask("ApplyLayoutChangesTask","graphics layout ItemsSizesOptionTask PrintPreviewOptionTask CurrentControlSizeTask ScaleOptionTask AlignDiagramTask".split(" "),primitives.orgdiagram.ApplyLayoutChangesTask,"#008000");f.addTask("DrawBackgroundAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask BackgroundAnnotationOptionTask VisualTreeTask AlignDiagramTask BackgroundAnnotationManagerTask".split(" "),
primitives.orgdiagram.DrawBackgroundAnnotationTask,"#008000");f.addTask("DrawConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ConnectorAnnotationOptionTask AlignDiagramTask".split(" "),primitives.orgdiagram.DrawConnectorAnnotationTask,"#008000");f.addTask("DrawShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ShapeAnnotationOptionTask AlignDiagramTask".split(" "),primitives.orgdiagram.DrawShapeAnnotationTask,
"#008000");f.addTask("DrawCursorTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask ItemTemplateParamsTask CursorItemTask SelectedItemsTask".split(" "),primitives.orgdiagram.DrawCursorTask,"#008000");f.addTask("DrawHighlightTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask ItemTemplateParamsTask HighlightItemTask CursorItemTask SelectedItemsTask".split(" "),primitives.orgdiagram.DrawHighlightTask,"#008000");
f.addTask("DrawHighlightAnnotationTask","layout graphics CreateTransformTask ApplyLayoutChangesTask ScaleOptionTask CombinedContextsTask CalloutOptionTask ReadTemplatesTask AlignDiagramTask CenterOnCursorTask HighlightItemTask CursorItemTask SelectedItemsTask".split(" "),primitives.orgdiagram.DrawHighlightAnnotationTask,"#008000");f.addTask("DrawTreeItemsTask","graphics CreateTransformTask ApplyLayoutChangesTask ItemsSizesOptionTask CombinedContextsTask VisualTreeTask AlignDiagramTask ItemTemplateParamsTask CursorItemTask SelectedItemsTask GroupTitleTemplateTask CheckBoxTemplateTask ButtonsTemplateTask".split(" "),
primitives.orgdiagram.DrawTreeItemsTask,"#008000");f.addTask("DrawMinimizedItemsTask","graphics CreateTransformTask ApplyLayoutChangesTask MinimizedItemsOptionTask VisualTreeTask ItemTemplateParamsTask AlignDiagramTask".split(" "),primitives.orgdiagram.DrawMinimizedItemsTask,"#008000");f.addTask("DrawConnectorsTask","graphics CreateTransformTask ApplyLayoutChangesTask ConnectorsOptionTask VisualTreeTask VisualTreeLevelsTask AlignDiagramTask TracePathAnnotationsTask ExtraPartnersTask showElbowDots PaletteManagerTask".split(" "),
primitives.orgdiagram.DrawConnectorsTask,"#008000");f.addTask("DrawItemLabelsTask","graphics CreateTransformTask ApplyLayoutChangesTask LabelsOptionTask VisualTreeLevelsTask AlignDiagramTask".split(" "),primitives.orgdiagram.DrawItemLabelsTask,"#008000");f.addTask("DrawPrintPreviewTask",["graphics","ApplyLayoutChangesTask","PrintPreviewOptionTask","AlignDiagramTask","ScaleOptionTask"],primitives.orgdiagram.DrawPrintPreviewTask,"#008000");return f},function(a,b,e,f){var g=new primitives.orgdiagram.EventArgs,
h=a.tasks.getTask("CombinedContextsTask"),i=a.tasks.getTask("AlignDiagramTask"),b=h.getConfig(b),j=h.getConfig(e);b&&null!=b.id&&(g.oldContext=b);j&&null!=j.id&&(g.context=j,null!==j.parent&&(g.parentItem=h.getConfig(j.parent)),h=a.layout.mousePanel.offset(),a=a.layout.element.offset(),g.position=(new primitives.common.Rect(i.getItemPosition(e))).translate(h.left,h.top).translate(-a.left,-a.top));null!=f&&(g.name=f);return g})};
primitives.common.StackSegment=function(a,b,c){this.context=a;this.startIndex=b;this.endIndex=c};primitives.common.StackSegment.prototype.toString=function(){return"["+Math.round(this.startIndex)+" - "+Math.round(this.endIndex)+"]"};primitives.common.perimeter.Item=function(a,b){var c,d,e;this.id=a;this.segments=new primitives.common.LinkedHashItems;if(null!=b){c=0;for(d=b.length;c<d;c+=1)e=b[c],this.segments.add(e.key,e)}};
primitives.common.perimeter.Manager=function(a){function b(a){var b,g,h;b=0;for(g=a.length;b<g;b+=1)h=a[b],c[h.id]=h,h.segments.iterate(function(a){d[a.key]=h})}var c={},d={};null!=a&&b(a);return{add:b,getMergedPerimeters:function(a){var b=[],g={},h,i,j,k,l,n;h=0;for(i=a.length;h<i;h+=1)j=a[h],g[j]=!c.hasOwnProperty(j);h=0;for(i=a.length;h<i;h+=1)if(j=a[h],!g[j]){g[j]=!0;k=new primitives.common.perimeter.Item(j);j=c[j];j.segments.iterate(function(a){k.segments.add(a.key,a)});b.push(k);for(l=k.segments.startKey();null!=
l;){n=k.segments.item(l);d.hasOwnProperty(n.oppositeKey)&&(j=d[n.oppositeKey],g.hasOwnProperty(j.id)&&!g[j.id]&&(g[j.id]=!0,j.segments.iterateBack(function(a){a.key!=n.oppositeKey&&k.segments.insertAfter(l,a.key,a)},n.oppositeKey,null),j.segments.iterateBack(function(a){k.segments.insertAfter(l,a.key,a)},null,n.oppositeKey)));j=k.segments;for(var m=n,t=j.nextKey(m.key),q=void 0;null!=m&&m.oppositeKey==(q=t||j.startKey());)null!=t&&(t=j.nextKey(t)),j.remove(m.key),j.remove(q),m=j.item(null!=t?j.prevKey(t):
j.endKey());l=t}}return b}}};
primitives.common.perimeter.SegmentItem=function(a,b,c,d){this.toPoint=this.fromPoint=null;switch(arguments.length){case 2:this.fromPoint=a;this.toPoint=b;break;case 4:this.fromPoint=new primitives.common.Point(a,b),this.toPoint=new primitives.common.Point(c,d)}var e=this.fromPoint.toString(),f=this.toPoint.toString();if(e==f)throw"Null length segment!";this.key=e+" - "+f;this.oppositeKey=f+" - "+e;this.orientationType=null;this.orientationType=this.fromPoint.y>this.toPoint.y?3:this.fromPoint.y<this.toPoint.y?
2:this.fromPoint.x>this.toPoint.x?0:1};
primitives.common.mergeSort=function(a,b,c){var d=null,e,f,g,h,i,j,k,l,n,m,t,q;switch(a.length){case 0:d=[];break;default:d=[];for(g=0;g<a.length;g+=1){e=a[g];f=[];j=d.length;k=e.length;i=h=0;t=n=m=l=null;0<j&&(l=d[h],m=!b?l:b(l));0<k&&(n=e[i],t=!b?n:b(n));for(q=null;h<j||i<k;)if(h>=j){if(!c||q!=n)f.push(n),q=n;i+=1;i<k&&(n=e[i],t=!b?n:b(n))}else if(i>=k){if(!c||q!=l)f.push(l),q=l;h+=1;h<j&&(l=d[h],m=!b?l:b(l))}else if(m<t){if(!c||q!=l)f.push(l),q=l;h+=1;h<j&&(l=d[h],m=!b?l:b(l))}else{if(!c||q!=n)f.push(n),
q=n;i+=1;i<k&&(n=e[i],t=!b?n:b(n))}d=f}}return d};
primitives.common.stackSegments=function(a,b){var c=0,d,e,f,g,h,i,j,k=[],l,n,m,t,q,p,r={};a.sort(function(a,b){return a.endIndex-a.startIndex-(b.endIndex-b.startIndex)});g=0;for(h=a.length;g<h;g+=1){f=a[g];e=d=0;m=f.startIndex;r[m]=d+1;t=f.endIndex;r[t]=e;j=k.length;if(0<j){l=[];p=q=!1;for(i=0;i<j;i+=1)n=k[i],n<m?(l.push(n),d=r[n],e=r[n]):n<t?(q||(l.push(m),q=!0),d=Math.max(d,r[n]),e=r[n]):(q||(l.push(m),q=!0),p||(l.push(t),p=!0,r[m]=d+1,r[t]=e),l.push(n));q||(l.push(m),q=!0);p||(l.push(t),p=!0,r[m]=
d+1,r[t]=e);k=l}else k=[m,t];b(f,r[m]);c=Math.max(c,r[m])}return c};primitives.common.binarySearch=function(a,b){var c=null,d,e,f=0,g=a.length-1,h,i;if(0<a.length&&(c=a[f],d=b(c),0<d))if(e=Math.abs(d),i=a[g],d=b(i),0<=d)c=i;else{d=Math.abs(d);e>d&&(e=d,c=i);for(;f+1<g;)if(h=Math.round((f+g)/2),i=a[h],d=b(i),0===d){c=i;break}else 0<d?f=h:g=h,d=Math.abs(d),e>d&&(e=d,c=i)}return c};
primitives.common.family=function(a){function b(a,b,c,d){var e;if(null!=d&&(b=b[c],null!=b))for(e in b)if(b.hasOwnProperty(e)&&d.call(a,e))break}function c(a,b){var c=!1;null!=r[a]&&null!=r[a][b]&&(delete r[a][b],s[a]-=1,delete u[b][a],v[b]-=1,s[a]||(delete r[a],delete s[a]),u[b]||(delete u[b],delete v[b],null==q[null]&&(q[null]={},p[null]=0),q[null][b]=!0,p[null]+=1),c=!0);return c}function d(a,b){var c;if(null!=b)for(c in y)if(y.hasOwnProperty(c)&&b.call(a,c,y[c]))break}function e(a,c,d,e){for(var f,
g,j={},k=0,h=!0;h;){f={};h=!1;for(g in d)if(d.hasOwnProperty(g)&&!j[g])switch(j[g]=!0,e.call(a,g,y[g],k)){case A:f={};h=!1;break;case w:break;default:b(this,c,g,function(a){j[a]||(h=f[a]=!0)})}d=f;k+=1}}function f(a,b,c){null!=c&&null!=b&&(null!=y[b]&&null!=r[b])&&e(a,r,r[b],c)}function g(a,b,c){null!=c&&null!=b&&(null!=y[b]&&null!=u[b])&&e(a,u,u[b],c)}function h(a,c,d,e,f,g){var j,k,h,i;if(null!=g){c=[];k={};for(j in y)y.hasOwnProperty(j)&&(k[j]=d[j]||0,k[j]||c.push(j));for(i=0;0<c.length;){h=[];
d=0;for(f=c.length;d<f;d+=1){j=c[d];if(g.call(a,j,y[j],i)){h=[];break}i+=1;b(this,e,j,function(a){k[a]-=1;0===k[a]&&h.push(a)})}c=h}}}function i(a,b){h(a,u,v,r,s,b)}function j(a,b){h(a,r,s,u,v,b)}function k(a,b,c,d,e,f,g,j,k){var h=!1,i,l;if(null!=y[a]&&null!=g[a]){h=!0;if(k){k=0;for(i=b.length;k<i;k+=1)if(l=b[k],null==y[l]||null==g[a][l])h=!1}if(h&&(null!=d&&(y[c]=d),null!=y[c])){e[c]||(e[c]={},f[c]=0);g[c]||(g[c]={},j[c]=0);e[c][a]||(e[c][a]=!0,f[c]+=1);g[a][c]||(g[a][c]=!0,j[a]+=1);k=0;for(i=b.length;k<
i;k+=1)l=b[k],c!=l&&(null!=g[a][l]&&(delete g[a][l],j[a]-=1),null!=e[l][a]&&(delete e[l][a],f[l]-=1),e[l][c]||(e[l][c]=!0,f[l]+=1),g[c][l]||(g[c][l]=!0,j[c]+=1))}}return h}function l(a,b,c,d){return k(a,b,c,d,u,v,r,s,!0)}function n(){this.key=this.id="";this.children=[];this.childrenHash={};this.processed=!1}function m(a){this.items=[];this.difference=this.weight=0;0<arguments.length&&(this.difference=a)}function t(a){var c=primitives.common.graph(),d,e,f,g,j,k,h,i,l={};for(d in a)a.hasOwnProperty(d)&&
b(this,r,d,function(d){if(!l.hasOwnProperty(d)){l[d]=!0;e=[];b(this,u,d,function(a){e.push(a)});f=0;for(j=e.length;f<j-1;f+=1)if(k=e[f],a.hasOwnProperty(k))for(g=f+1;g<j;g+=1)if(h=e[g],a.hasOwnProperty(h)){i=Math.abs(a[k].children.length-a[h].children.length);var n=c.edge(k,h);null==n&&(n=new m(i),c.addEdge(k,h,n));n.items.push(d);n.weight+=1}}});return c}var q={},p={},r={},s={},u={},v={},y={},A=1,w=2;primitives.common.isObject(a)&&(q=primitives.common.cloneObject(a.roots,!1),p=primitives.common.cloneObject(a.rootsCount,
!0),r=primitives.common.cloneObject(a.children,!1),s=primitives.common.cloneObject(a.childrenCount,!0),u=primitives.common.cloneObject(a.parents,!1),v=primitives.common.cloneObject(a.parentsCount,!0),y=primitives.common.cloneObject(a.nodes,!0));return{add:function(a,c,d){var e,f,g={};if(!a||0===a.length)a=[null];if(null==y[c]&&null!=d){y[c]=d;d=0;for(e=a.length;d<e;d+=1)f=a[d],null==g[f]&&f!=c&&(g[f]=!0,null!=y[f]?(null==u[c]&&(u[c]={},v[c]=0),u[c][f]||(u[c][f]=!0,v[c]+=1),null==r[f]&&(r[f]={},s[f]=
0),r[f][c]||(r[f][c]=!0,s[f]+=1)):(null==q[f]&&(q[f]={},p[f]=0),q[f][c]||(q[f][c]=!0,p[f]+=1)));null!=q[c]&&(r[c]=q[c],s[c]=p[c],delete q[c],delete p[c],b(this,r,c,function(a){null==u[a]&&(u[a]={},v[a]=0);u[a][c]||(u[a][c]=!0,v[a]+=1)}))}},adopt:function(a,b){var c,d,e;if(null!=y[b]){c=0;for(d=a.length;c<d;c+=1)if(e=a[c],null==u[b]&&(u[b]={},v[b]=0),e!=b&&null!=y[e])u[b][e]||(u[b][e]=!0,v[b]+=1),null==r[e]&&(r[e]={},s[e]=0),r[e][b]||(r[e][b]=!0,s[e]+=1);else throw"Item cannot be parent of itself and parent should exist in the structure!";
}else throw"Child should be in hierarchy!";},bundleChildren:l,bundleParents:function(a,b,c,d){return k(a,b,c,d,r,s,u,v,!0)},optimizeReferences:function(a){var c={},d={},e={},g,j,h,i,l,m;if(null!=a){for(g in y)y.hasOwnProperty(g)&&(j=new n,b(this,r,g,function(a){j.children.push(a);j.childrenHash[a]=!0}),j.children.sort(),j.id=g,j.key=j.children.join(","),e[j.id]=j);for(;!primitives.common.isEmptyObject(e);){h={};i=t(e);for(g in e)e.hasOwnProperty(g)&&(l=e[g],l.processed||(m=i.getSpanningTree(g,function(a,
b){return a.weight>b.weight?1:a.weight==b.weight?b.difference-a.difference:-1}),m.loopLevels(this,function(b,g){e[b].processed=!0;m.loopChildren(this,b,function(j,l){var m=i.edge(b,j),p=null,q,t,x,C,G;e[j].processed=!0;if(1<m.weight){t=m.items.join(",");if(c.hasOwnProperty(t))p=c[t];else{q=a();y[q.id]=q;p=new n;p.id=q.id;p.key=t;t=0;for(x=m.items.length;t<x;t+=1)p.children.push(m.items[t]),p.childrenHash[m.items[t]]=!0;p.children.sort();c[p.key]=p;d[p.id]=p;h[p.id]=p;C=p.children.slice(0);f(this,
g.replacementItem||b,function(a){null!=d[a]&&!p.childrenHash[a]&&(G=!0,f(this,a,function(a){return!p.childrenHash[a]?(G=!1,A):w}),G&&C.push(a));return w});k(g.replacementItem||b,C,p.id,q,u,v,r,s,!1);if(1>=(s[b]||0))g.replacementItem=p.id}if(p.id!=j&&(C=p.children.slice(0),f(this,l.replacementItem||j,function(a){null!=d[a]&&!p.childrenHash[a]&&(G=!0,f(this,a,function(a){return!p.childrenHash[a]?(G=!1,A):w}),G&&C.push(a));return w}),k(l.replacementItem||j,C,p.id,null,u,v,r,s,!1),1>=(s[j]||0)))l.replacementItem=
p.id}})})));e=h}}},eliminateManyToMany:function(a){var c,d;for(c in r)r.hasOwnProperty(c)&&1<(s[c]||0)&&b(this,r,c,function(b){if(1<(v[b]||0))d=a(),l(c,[b],d.id,d)})},removeNode:function(a){null!=y[a]&&(b(this,r,a,function(b){delete u[b][a];v[b]-=1;v[b]||(delete u[b],delete v[b],null==q[null]&&(q[null]={},p[null]=0),q[null][b]||(q[null][b]=!0,p[null]+=1))}),b(this,u,a,function(b){delete r[b][a];s[b]-=1;s[b]||(delete r[b],delete s[b])}),null!=q[null]&&null!=q[null][a]&&(delete q[null][a],p[null]-=
1,p[null]||(delete q[null],delete p[null])),delete r[a],delete s[a],delete u[a],delete v[a],delete y[a])},removeRelation:function(a,b){var d=!1;null!=y[a]&&null!=y[b]&&(d=c(a,b)||c(b,a));return d},node:function(a){return y[a]},loop:d,loopLevels:function(a,c,d){function e(){this.items={};this.minimumLevel=null}function f(a,b,c){var d=m[b];d||(d=new e,m[b]=d);d.addItemToLevel(a,c);w=null==w?c:Math.min(w,c);n[a]=c;h[a]=!0}var g=[],k={},h={},l=[],n={},m={},p,t,q,s,v,w=null;q=c?i:j;var A,V,N,T,O,S,H,X;
e.prototype.addItemToLevel=function(a,b){var c=this.items[b];c?c.push(a):(c=[a],this.items[b]=c);this.minimumLevel=null==this.minimumLevel?b:Math.min(this.minimumLevel,b)};if(null!=d){q(this,function(a,b,c){g.push(a);k[a]=c});q=0;for(A=g.length;q<A;q+=1)if(p=g[q],null==h[p]){l.push(p);for(f(p,q,0);0<l.length;){O=T=N=null;S=!c;H=[];p=0;for(s=l.length;p<s;p+=1)v=l[p],V=n[v],X=!1,c?(b(this,u,v,function(a){var b;if(!h[a]&&(X=!0,b=k[a],null==N||!S||N<b||N==b&&O>V-1))N=b,T=a,O=V-1,S=!0}),b(this,r,v,function(a){var b;
if(!h[a]&&(X=!0,b=k[a],null==N||!S&&(N>b||N==b&&O<V+1)))N=b,T=a,O=V+1,S=!1})):(b(this,r,v,function(a){var b;if(!h[a]&&(X=!0,b=k[a],null==N||S||N<b||N==b&&O<V+1))N=b,T=a,O=V+1,S=!1}),b(this,u,v,function(a){var b;if(!h[a]&&(X=!0,b=k[a],null==N||S&&(N>b||N==b&&O>V-1)))N=b,T=a,O=V-1,S=!0})),X&&H.push(v);null!=T&&(H.push(T),f(T,q,O));l=H}}l=!0;for(c=w;l;){p={};l=!1;for(t in m)if(m.hasOwnProperty(t)&&(q=m[t],s=q.items[q.minimumLevel-w+c],null!=s)){p[t]=q;l=!0;q=0;for(A=s.length;q<A;q+=1)if(v=s[q],d.call(a,
v,y[v],c-w))return l=!1,!0}m=p;c+=1}}},loopTopo:i,loopTopoReversed:j,loopChildren:f,loopParents:g,findLargestRoot:function(){var a=null,b,c={},d={},e;b=null;j(this,function(f,j){c.hasOwnProperty(f)||(c[f]={},d[f]=0);c[f][f]=!0;d[f]+=1;e=!0;g(this,j.id,function(a){var b,g;e=!1;c.hasOwnProperty(a)||(c[a]={},d[a]=0);if(!d[a]&&1==v[f])c[a]=c[f],d[a]=d[f];else for(g in b=c[f],b)b.hasOwnProperty(g)&&(c[a][g]=!0,d[a]+=1);return w});if(e&&(!b||d[f]>b))b=d[f],a=f});return a},loopRoots:function(a,b){var c=
null,d,e=0,f={},k={},h,i={},l={},n,m,p,q,t,r,s;j(this,function(a,b){f.hasOwnProperty(a)||(f[a]={},k[a]=0);f[a][a]=!0;k[a]+=1;h=!0;g(this,b.id,function(b){var c,d;h=!1;f.hasOwnProperty(b)||(f[b]={},k[b]=0);if(!k[b]&&1==v[a])f[b]=f[a],k[b]=k[a];else for(d in c=f[a],c)c.hasOwnProperty(d)&&!f[b][d]&&(f[b][d]=!0,k[b]+=1);return w});h&&(i[a]=!0,e+=1)});q={};for(p in i)if(i.hasOwnProperty(p))for(m in d=f[p],d)d.hasOwnProperty(m)&&(q[m]||(q[m]=[]),q[m].push(p.toString()));for(;0<e;){d=null;for(n in i)if(i.hasOwnProperty(n)&&
(!d||k[n]<d))d=k[n],c=n;if(null!=c){null!=b&&b.call(a,c,y[c]);d=f[c];for(m in d)if(d.hasOwnProperty(m)&&!l[m]){p=q[m];r=0;for(s=p.length;r<s;r+=1)t=p[r],k[t]-=1;l[m]=!0}delete i[c];e-=1}}},hasNodes:function(){return!primitives.common.isEmptyObject(y)},hasCommonChild:function(a){var c=!1,d,e,f,g,j,k,h;d={};g=f=0;for(j=a.length;g<j;g+=1)k=a[g],null!=y[k]&&!d[k]&&(d[k]=!0,f+=1);e={};for(k in d)d.hasOwnProperty(k)&&b(this,r,k,function(a){e[a]=e[a]?e[a]+1:1});for(h in e)if(e.hasOwnProperty(h)&&null!=u[h]&&
(v[h]||0)==e[h]&&e[h]==f){c=!0;break}return c},loopNeighbours:function(a,b,c){var d={};null!=c&&(f(this,b,function(b,e){d.hasOwnProperty(b)||(d[b]=null,c.call(a,b,e,1)&&(d[b]=w,g(this,b,function(b,e){d.hasOwnProperty(b)||(d[b]=null,c.call(a,b,e,2)&&(d[b]=w));return d[b]})));return d[b]}),g(this,b,function(b,e){d.hasOwnProperty(b)||(d[b]=null,c.call(a,b,e,1)&&(d[b]=w,f(this,b,function(b,e){d.hasOwnProperty(b)||(d[b]=!0,c.call(a,b,e,2)&&(d[b]=w));return d[b]})));return d[b]}))},countChildren:function(a){return s[a]||
0},countParents:function(a){return v[a]||0},firstParent:function(a){var b=null,a=u[a]||{};for(b in a)if(a.hasOwnProperty(b))return b;return null},firstChild:function(a){var b=null,a=r[a]||{};for(b in a)if(a.hasOwnProperty(b))return b;return null},validate:function(a){function c(a){var b=0,d;if(null!=a)for(d in a)a.hasOwnProperty(d)&&(b+=1);return b}var e,f;d(this,function(c){b(this,r,c,function(b){if(!u.hasOwnProperty(b)||!u[b].hasOwnProperty(c))return null!=a&&(a.message="Child #"+b+" does not reference parent #"+
c),!1});b(this,u,c,function(b){if(!r.hasOwnProperty(b)||!r[b].hasOwnProperty(c))return null!=a&&(a.message="Parent #"+b+" does not reference child #"+c),!1})});for(e in u)if(u.hasOwnProperty(e)){if((v[e]||0)!=c(u[e]))return null!=a&&(a.message="Parents count for item #"+e+" missmatch."),!1;if(u.hasOwnProperty(e)&&!y.hasOwnProperty(e))return null!=a&&(a.message="Orphant parents for item #"+e),!1}for(f in r)if(r.hasOwnProperty(f)){if((s[f]||0)!=c(r[f]))return null!=a&&(a.message="Children count for item "+
f+" missmatch."),!1;if(r.hasOwnProperty(f)&&!y.hasOwnProperty(f))return null!=a&&(a.message="Orphant children of item "+f),!1}for(f in q)if(q.hasOwnProperty(f)){if((p[f]||0)!=c(q[f]))return null!=a&&(a.message="Root children count for item @"+f+" missmatch."),!1;b(this,q,f,function(b){if(!y.hasOwnProperty(b))return null!=a&&(a.message="Child #"+b+"of root #"+f+" does not exists."),!1})}return!0},clone:function(){return primitives.common.family({roots:q,rootsCount:p,children:r,childrenCount:s,parents:u,
parentsCount:v,nodes:y})},BREAK:A,SKIP:w}};
primitives.common.graph=function(){var a={};return{addEdge:function(b,c,d){if((null==a[b]||null==a[b][c])&&null!=d)null==a[b]&&(a[b]={}),a[b][c]=d,null==a[c]&&(a[c]={}),a[c][b]=d},edge:function(b,c){var d=null;null!=a[b]&&a[b][c]&&(d=a[b][c]);return d},getSpanningTree:function(b,c){var d=primitives.common.tree(),e={},f,g=[],h,i={},j,k,l,n,m,t,q;e[b]=!0;j=1;i[b]=null;for(d.add(null,b.toString(),{});0<j;){g=[];n=l=k=null;for(f in e)if(e.hasOwnProperty(f)){m=a[f];h=!1;for(t in m)if(m.hasOwnProperty(t)&&
!i.hasOwnProperty(t)&&(q=m[t],h=!0,!l||0<=c(q,l)))k=t,l=q,n=f;h||g.push(f)}if(null==k)break;else e[k]=!0,j+=1,i[k]=n,d.add(n,k,{});h=0;for(k=g.length;h<k;h+=1)delete e[g[h]],j-=1}return d},getGrowthSequence:function(b){var c=[],d,e={},f;d=[];var g,h={},i=0,j,k,l,n,m,t;if(null!=b){d=null;l=0;n=null;for(g in a)if(a.hasOwnProperty(g)){k=a[g];l=0;for(j in k)k.hasOwnProperty(j)&&(l+=b(k[j]));if(l>n||null==n)d=g,n=l}if(null!=d){c.push(d);e[d]=!0;i+=1;for(h[d]=null;0<i;){d=[];k=j=null;l={};for(f in e)if(e.hasOwnProperty(f)){n=
a[f];g=!1;for(m in n)if(n.hasOwnProperty(m)&&!h.hasOwnProperty(m)&&(t=b(n[m]),g=!0,null==l[m]&&(l[m]=0),l[m]+=t,!k||l[m]>k))j=m,k=l[m];g||d.push(f)}if(null==j)break;else e[j]=!0,i+=1,h[j]=!0,c.push(j);g=0;for(j=d.length;g<j;g+=1)delete e[d[g]],i-=1}}}return c},getShortestPath:function(b,c,d){var e={},f={},g={},h,i,j,k,l;e[b]=!0;h=1;for(f[b]=0;0<h;){i=b=null;for(j in e)e.hasOwnProperty(j)&&(null==i?(b=j,i=f[j]):i>f[j]&&(b=j,i=f[j]));k=a[b];for(j in k)k.hasOwnProperty(j)&&(l=i+(null!=d?d(k[j],b,j):
1),f.hasOwnProperty(j)?f[j]>l&&e.hasOwnProperty(j)&&(f[j]=l,g[j]=b):(f[j]=l,g[j]=b,e[j]=!0,h+=1));if(b==c)break;else delete e[b],h-=1}for(d=[];null!=c;)d.push(c),c=g[c];return d}}};
primitives.common.LinkedHashItems=function(){function a(a,b){if(e.hasOwnProperty(a))throw"Duplicate segments are not supported!";e[a]=b;f[a]=null;null==i?(h=a,g[a]=null):(f[i]=a,g[a]=i);i=a}function b(a,b){if(e.hasOwnProperty(a))throw"Duplicate segments are not supported!";e[a]=b;g[a]=null;null==h?(i=a,f[a]=null):(g[h]=a,f[a]=h);h=a}function c(a,b,c,d){var m;null==c&&(c=a?h:i);if(null!=b)for(;null!=c;)m=e[c],null!=m&&b(m),c=c==d?null:a?f[c]:g[c]}function d(a,b,d){c(!0,a,b,d)}var e={},f={},g={},h=
null,i=null;return{add:a,item:function(a){return e[a]},nextKey:function(a){return f[a]},prevKey:function(a){return g[a]},startKey:function(){return h},endKey:function(){return i},unshift:b,insertAfter:function(c,d,h){if(e.hasOwnProperty(d))throw"Duplicate segments are not supported!";if(null==c)b(d,h);else{var i=f[c];null==i?a(d,h):(e[d]=h,f[c]=d,f[d]=i,g[i]=d,g[d]=c)}},remove:function(a){var b=g[a],c=f[a];null!=b?f[b]=c:h=c;null!=c?g[c]=b:i=b;delete e[a];delete f[a];delete g[a]},iterate:d,iterateBack:function(a,
b,d){c(!1,a,b,d)},empty:function(){e={};f={};g={};i=h=null},toArray:function(){var a=[];d(function(b){a.push(b)});return a},validate:function(a){var b,c;for(b in e)if(e.hasOwnProperty(b)&&(!f.hasOwnProperty(b)||!g.hasOwnProperty(b)))return null!=a&&(a.message="Orphant key found!"),!1;if(!e.hasOwnProperty(h)||!e.hasOwnProperty(i))return null!=a&&(a.message="Start or end values are missing!"),!1;for(b in f)if(f.hasOwnProperty(b)){if(!e.hasOwnProperty(b)||!g.hasOwnProperty(b))return null!=a&&(a.message=
"Orphant key found!"),!1;if((c=f[b])&&!f.hasOwnProperty(c))return null!=a&&(a.message="Next key not found!"),!1}for(b in g)if(g.hasOwnProperty(b)){if(!e.hasOwnProperty(b)||!f.hasOwnProperty(b))return null!=a&&(a.message="Orphant key found!"),!1;if((c=g[b])&&!g.hasOwnProperty(c))return null!=a&&(a.message="Prev key not found!"),!1}return!0}}};
primitives.common.tree=function(a){function b(a,b,c){var d,f,h;if(null!=e[b]&&(b=g[b],null!=b)){f=0;for(h=b.length;f<h&&!(d=b[f],c.call(a,d,e[d],f,h-1));f+=1);}}function c(a){var b=null;null!=f[a]&&(b=f[a]);return b}function d(a,b){var c,d=a.length;for(c=0;c<d;c+=1)if(a[c]==b)return a.splice(c,1),d-1;return d}var e={},f={},g={},h={},i={};primitives.common.isObject(a)&&(e=primitives.common.cloneObject(a.nodes,!0),f=primitives.common.cloneObject(a.parents,!0),g=primitives.common.cloneObject(a.children,
!1),h=primitives.common.cloneObject(a.roots,!1),i=primitives.common.cloneObject(a.rootChildren,!0));return{loop:function(a,b){var c;if(null!=b)for(c in e)if(e.hasOwnProperty(c)&&b.call(a,c,e[c]))break},loopLevels:function(a,b,c){var d=0,f=[],h,q,p,r,s;switch(arguments.length){case 2:q=b;break;case 3:h=b,q=c}if(null!=q){if(null==h)for(p in i)i.hasOwnProperty(p)&&(f=f.concat(i[p]));else null!=g[h]&&(f=f.concat(g[h]));for(;0<f.length;){p=[];r=0;for(s=f.length;r<s;r+=1)switch(h=f[r],q.call(a,h,e[h],d)){case 1:p=
[];break;case 2:break;default:null!=g[h]&&(p=p.concat(g[h]))}f=p;d+=1}}},loopParents:function(a,b,c){if(null!=e[b]&&null!=c)for(;null!=(b=f[b])&&!c.call(a,b,e[b]););},loopChildren:b,loopChildrenRange:function(a,b,c,d,f){var h;if(null!=e[b]&&(b=g[b],null!=b))if(c<d){c=Math.max(c,0);d=Math.min(d,b.length-1);for(h=c;h<=d&&!(c=b[h],f.call(a,c,e[c],h,NaN));h+=1);}else{c=Math.min(c,b.length-1);d=Math.max(0,d);for(h=c;h>=d&&!(c=b[h],f.call(a,c,e[c],h,NaN));h-=1);}},loopChildrenReversed:function(a,b,c){var d,
f,h;if(null!=e[b]&&(b=g[b],h=b.length-1,null!=b))for(f=h;0<=f&&!(d=b[f],c.call(a,d,e[d],f,h));f-=1);},loopPostOrder:function(a,b){var c=[],d,h,t;if(null!=b){for(d in i)i.hasOwnProperty(d)&&(c=c.concat(i[d]));for(;0<c.length;)if(d=c[c.length-1],d!=h&&null!=(t=g[d]))for(d=t.length-1;0<=d;d-=1)c.push(t[d]);else if(c.pop(),h=f[d],b.call(a,d,e[d],h,e[h]))break}},loopPreOrder:function(a,b){var c=[],d,h,t;if(null!=b){for(d in i)i.hasOwnProperty(d)&&(c=c.concat(i[d]));for(;0<c.length;){d=c[c.length-1];if(d!=
h&&b.call(a,d,e[d],h,e[h]))break;if(d!=h&&null!=(t=g[d]))for(d=t.length-1;0<=d;d-=1)c.push(t[d]);else c.pop(),h=f[d]}}},zipUp:function(a,b,c,d){var e,g;if(null!=d)for(;null!=b&&null!=c&&b!=c;){e=f[b];g=f[c];if(d.call(a,b,e,c,g))break;b=e;c=g}},parentid:c,parent:function(a){var b=null;null!=f[a]&&(b=e[f[a]]);return b},adopt:function(a,b){if(null!=e[a]&&null!=e[b])if(a!=b)h.hasOwnProperty(b)&&(d(i[h[b]],b)||delete i[h[b]],delete h[b]),f.hasOwnProperty(b)&&(d(g[f[b]],b)||delete g[f[b]]),f[b]=a,null!=
g[a]?g[a].push(b):g[a]=[b];else throw"Item cannot be parent of itself!";else throw"Both parent and child should be in hierarchy!";},moveChildren:function(a,c){null!=e[a]&&(null!=e[c]&&a!=c)&&null!=g[a]&&(b(this,a,function(a){f[a]=c}),g[c]=null!=g[c]?g[c].concat(g[a]):g[a],delete g[a])},node:function(a){return e[a]},add:function(a,b,c,d){var m;if(null!=e[b])throw"Node already exists";if(null!=b&&(null!=c&&null==e[b])&&(null!=e[a]?(f[b]=a,null!=g[a]?null==d?g[a].push(b):g[a].splice(d,0,b):g[a]=[b]):
(h[b]=a,null!=i[a]?null==d?i[a].push(b):i[a].splice(d,0,b):i[a]=[b]),e[b]=c,null!=i[b])){g[b]=i[b];delete i[b];d=g[b];a=0;for(c=d.length;a<c;a+=1)m=d[a],delete h[m],f[m]=b}},insert:function(a,c,d){null!=e[a]&&(null!=c&&null==e[c]&&null!=d)&&(e[c]=d,null!=g[a]&&(g[c]=g[a]),g[a]=[c],b(this,c,function(a){f[a]=c}),f[c]=a)},hasNodes:function(){return!primitives.common.isEmptyObject(i)},hasChildren:function(a){return null!=g[a]},countChildren:function(a){return null!=g[a]?g[a].length:0},countSiblings:function(a){a=
c(a);return null!=a?g[a].length:0},indexOf:function(a){var b=c(a);return null!=b?primitives.common.indexOf(g[b],a):null},getChild:function(a,b){var c=null,d;if(null!=(d=g[a]))c=e[d[b]];return c},arrangeChildren:function(a,b){var c,d,h,b=b.slice(0);if(null!=e[a])if(null!=g[a])if(g[a].length==b.length){d=0;for(h=b.length;d<h;d+=1)if(c=b[d],f[c]!=a)throw"Child "+c+" does not belong to given node!";g[a]=b}else throw"Collections of children don't match each other!";else if(0<b.length)throw"Collections of children don't match each other!";
},validate:function(){var a=!0,b;for(b in h)if(h.hasOwnProperty(b)&&null!=h[b]){a=!1;break}return a},clone:function(){return primitives.common.family({nodes:e,parents:f,children:g,roots:h,rootChildren:i})},BREAK:1,SKIP:2}};
primitives.common.TreeLevels=function(a){function b(a){this.context=a;this.items=[]}function c(a,b,c){this.context=a;this.position=b;this.level=c}function d(a){null==e[a]&&(e[a]=new b(null),g=null===g?a:Math.min(g,a),h=null===h?a:Math.max(h,a));return e[a]}var e=[],f={},g=null,h=null;primitives.common.isObject(a)&&(e=primitives.common.cloneObject(a.levels,!0),f=primitives.common.cloneObject(a.items,!0),g=primitives.common.cloneObject(a.minimum,!0),h=primitives.common.cloneObject(a.maximum,!0));return{addlevel:function(a,
b){d(a).context=b},hasLevel:function(a){return null!=e[a]},hasItem:function(a){return f.hasOwnProperty(a)},addItem:function(a,b,e){var g;if(f.hasOwnProperty(b))throw"Duplicate item id.";g=d(a);g.items.push(b);f[b]=new c(e,g.items.length-1,a)},getLevelIndex:function(a){return f.hasOwnProperty(a)?f[a].level:null},loopLevels:function(a,b){var c,d;if(null!=b)for(c=g;c<=h&&!(d=e[c],null!=d&&b.call(a,c,d.context));c+=1);},loopLevelsReversed:function(a,b){var c,d;if(null!=b)for(c=h;c>=g&&!(d=e[c],null!=
d&&b.call(a,c,d.context));c-=1);},loopLevelItems:function(a,b,c){var d,g,h;if(null!=c&&(g=e[b],null!=g)){b=0;for(d=g.items.length;b<d&&!(h=g.items[b],c.call(a,h,f[h].context,b));b+=1);}},loopItems:function(a,b){var c,d,n,m,t,q;if(null!=b)for(m=g;m<=h;m+=1)if(n=e[m],null!=n){t=n.items;c=0;for(d=t.length;c<d;c+=1)if(q=t[c],b.call(a,q,f[q].context,c,m,n.context))return}},binarySearch:function(a,b,c){a=null;null!=c&&(b=e[b],null!=b&&(a=primitives.common.binarySearch(b.items,c)));return a},loopMerged:function(a,
b,c){var d,g,h,t=[];d=0;for(g=e.length;d<g;d+=1)h=e[d],t.push(h.items);h=primitives.common.mergeSort(t,b);if(null!=c){d=0;for(g=h.length;d<g&&!(b=h[d],c.call(a,b,f[b].context));d+=1);}},loopFromItem:function(a,b,c,d){var g,h;if(f.hasOwnProperty(b)&&(g=f[b],b=e[g.level].items,null!=d))if(c)for(c=g.position-1;0<=c&&!(h=b[c],d.call(a,h,f[h].context));c-=1);else{c=g.position+1;for(g=b.length;c<g&&!(h=b[c],d.call(a,h,f[h].context));c+=1);}},loopLevelsFromItem:function(a,b,c,d){if(f.hasOwnProperty(b)&&
(b=f[b],null!=d))if(c)for(c=b.level+1;c<h&&!d.call(a,c,e[c].context);c+=1);else for(c=b.level-1;c>=g&&!d.call(a,c,e[c].context);c-=1);},getPrevItem:function(a){var b=null;f.hasOwnProperty(a)&&(a=f[a],b=e[a.level].items[a.position-1]);return b},getNextItem:function(a){var b=null;f.hasOwnProperty(a)&&(a=f[a],b=e[a.level].items[a.position+1]);return b},isEmpty:function(){return!e.length},clone:function(){return primitives.common.family({levels:e,items:f,minimum:g,maximum:h})}}};
primitives.common.DependencyManager=function(){var a={};return{register:function(b,c){return a[b]=c},resolve:function(b,c,d){var e=[],f=d||{};return function(){for(var d=Array.prototype.slice.call(arguments,0),h=0;h<b.length;h+=1){var i=b[h];e.push(a[i]&&""!==i?a[i]:d.shift())}e=e.concat(d);return c.apply(f||{},e)}}}};primitives.common.TaskInfo=function(a,b,c,d){this.name=a;this.dependencies=b;this.factory=c;this.task=null;this.color=d};
primitives.common.TaskManager=function(){var a=new primitives.common.family,b=new primitives.common.DependencyManager,c=[];return{addTask:function(b,e,f,g){if(0<c.length)throw"Task Manager is already initialized";a.add(e,b,new primitives.common.TaskInfo(b,e,f,g))},addDependency:function(a,e){if(0<c.length)throw"Task Manager is already initialized";b.register(a,e)},getTask:function(b){return(b=a.node(b))&&b.task},process:function(d){var e=!1;0===c.length&&a.loopTopo(this,function(a,d){d.task=b.register(a,
b.resolve(d.dependencies,d.factory)());c.push(d)});d&&console.log("-- process --");for(var f={},g=0,h=c.length;g<h;g+=1){var i=c[g],j=[];if(0===g||f.hasOwnProperty(i.name))(e=i.task.process(d))&&a.loopChildren(this,i.name,function(b){f[b]=!0;d&&j.push(b);return a.SKIP}),d&&console.log(g+". "+i.name+(e?" - forces: "+j.toString():""))}},getProcessDiagramConfig:function(){var d=new primitives.famdiagram.Config;0===c.length&&a.loopTopo(this,function(a,d){d.task=b.register(a,b.resolve(d.dependencies,d.factory)());
c.push(d)});for(var e=0,f=c.length;e<f;e+=1){var g=c[e],h=new primitives.famdiagram.ItemConfig;h.id=g.name;h.title=primitives.common.splitCamelCaseName(g.name).join(" ");h.description=g.task.description||"";h.itemTitleColor=g.color;h.parents=[];a.loopParents(this,g.name,function(b){h.parents.push(b);return a.SKIP});d.items.push(h)}return d}}};
primitives.callout.Config=function(){this.classPrefix="bpcallout";this.graphicsType=1;this.actualGraphicsType=null;this.pointerPlacement=0;this.snapPoint=this.position=null;this.cornerRadius="10%";this.offset=0;this.lineWidth=this.opacity=1;this.lineType=0;this.pointerWidth="10%";this.borderColor="#000000";this.fillColor="#d3d3d3"};
primitives.callout.Controller=function(){this.widgetEventPrefix="bpcallout";this.options=new primitives.callout.Config;this.m_shape=this.m_graphics=this.m_panelSize=this.m_placeholder=null};primitives.callout.Controller.prototype._create=function(){this.element.addClass("ui-widget");this._createLayout();this._redraw()};primitives.callout.Controller.prototype.destroy=function(){this._cleanLayout()};
primitives.callout.Controller.prototype._createLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight());this.m_placeholder=jQuery("<div></div>");this.m_placeholder.css({position:"relative",overflow:"hidden",top:"0px",left:"0px",padding:"0px",margin:"0px"});this.m_placeholder.css(this.m_panelSize.getCSS());this.m_placeholder.addClass("placeholder");this.m_placeholder.addClass(this.widgetEventPrefix);this.element.append(this.m_placeholder);
this.m_graphics=primitives.common.createGraphics(this.options.graphicsType,this.element);this.options.actualGraphicsType=this.m_graphics.graphicsType;this.m_shape=new primitives.common.Callout(this.m_graphics)};primitives.callout.Controller.prototype._cleanLayout=function(){null!==this.m_graphics&&this.m_graphics.clean();this.m_graphics=null;this.element.find("."+this.widgetEventPrefix).remove()};
primitives.callout.Controller.prototype._updateLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.innerWidth(),this.element.innerHeight());this.m_placeholder.css(this.m_panelSize.getCSS())};primitives.callout.Controller.prototype.update=function(a){a?(this._cleanLayout(),this._createLayout(),this._redraw()):(this._updateLayout(),this.m_graphics.resize("placeholder",this.m_panelSize.width,this.m_panelSize.height),this.m_graphics.begin(),this._redraw(),this.m_graphics.end())};
primitives.callout.Controller.prototype._redraw=function(){var a="pointerPlacement cornerRadius offset opacity lineWidth lineType pointerWidth borderColor fillColor".split(" "),b,c;this.m_graphics.activate("placeholder");for(b=0;b<a.length;b+=1)c=a[b],this.m_shape[c]=this.options[c];this.m_shape.draw(this.options.snapPoint,this.options.position)};
primitives.callout.Controller.prototype._setOption=function(a,b){jQuery.Widget.prototype._setOption.apply(this,arguments);switch(a){case "disabled":var c=jQuery([]);b?(c.filter(".ui-state-focus").blur(),c.removeClass("ui-state-hover"),c.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(c.propAttr("disabled",!1),this.element.removeClass("ui-disabled"))}};(function(a){a.widget("ui.bpCallout",new primitives.callout.Controller)})(jQuery);
primitives.connector.Config=function(){this.classPrefix="bpconnector";this.graphicsType=1;this.actualGraphicsType=null;this.connectorShapeType=this.orientationType=0;this.toRectangle=this.fromRectangle=null;this.offset=new primitives.common.Thickness(0,0,0,0);this.lineWidth=3;this.color="#000000";this.lineType=0;this.label=null;this.labelSize=new primitives.common.Size(60,30);this.labelPlacementType=primitives.common.ConnectorLabelPlacementType.Between};
primitives.connector.AnnotationLabelTemplate=function(a){var b,c=jQuery("<div></div>");c.addClass("bp-item bp-corner-all bp-connector-label");b=c.wrap("<div>").parent().html();var d=primitives.common.hashCode(b);return{template:function(){return b},getHashCode:function(){return d},render:function(b,c){c.element.html(a.label)}}};
primitives.connector.Controller=function(){this.widgetEventPrefix="bpconnector";this.options=new primitives.connector.Config;this._labelTemplate=this.m_shape=this.m_graphics=this.m_panelSize=this.m_placeholder=null};primitives.connector.Controller.prototype._create=function(){this.element.addClass("ui-widget");this._labelTemplate=primitives.connector.AnnotationLabelTemplate(this.options);this._createLayout();this._redraw()};primitives.connector.Controller.prototype.destroy=function(){this._cleanLayout()};
primitives.connector.Controller.prototype._createLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight());this.m_placeholder=jQuery("<div></div>");this.m_placeholder.css({position:"relative",overflow:"hidden",top:"0px",left:"0px",padding:"0px",margin:"0px"});this.m_placeholder.css(this.m_panelSize.getCSS());this.m_placeholder.addClass("placeholder");this.m_placeholder.addClass(this.widgetEventPrefix);this.element.append(this.m_placeholder);
this.m_graphics=primitives.common.createGraphics(this.options.graphicsType,this.element);this.options.actualGraphicsType=this.m_graphics.graphicsType;this.m_shape=new primitives.common.Connector(this.m_graphics)};primitives.connector.Controller.prototype._cleanLayout=function(){null!==this.m_graphics&&this.m_graphics.clean();this.m_graphics=null;this.element.find("."+this.widgetEventPrefix).remove()};
primitives.connector.Controller.prototype._updateLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.innerWidth(),this.element.innerHeight());this.m_placeholder.css(this.m_panelSize.getCSS())};primitives.connector.Controller.prototype.update=function(a){a?(this._cleanLayout(),this._createLayout(),this._redraw()):(this._updateLayout(),this.m_graphics.resize("placeholder",this.m_panelSize.width,this.m_panelSize.height),this.m_graphics.begin(),this._redraw(),this.m_graphics.end())};
primitives.connector.Controller.prototype._redraw=function(){var a="orientationType connectorShapeType offset lineWidth color lineType labelSize".split(" "),b,c;this.m_graphics.activate("placeholder");for(b=0;b<a.length;b+=1)c=a[b],null!=this.options[c]&&(this.m_shape[c]=this.options[c]);this.m_shape.hasLabel=!primitives.common.isNullOrEmpty(this.options.label);this.m_shape.labelPlacementType=this.options.labelPlacementType;this.m_shape.labelTemplate=this._labelTemplate;this.m_shape.panelSize=new primitives.common.Size(this.m_panelSize.width,
this.m_panelSize.height);this.m_shape.draw(this.options.fromRectangle,this.options.toRectangle)};primitives.connector.Controller.prototype._setOption=function(a,b){jQuery.Widget.prototype._setOption.apply(this,arguments);switch(a){case "disabled":var c=jQuery([]);b?(c.filter(".ui-state-focus").blur(),c.removeClass("ui-state-hover"),c.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(c.propAttr("disabled",!1),this.element.removeClass("ui-disabled"))}};
(function(a){a.widget("ui.bpConnector",new primitives.connector.Controller)})(jQuery);primitives.orgdiagram.Widget=function(a,b){this.widgetEventPrefix="orgdiagram";this.options=new a;this.control=null;this.controlFactory=b};primitives.orgdiagram.Widget.prototype._create=function(){this.element.addClass("ui-widget");this.control=new this.controlFactory(this.element,this._readOptions(this.options))};primitives.orgdiagram.Widget.prototype.destroy=function(){this.control.destroy()};
primitives.orgdiagram.Widget.prototype.update=function(a){this.control.setOptions(this._readOptions(this.options));this.control.update(a)};primitives.orgdiagram.Widget.prototype._setOption=function(a,b){jQuery.Widget.prototype._setOption.apply(this,arguments);switch(a){case "disabled":var c=jQuery([]);b?(c.filter(".ui-state-focus").blur(),c.removeClass("ui-state-hover"),c.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(c.propAttr("disabled",!1),this.element.removeClass("ui-disabled"))}};
primitives.orgdiagram.Widget.prototype._readOptions=function(a){var b={},c=this,d;for(d in a)if(a.hasOwnProperty(d))switch(d){case "onHighlightChanging":case "onCursorChanging":case "onSelectionChanging":case "onButtonClick":case "onMouseClick":case "onMouseDblClick":case "onItemRender":case "onHighlightRender":b[d]=function(a){return function(b,d){c._trigger(a,b,d)}}(d);break;case "onHighlightChanged":b[d]=function(a,b){var d=c.control.getOptions();c.options.highlightItem=d.highlightItem;c._trigger("onHighlightChanged",
a,b)};break;case "onCursorChanged":b[d]=function(a,b){var d=c.control.getOptions();c.options.cursorItem=d.cursorItem;c._trigger("onCursorChanged",a,b)};break;case "onSelectionChanged":b[d]=function(a,b){var d=c.control.getOptions();c.options.selectedItems=d.selectedItems;c._trigger("onSelectionChanged",a,b)};break;default:b[d]=a[d]}return b};(function(a){a.widget("ui.orgDiagram",new primitives.orgdiagram.Widget(primitives.orgdiagram.Config,primitives.orgdiagram.Control))})(jQuery);
(function(a){a.widget("ui.famDiagram",new primitives.orgdiagram.Widget(primitives.famdiagram.Config,primitives.famdiagram.Control))})(jQuery);
primitives.shape.Config=function(){this.classPrefix="bpconnector";this.graphicsType=1;this.actualGraphicsType=null;this.shapeType=this.orientationType=0;this.position=null;this.offset=new primitives.common.Thickness(0,0,0,0);this.lineWidth=2;this.cornerRadius="10%";this.opacity=1;this.fillColor=this.borderColor=null;this.lineType=0;this.label=null;this.labelSize=new primitives.common.Size(60,30);this.labelPlacement=0;this.labelOffset=4};
primitives.shape.AnnotationLabelTemplate=function(a){var b,c=jQuery("<div></div>");c.addClass("bp-item bp-corner-all bp-connector-label");b=c.wrap("<div>").parent().html();var d=primitives.common.hashCode(b);return{template:function(){return b},getHashCode:function(){return d},render:function(b,c){c.element.html(a.label)}}};
primitives.shape.Controller=function(){this.widgetEventPrefix="bpshape";this.options=new primitives.shape.Config;this._labelTemplate=this.m_shape=this.m_graphics=this.m_panelSize=this.m_placeholder=null};primitives.shape.Controller.prototype._create=function(){this.element.addClass("ui-widget");this._labelTemplate=primitives.shape.AnnotationLabelTemplate(this.options);this._createLayout();this._redraw()};primitives.shape.Controller.prototype.destroy=function(){this._cleanLayout()};
primitives.shape.Controller.prototype._createLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight());this.m_placeholder=jQuery("<div></div>");this.m_placeholder.css({position:"relative",overflow:"hidden",top:"0px",left:"0px",padding:"0px",margin:"0px"});this.m_placeholder.css(this.m_panelSize.getCSS());this.m_placeholder.addClass("placeholder");this.m_placeholder.addClass(this.widgetEventPrefix);this.element.append(this.m_placeholder);
this.m_graphics=primitives.common.createGraphics(this.options.graphicsType,this.element);this.options.actualGraphicsType=this.m_graphics.graphicsType};primitives.shape.Controller.prototype._cleanLayout=function(){null!==this.m_graphics&&this.m_graphics.clean();this.m_graphics=null;this.element.find("."+this.widgetEventPrefix).remove()};
primitives.shape.Controller.prototype._updateLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.innerWidth(),this.element.innerHeight());this.m_placeholder.css(this.m_panelSize.getCSS())};primitives.shape.Controller.prototype.update=function(a){a?(this._cleanLayout(),this._createLayout(),this._redraw()):(this._updateLayout(),this.m_graphics.resize("placeholder",this.m_panelSize.width,this.m_panelSize.height),this.m_graphics.begin(),this._redraw(),this.m_graphics.end())};
primitives.shape.Controller.prototype._redraw=function(){var a="orientationType shapeType offset lineWidth borderColor lineType labelSize labelOffset labelPlacement cornerRadius opacity fillColor".split(" "),b,c;this.m_graphics.activate("placeholder");this.m_shape=new primitives.common.Shape(this.m_graphics);for(b=0;b<a.length;b+=1)c=a[b],this.m_shape[c]=this.options[c];this.m_shape.hasLabel=!primitives.common.isNullOrEmpty(this.options.label);this.m_shape.labelTemplate=this._labelTemplate;this.m_shape.panelSize=
new primitives.common.Size(this.m_panelSize.width,this.m_panelSize.height);this.m_shape.draw(this.options.position)};primitives.shape.Controller.prototype._setOption=function(a,b){jQuery.Widget.prototype._setOption.apply(this,arguments);switch(a){case "disabled":var c=jQuery([]);b?(c.filter(".ui-state-focus").blur(),c.removeClass("ui-state-hover"),c.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(c.propAttr("disabled",!1),this.element.removeClass("ui-disabled"))}};
(function(a){a.widget("ui.bpShape",new primitives.shape.Controller)})(jQuery);primitives.text.Config=function(){this.classPrefix="bptext";this.graphicsType=0;this.actualGraphicsType=null;this.orientation=0;this.text="";this.verticalAlignment=1;this.horizontalAlignment=0;this.fontSize="16px";this.fontFamily="Arial";this.color="#000000";this.fontStyle=this.fontWeight="normal"};
primitives.text.Controller=function(){this.widgetEventPrefix="bptext";this.options=new primitives.text.Config;this.m_graphics=this.m_panelSize=this.m_placeholder=null};primitives.text.Controller.prototype._create=function(){this.element.addClass("ui-widget");this._createLayout();this._redraw()};primitives.text.Controller.prototype.destroy=function(){this._cleanLayout()};
primitives.text.Controller.prototype._createLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight());this.m_placeholder=jQuery("<div></div>");this.m_placeholder.css({position:"relative",overflow:"hidden",top:"0px",left:"0px",padding:"0px",margin:"0px"});this.m_placeholder.css(this.m_panelSize.getCSS());this.m_placeholder.addClass("placeholder");this.m_placeholder.addClass(this.widgetEventPrefix);this.element.append(this.m_placeholder);
this.m_graphics=primitives.common.createGraphics(this.options.graphicsType,this.element);this.options.actualGraphicsType=this.m_graphics.graphicsType};primitives.text.Controller.prototype._cleanLayout=function(){null!==this.m_graphics&&this.m_graphics.clean();this.m_graphics=null;this.element.find("."+this.widgetEventPrefix).remove()};
primitives.text.Controller.prototype._updateLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.innerWidth(),this.element.innerHeight());this.m_placeholder.css(this.m_panelSize.getCSS())};primitives.text.Controller.prototype.update=function(a){a?(this._cleanLayout(),this._createLayout(),this._redraw()):(this._updateLayout(),this.m_graphics.resize("placeholder",this.m_panelSize.width,this.m_panelSize.height),this.m_graphics.begin(),this._redraw(),this.m_graphics.end())};
primitives.text.Controller.prototype._redraw=function(){var a=this.m_graphics.activate("placeholder");this.m_graphics.text(a.rect.x,a.rect.y,a.rect.width,a.rect.height,this.options.text,this.options.orientation,this.options.horizontalAlignment,this.options.verticalAlignment,{"font-size":this.options.fontSize,"font-family":this.options.fontFamily,"font-style":this.options.fontStyle,"font-weight":this.options.fontWeight,"font-color":this.options.color})};
primitives.text.Controller.prototype._setOption=function(a,b){jQuery.Widget.prototype._setOption.apply(this,arguments);switch(a){case "disabled":var c=jQuery([]);b?(c.filter(".ui-state-focus").blur(),c.removeClass("ui-state-hover"),c.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(c.propAttr("disabled",!1),this.element.removeClass("ui-disabled"))}};(function(a){a.widget("ui.bpText",new primitives.text.Controller)})(jQuery);
